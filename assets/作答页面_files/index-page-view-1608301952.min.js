/*! tools-assessment - v0.0.1 - 2016-08-30 19:53 */define("views/quiz/formal/quiz-select-section-view",["talent","templates/quiz","scrollTo"],function(a,b){var c=a.ItemView.extend({template:b["quiz/formal/quiz-select-section-item"],tagName:"li",initialize:function(b){this.options=a._.extend({},b)},onRender:function(){var a=this;this.model.get("section")==this.options.activeSection&&0==this.options.activityStatus?(this.$el.addClass("active"),this.$el.on("click.quiz",function(){a.trigger("begintest")})):this.$el.removeClass("active")}}),d=a.CompositeView.extend({template:b["quiz/formal/quiz-select-section"],itemView:c,itemViewContainer:".select_con ul",initialize:function(){var b,c=this,d=/[^\x00-\xff]/g,e=a.Context.getActivityInfo(),f=e.name||"";a.$(".quiz_container .quiz_con").removeClass("body_bg"),a.$("body").removeClass("body_bg"),b=d.test(f)?"&nbsp;&nbsp;":"&nbsp;",f=f.replace(/\s/g,b),this.model.set({name:f,info:e.info}),this.on("itemview:begintest",this.onBeginTest,this),a.Context.setBSGlobalInfo({isCollectionEnd:c.model.get("isCollectionEnd"),forceSubmitTime:c.model.get("forceSubmitTime")})},itemViewOptions:function(){return{activeSection:this.model.get("sectionId"),activityStatus:this.model.get("activityStatus")}},events:function(){var a={};return a["click .quiz_exit"]="onExitTest",a},onBeginTest:function(){this.trigger("quiz:next:step")},onExitTest:function(){this.trigger("quiz:exit")},onShow:function(){var b=this.$el.find(".active").index(),c=this;if(b>5)var d=c.$el.find(".active span").offset();if(this.$el.find(".quiz_exit").length>0)var d=c.$el.find(".quiz_exit").offset();if(d){var e=d.top||100;a.$.scrollTo(e-100,300)}}});return d}),define("QuizErrorView",["talent","templates/common"],function(a,b){var c=a.Layout.extend({template:b["common/component/quiz-error"],initialize:function(){this.model.set({loginUserInfo:a.Context.getBaseGlobalInfoByName("loginUserInfo"),tenantInfo:a.Context.getBaseGlobalInfoByName("tenantInfo")})},regions:{},ui:{},events:function(){var a={};return a},onRender:function(){a.Context.removeCookie()},onShow:function(){this.model.get("report")&&(this.$el.find(".user_name").html(""),this.$el.find(".qu_tit span:eq(1)").html("自助查询平台").css({"font-size":"18px","font-weight":"bold"}))},onClose:function(){}});return c}),define("views/common/component/user-feedback-mess",["talent","templates/quiz"],function(a,b){var c=a.ItemView.extend({template:b["common/component/user-feedback-mess"],initialize:function(){},events:function(){var a={};return a["click .btn_submit button"]="submitUserFeedBack",a["click .board_radio_wrap a"]="changeActiveType",a["click .mess_board_pop"]="closeBoardPop",a},submitUserFeedBack:function(b){var c=this,d=$.trim($(".edit_advise textarea").val()),e=Number($("input[name=r1]:checked").val()),f={tenantID:BSGlobal.tenantInfo.id,activityID:BSGlobal.activityInfo.id,userID:BSGlobal.loginUserInfo.id,feedBackType:e,feedBackContent:d};""!=d?($(b.currentTarget).attr("disabled","disabled").css("background","#687480"),a.app.request("quizsection:saveUserFeedBackMess",f).done(function(){c.trigger("mess:submit"),$(".erro_mess").removeClass("text_erro").text("").hide()})):$(".erro_mess").addClass("text_erro").text("输入不能为空").show()},closeBoardPop:function(){this.trigger("mess:close")},changeActiveType:function(a){$(a.currentTarget).addClass("active").siblings().removeClass("active"),$(a.currentTarget).find("input").attr("checked",!0);var b=Number($(a.currentTarget).find("input").val());0==b?$(".edit_advise textarea").attr("placeholder","欢迎任何优化建议，你的反馈帮助我们做的更好！"):1==b?$(".edit_advise textarea").attr("placeholder","遇到有疑问的题目，请摘录一部分题干以便定位问题。"):$(".edit_advise textarea").attr("placeholder","如果你使用时遇到问题，请告诉我们。")},onShow:function(){$(".mess_board_wrap").css("bottom","50px")},popMoveStart:function(){},popMove:function(){}});return c}),define("views/common/component/user-feedback-board",["talent","templates/quiz","views/common/component/user-feedback-mess"],function(a,b,c){var d=a.Layout.extend({template:b["common/component/user-feedback-board"],initialize:function(){},regions:{boardWrap:".mess_wrap"},events:function(){var a={};return a["click .btn_feedback"]="popUserFeedBack",a["click .btn_feedback_mess .close"]="closePop",a},popUserFeedBack:function(){$(".btn_feedback").hide();var a=$(document).width(),b=$(document).height();$(".bg_mes_diolag").css({width:a,height:b}).show();var d=new c;this.boardWrap.show(d),$(".mess_wrap").animate({height:306},500),this.listenTo(d,"mess:submit",function(){d.close(),$(".btn_feedback_mess").show(),setTimeout(function(){$(".btn_feedback_mess").hide(),$(".bg_mes_diolag").hide(),$(".btn_feedback").show()},3e3),$(".mess_wrap").css("height",0)}),this.listenTo(d,"mess:close",function(){d.close(),$(".bg_mes_diolag").hide(),$(".btn_feedback").show(),$(".mess_wrap").css("height",0)})},closePop:function(){$(".bg_mes_diolag").hide(),$(".btn_feedback_mess").hide(),$(".btn_feedback").show()}});return d}),define("views/quiz/formal/index-page-view",["talent","templates/quiz","views/common/base/base-region-type","views/quiz/formal/quiz-select-section-view","views/common/component/quiz-fade-view","QuizErrorView","$.cookie","views/common/component/user-feedback-board"],function(a,b,c,d,e,f){var g=a.Layout.extend({template:b["quiz/formal/index-page"],className:"quiz_container",switchType:"section",regions:{main:".quiz_container_inside",fade:".fadePop",messBoard:".user_feedback"},initialize:function(){var b=this;this.judgeGetPageBlur(),this.judgeGetCutDown(),BSGlobal.blurFlag=!1,this.statusModel=new a.Model({activityStatus:0}),this.listenTo(this.statusModel,"change:sectionId",function(){b.renderSelectSectionView()}),a.Context.resultManager.statusModel=this.statusModel,this.actTimeLoading=parseInt(a.Context.getBaseGlobalInfoByName("actTimeLoading"))},onRender:function(){var a=this;a.getSectionData()},onShow:function(){a.$(document).on("contextmenu selectstart",function(b){var c=a.$(b.target)[0].tagName.toLowerCase();return"input"!=c&&"textarea"!=c?(b.preventDefault(),!1):void 0}),a._.splash("formal")},judgeGetPageBlur:function(){var b=a.Context.getGlobalInfoByKey("notRequestAnswer"),c=a.Context.getBaseGlobalInfoByName("activityInfo")||{},d=c.IsJumpPage;d&&!b&&a.Context.getWindowBlur().done(function(b){b.message.message||b.message.type||b.IsOver&&a.app.execute("history:navigate","#quiz/login-error?type=pageblur",!0)})},judgeGetCutDown:function(){var b=a.Context.getGlobalInfoByKey("notRequestAnswer");if(!b){var c=a.Context.getBaseGlobalInfoByName("isHaveResult"),d=c?2:1;this.getCutdown(d).done(function(b){b>0&&a.app.execute("history:navigate","#quiz/login",!0)})}},getCutdown:function(b){var c=new a.$.Deferred;return a.app.request("time:getCutdown",{times:b}).done(function(a){var b=JSON.parse(a),d=b.countdown;c.resolve(d)}),c.promise()},getSectionData:function(){var b=this;a.app.request("quizsection:getAllSection",{isRecordInterrupt:!0,_v:Math.floor(1e4*Math.random())}).done(function(c){var d=c.message||{};if(d.message&&d.type)return d.isShowHead=!1,void(b.main&&b.main.show(new f({model:new a.Model(d)})));a.Context.setSessionData("sectionLen",c.data.length),b.sectionData=c.data;var e=c.activeSection;e||(e=b.getFirstActiveSection()),b.getFirstActiveSection()?b.statusModel.set({activityStatus:0,sectionId:e,sectionStatus:0,isCollectionEnd:c.isCollectionEnd,forceSubmitTime:c.forceSubmitTime}):(b.statusModel.set({activityStatus:1,isCollectionEnd:c.isCollectionEnd,forceSubmitTime:c.forceSubmitTime}),b.renderSelectSectionView())})},renderSelectSectionView:function(){var b=this;this.requestSectionHasSend=!1;var c=new d({model:this.statusModel,collection:new a.Collection(this.sectionData)});b.main.show(c),c.on("quiz:next:step",function(){b.nextStep()}),a.Context.getBaseGlobalInfoByName("isFirstRememberStartTime")&&b.showLoading()},showLoading:function(){this.fade.show(new e({model:new a.Model({type:"formalLoading",text:"正在下载题目，请稍候..."})})),this.closeLoading()},closeLoading:function(){var a=this,b=Math.floor(Math.random(0,1)*a.actTimeLoading);setTimeout(function(){a.fade.close()},1e3*b)},nextStep:function(){var b=this,c=this.statusModel.get("sectionId"),d=a.Context.getBaseGlobalInfoByName("isCollectionEnd");1==d?a.app.request("time:getCollectionCutDown",{sectionId:c}).done(function(a){a.message||b.judgeIsShowWaterMark(a.countdown)}):(a.Context.getBaseGlobalInfoByName("isFirstRememberStartTime")&&a.app.request("time:getCollectionCutDown",{sectionId:c}),b.judgeIsShowWaterMark())},judgeIsShowWaterMark:function(b){{var c=a.Context.getBaseGlobalInfoByName("activityInfo");a.Context.getBaseGlobalInfoByName("staticPath"),location.hostname}c.isEnableCamera?window._assessmentStreamRef?this.isShowWaterMark(b):this.fade.show(new e({model:new a.Model({message:a.Context.getPopNoMediDes(),btns:[{type:"btn_continue",text:"确定"}]})})):this.isShowWaterMark(b)},isShowWaterMark:function(b){var c=this;if(a.Context.getActivityInfo().isWaterMark){var d={name:a.Context.getUserInfo().name};a.app.request("subj:getCreateWaterMark",d).done(function(d){a.Context.setBSGlobalInfo({waterImage:d}),c.renderSectionView(b)})}else c.renderSectionView(b)},renderSectionView:function(b){var c=this;BSGlobal.isPostPage=!0;var d=this.statusModel.get("sectionId");a.Context.setSessionData("sectionId",d),this.requestSectionHasSend||(this.requestSectionHasSend=!0,a.Context.getBaseGlobalInfoByName("isFirstRecordPageChange")||a.app.request("time:rememberStartTime",{sectionID:d}),a.app.request("quizsection:getSectionDataById",{section:d}).done(function(e){var g=e.message||{};if(g.message&&g.type)return g.isShowHead=!1,void c.main.show(new f({model:new a.Model(g)}));var h=a.Context.getBaseGlobalInfoByName("isCollectionEnd");1==h&&b>-999&&(e.model.acCountDown=b),BSGlobal.blurFlag=!0,c.statusModel.set({activeSubSection:e.model.activeSubSection}),e.model=a._.extend({},e.model,{id:d,sectionStatus:0});var i=a.Context.quizMapping[e.viewType];c.quizSectionView=new i({model:new a.Model(e)}),c.listenTo(c.quizSectionView.model,"change:activeSubSection",function(a){c.statusModel.set({activeSubSection:a.get("activeSubSection")})}),c.listenTo(c.quizSectionView,"question:quiz:statusChange",function(a){c.statusModel.set({sectionStatus:a.get("sectionStatus")}),c.onAfterActiveSectionSubmit()}),c.main.show(c.quizSectionView)}))},getFirstActiveSection:function(){var b=a._.findWhere(this.sectionData,{status:0});return b&&b.section},onAfterActiveSectionSubmit:function(){var b=this;this.sectionData=_.updateArrayByAttr(this.sectionData,{section:this.statusModel.get("sectionId")},{status:1});var c=_.findWhereByDistance(this.sectionData,{section:this.statusModel.get("sectionId")},1);c?a.Context.resultManager.saveRequest().done(function(d){if(d&&-1!=d.indexOf("message")){var d=JSON.parse(d)||{},e=d.message||{};a._.isNull(e.message)&&a._.isNull(e.type)&&null===e.type?b.statusModel.set({sectionId:c.section,sectionStatus:0}):alert(e.message)}a.$(".btn_sure").attr("disabled",!1),a.$(".btn_exit").attr("disabled",!1)}):(this.statusModel.set({activityStatus:1}),a.Context.resultManager.saveRequest().done(function(b){if(a.$(".btn_sure").attr("disabled",!1),a.$(".btn_exit").attr("disabled",!1),b&&-1!=b.indexOf("message")){var b=JSON.parse(b)||{},c=b.message||{};a._.isNull(c.message)&&a._.isNull(c.type)&&a.app.execute("history:navigate","#quiz/complete?type=complete",!0)}})),BSGlobal.blurFlag=!1},onClose:function(){}});return a.BasePageView.extend({mainViewClass:g,pageTitle:"作答页面",hideSidebar:!0})}),define("views/quiz/guidance/index-page-view",["talent","templates/quiz","$.cookie"],function(a,b){var c=a.Layout.extend({template:b["quiz/guidance/index-page"],className:"quiz_container",initialize:function(){this.model=new a.Model({loginUserInfo:a.Context.getBaseGlobalInfoByName("loginUserInfo"),tenantInfo:a.Context.getBaseGlobalInfoByName("tenantInfo")}),this.ie_text="1、在菜单栏中点击<b>“工具”</b>按钮（按键盘上的Alt键以显示菜单栏），然后单击<b>“Internet 选项”</b>。<br>2、单击<b>“隐私”</b>选项卡，然后在<b>“设置”</b>下，将滑块移动到底部以允许所有Cookie。如果没有显示滑块，先点击<b>“默认值”</b>。<br>3、单击<b>“确定”</b>。",this.firefox_text="1、点击 Firefox 窗口顶部的Firefox按钮，然后单击<b>“选项”</b>。<br>2、在<b>“选项”</b>对话框中，单击<b>“隐私”</b>。<br>3、在<b>“Firefox将会”</b>下拉列表中，单击<b>“使用自定义历史记录设置”</b>。<br>4、选中<b>接受来自站点的Cookie</b>选项。<br>5、单击<b>“确定”</b>。",this.chrome_text="1、点击 Chrome 显示在右上角的<b>设置</b>图标。<br>2、选择<b>设置</b>。<br>3、点击该页面底部附近的<b>显示高级设置</b>。<br>4、在“隐私设置”部分，点击<b>内容设置</b>。<br>5、在Cookie 的选项里选择<b>允许设置本地数据（推荐）</b>。<br>6、点击<b>完成</b>进行保存。",this.Opera_text="1、单击<b>“菜单”</b>><b>“设置”</b>><b>“首选项”</b>。<br>2、在<b>“首选项”</b>对话框中，单击<b>“高级”</b>选项卡。<br>3、单击<b>Cookie</b>。<br>4、单击<b>“接受Cookie”</b>。<br>5、单击<b>“确定”</b>。"},regions:{},ui:{},events:function(){var a={};return a["click .again_check"]="againCheck",a["click .set_broswer"]="checkBroswer",a},isShowCookieIMG:function(a){var b=this,c=this.checkBroswerName(),d="";if(!a){switch(c){case"ie":d=b.ie_text;break;case"firefox":d=b.firefox_text;break;case"chrome":d=b.chrome_text;break;case"Opera":d=b.Opera_text;break;default:d=b.ie_text}this.$el.find(".set1").html(d).show()}},checkBroswerName:function(){var a={},b=navigator.userAgent.toLowerCase();return a.name=b.indexOf("firefox")>0?"firefox":"Opera Software ASA"===navigator.vendor?"Opera":b.indexOf("chrome")>0?"chrome":window.openDatabase?"safari":"ie",a.name},checkBroswer:function(){var b=this;$.cookie("theCookie","theValue");var c=$.cookie("theCookie");this.isCookie=c?!0:!1,this.checkStatus={isShowCookieIMG:this.isCookie},this.$el.find(".setting .common_tit").show(),this.$el.find(".setting_con").show(),this.$el.find(".setting_btns a").css("display","inline-block").show(),this.$el.find(".check_browser").hide(),this.isCookie?this.skipNext():a._.each(this.checkStatus,function(a,c){b[c]&&b[c](a)})},skipNext:function(){BSGlobal.isSkipBrowerSupport=!0,a.app.execute("history:navigate","#quiz/route",!0)},againCheck:function(){this.checkBroswer()},onRender:function(){},onShow:function(){a._.splash("guidance")},onClose:function(){}});return a.BasePageView.extend({mainViewClass:c,pageTitle:"设置页面",layout:"empty-layout"})}),define("views/quiz/login/index-page-view",["talent","templates/quiz","$.cookie","QuizErrorView"],function(a,b,c,d){var e=a.Layout.extend({template:b["quiz/login/index-page"],initialize:function(){this.hasSubmit=!1,this.hasID=!1,this.hasEmail=!1,this.hasCode=!1,this.isclickSubmit=!0,this.pageFlag=!0;var b=a.Context.getTenantInfo();b.introBigPic="login"==this.getUrl().flag?null:b.introBigPic,b.introBigPic&&$("body").css("overflow","hidden"),this.model=new a.Model(b),this.model.set({codeUrl:BSGlobal.apiPath+"/captcha?tmp="+new Date});var c=this;a.$(document).on("keydown",function(a){13==a.which&&c.isSubmit()})},regions:{main:".wrap"},ui:{id:'input[name="id"]',email:'input[name="email"]',code:'input[name="code"]',idError:".id_error .error_ico",emailError:".email_error .error_ico",codeError:".code_error .error_ico",codeCorr:".code_status",submit:".login_btn span"},events:function(){var a={};return a["click .login_btn span"]="isSubmit",a['blur input[name="id"]']="checkId",a["focus input"]="showBottomLine",a['blur input[name="email"]']="checkEmail",a['blur input[name="code"]']="checkCode",a['keyup input[name="code"]']="KcheckCode",a["click .refresh_code"]="refreshCode",a["click .code_status_err"]="deleteCode",a["click .start_test"]="startTest",a},getUrl:function(){var a=location.href,b=new Object;if(-1!=a.indexOf("?"))for(var c=a.substr(1),d=c.split("?"),e=0;e<d.length;e++)b[d[e].split("=")[0]]=unescape(d[e].split("=")[1]);return b},checkId:function(){$(".lable_sn").siblings(".bottom_line_animate").css({width:0,left:"50%",transition:"width .5s cublic-bezier(0.66,1.65,.23,.87),left .5s cublic-bezier(0.66,1.65,.23,.87)"});var b=a.$.trim(a.$(this.ui.id).val());""!=b?/^\d{13,13}$/.test(b)?($(".mess_erro").empty(),this.hasID=!0):($(".mess_erro").empty().text("请输入正确的通行证"),this.hasID=!1):($(".mess_erro").empty().text("通行证必填"),this.hasID=!1)},showBottomLine:function(a){$(a.currentTarget).parent().width();$(a.currentTarget).next().css({width:240,left:0})},refreshCode:function(){var a=this.$el.find(".code_img");a.attr("src",BSGlobal.apiPath+"/captcha?tmp="+new Date)},checkEmail:function(){$(".lable_email").siblings(".bottom_line_animate").css({width:0,left:"50%",transition:"width .5s cublic-bezier(0.66,1.65,.23,.87),left .5s cublic-bezier(0.66,1.65,.23,.87)"});var b=a.$.trim(a.$(this.ui.email).val()),c=/^([a-zA-Z0-9][_\.\-]*)+\@([A-Za-z0-9])+((\.|-|_)[A-Za-z0-9]+)*((\.[A-Za-z0-9]{2,4}){1,2})$/,d=c.test(b);""!=b?(b.length>50&&($(".mess_erro").empty().text("邮箱最多允许输入50个字符"),this.hasEmail=!1),0==d?b.length>50?($(".mess_erro").empty().text("邮箱最多允许输入50个字符"),this.hasEmail=!1):($(".mess_erro").empty().text("邮箱格式不正确"),this.hasEmail=!1):b.length>50?($(".mess_erro").empty().text("邮箱最多允许输入50个字符"),this.hasEmail=!1):($(".mess_erro").empty(),this.hasEmail=!0)):($(".mess_erro").empty().text("邮箱必填"),this.hasEmail=!1)},checkCode:function(){$(".lable_code").siblings(".bottom_line_animate").css({width:0,left:"50%",transition:"width .5s cublic-bezier(0.66,1.65,.23,.87),left .5s cublic-bezier(0.66,1.65,.23,.87)"});var b=$.Deferred(),c=a.$(this.ui.code),d=a.$.trim(c.val());if(""!=d)if(5==d.length){var e=this.validateCode(d);e.done(function(){b.resolve()})}else $(".mess_erro").empty().text("验证码长度有误"),this.hasCode=!1,b.resolve();else $(".mess_erro").empty().text("验证码必填"),this.hasCode=!1,b.resolve();return b.promise()},deleteCode:function(){a.$(this.ui.code).val(""),a.$(".code_status").removeClass("code_status_err").removeClass("code_status_cor").show(),$(".mess_erro").empty()},KcheckCode:function(){var b=$.Deferred(),c=a.$(this.ui.code),d=a.$.trim(c.val());if(5==d.length){var e=this.validateCode(d);e.done(function(){b.resolve()})}else 0==d.length?(a.$(".code_status").removeClass("code_status_err").removeClass("code_status_cor").show(),$(".mess_erro").empty(),this.hasCode=!1):d.length>5&&(a.$(this.ui.codeCorr).removeClass("code_status_cor").addClass("code_status_err").show(),$(".mess_erro").text("验证码长度有误"),this.hasCode=!1);return b.promise()},isSubmit:function(){$.Deferred();this.checkId(),this.hasID&&(this.checkEmail(),this.hasEmail&&(this.checkCode(),this.hasSubmit&&(this.isclickSubmit=!1,this.formSubmit())))},formSubmit:function(){var b=this,c=a.$.trim(a.$(this.ui.id).val()),e=a.$.trim(a.$(this.ui.email).val()),f=a.$.trim(a.$(this.ui.code).val()),g=!1;this.hasID&&this.hasEmail&&this.hasSubmit&&this.hasCode&&(g=!0),g&&!this.isclickSubmit&&(a.$(this.ui.submit).text("登录中···"),a.app.request("user:login",{id:c,email:e,code:f}).done(function(c){b.isclickSubmit=!1;var e=JSON.parse(c)||{};if(e.message.message&&e.message.type){if(3==e.message.type&&(a.$(b.ui.codeError).text(e.message.message).show(),a.$(b.ui.codeCorr).removeClass("code_status_cor").addClass("code_status_err").show()),1==e.message.type){var f=e.message.message,g=new a.Model;g.set({message:'<span class="_new_error_tip">'+f+"</span>",isShowHead:!0});var h=new d({model:g});b.main.show(h),a.app.execute("document:changePageTitle","提示页面",!0),b.$el.find(".login_foot_wrap").css({"border-top":"1px solid #FFF",background:"#E0E0E0","margin-top":"100px"}),b.$el.find(".login_foot").css({background:"#E0E0E0",border:"none"})}4==e.message.type&&a.app.execute("history:navigate","#quiz/login-error?type=pageblur",!0)}else{if(e.isHaveNtpTest&&!b.checkBroswerSurport())return!1;a._.isUndefined(e.currentJumpCount)||(e.jumpCount=e.currentJumpCount),a.Context.setBSGlobalInfo(e),BSGlobal.IsFromLogin=!0,a.app.execute("history:navigate","#quiz/route",!0)}}))},validateCode:function(b){var c=this,d=$.Deferred();return a.app.request("user:getCode",{code:b}).done(function(b){var e=JSON.parse(b);e.message.message&&e.message.type?3==e.message.type?(c.hasSubmit=!1,c.hasCode=!1,$(".mess_erro").text("请输入正确的验证码").show(),a.$(c.ui.codeCorr).removeClass("code_status_cor").addClass("code_status_err").show(),a.$(c.ui.codeError).text(e.message.message).show(),c.refreshCode(),d.resolve()):1==e.message.type&&(c.hasSubmit=!1,a.app.execute("history:navigate","#quiz/login-error",!0),d.resolve()):(c.hasSubmit=!0,c.hasCode=!0,a.$(c.ui.codeCorr).removeClass("code_status_err").addClass("code_status_cor").show(),a.$(c.ui.codeError).hide(),d.resolve())}),d.promise()},checkBroswerSurport:function(){var b,c=a.$.browser,d=navigator.userAgent.toLowerCase(),e=/(chrome)(?:.*version)?[ \/]([\w.]+)/,f=e.exec(d)||[];return c.msie?(a.app.execute("history:navigate","#quiz/login-error?type=ntp",!0),!1):("chrome"==f[1]&&f[2]&&(b=f[2]),"Google Inc."!=navigator.vendor||b&&parseInt(b)<42?(a.app.execute("history:navigate","#quiz/login-error?type=ntp",!0),!1):!0)},startTest:function(){$(".bg_wrap").remove(),$(".login_page-wrap").remove(),$("body").css("overflow","auto")},onRender:function(){},onShow:function(){a._.splash("login")},onClose:function(){a.$(document).off("keydown")}});return a.BasePageView.extend({mainViewClass:e,pageTitle:"首页",layout:"empty-layout"})}),define("views/quiz/login-error/index-page-view",["talent","templates/quiz"],function(a,b){var c=a.Layout.extend({template:b["quiz/login-error/index-page"],initialize:function(){this.model=new a.Model({loginUserInfo:a.Context.getBaseGlobalInfoByName("loginUserInfo"),tenantInfo:a.Context.getBaseGlobalInfoByName("tenantInfo"),activityInfo:a.Context.getBaseGlobalInfoByName("activityInfo")});{var b=decodeURIComponent(window.location.hash),c=b.match(/type=(.*)/)||[],d="";this.getDownLoad()}switch(c=c[1]){case"pageblur":d="<p>离开作答页面次数过多，答题已终止</p>";break;case"ntp":d=a.Context.getCameraNoMediaDes();break;case"disagree":d="<p>您已退出作答，继续作答请重新登录</p>";break;case"login":d=a.Context.getCameraNoMediaDes();break;case"video":d=a.Context.getVideoNoMediaDes();break;case"camera":d=a.Context.getCameraNoMediaDes()}this.model.set("text",d);var e=a.Context.getTenantInfo().message,f=a.Context.getActivityInfo(),g=a.Context.getUserInfo();return e.message&&1==e.type?void this.model.set("text","<p>"+e.message+"<p>"):(f&&(f.id||1==f.snId&&this.model.set("text","<p>"+f.name+"<p>")),void(g.message&&g.message.message&&this.model.set("text","<p>"+g.message.message+"<p>")))},getDownLoad:function(){var a="";return a="<p class='tip'><a target='_black'  href='https://www.baidu.com/s?wd=chrome'>点此下载</a>并安装最新版谷歌（Chrome）浏览器</p>"},regions:{},ui:{},events:function(){var a={};return a},onRender:function(){a.Context.removeCookie()},onShow:function(){var b=decodeURIComponent(window.location.hash),c=b.match(/type=(.*)/)||[];c=c[1],"disagree"==c&&$(".mascot_erro_img").addClass("disagree_err"),window.location.replace(location.href),a._.splash("login-error")},onClose:function(){}});return a.BasePageView.extend({mainViewClass:c,pageTitle:"提示页面",layout:"empty-layout"})}),define("views/quiz/no-support/index-page-view",["talent","templates/quiz"],function(a,b){var c=a.Layout.extend({template:b["quiz/no-support/index-page"],initialize:function(){this.model=new a.Model({loginUserInfo:a.Context.getBaseGlobalInfoByName("loginUserInfo"),tenantInfo:a.Context.getBaseGlobalInfoByName("tenantInfo"),downLoad:this.getDownLoad()})},regions:{},ui:{},getDownLoad:function(){var a="",b=window.navigator.userAgent.toLocaleLowerCase(),c={windows:"<a target='_black' style='display:block' href='http://assessment.oss-cn-hangzhou.aliyuncs.com/Chrome%2F44.0.2403.89_chrome_installer.exe'>下载windows系统推荐版本的Chrome浏览器</a>",macintosh:"<a target='_black' style='display:block' href='http://assessment.oss-cn-hangzhou.aliyuncs.com/Chrome%2Fgooglechrome.dmg'>下载Mac系统推荐版本的Chrome浏览器</a>"};return _.each(c,function(c,d){b.indexOf(d)>0&&(a=c)}),a},events:function(){var a={};return a["click .btn"]="exit",a},exit:function(){a.app.execute("history:navigate","#quiz/login-error?type=disagree",!0)},onRender:function(){a.Context.removeCookie()},onShow:function(){a._.splash("no-support")},onClose:function(){}});return a.BasePageView.extend({mainViewClass:c,pageTitle:"提示页面",layout:"empty-layout"})}),define("views/quiz/pre-read/index-page-view",["talent","templates/quiz","countdown","views/common/component/user-feedback-board"],function(a,b,c){var d=a.Layout.extend({template:b["quiz/pre-read/index-page"],className:"quiz_container",initialize:function(){this.times=0;var b=a.Context.getBaseGlobalInfoByName("isHaveResult");b||this.setCutdownText(),this.nearAnswerSecondsFlag=!0},regions:{messBoard:".user_feedback"},ui:{},events:function(){var a={};return a["click .coming a"]="nextStep",a},getCutdown:function(){var b=new a.$.Deferred,c=this;return this.times=this.times+1,a.app.request("time:getCutdown",{times:c.times}).done(function(a){var c=JSON.parse(a),d=c.countdown;b.resolve(d)}),b.promise()},setCutdownText:function(){var b=this,c=a.Context.getBaseGlobalInfoByName("activityInfo");this.getCutdown().done(function(d){var e=b.$el.find(".btns"),d=d>0&&10>=d?10:d;if(d>0){if(b.setCutdown(d,"preload"),b.$el.find(".countdown_pre").text("距离开始还有"),b.$el.find(".countdown_after").text(",请耐心等待"),e.hasClass("coming")?e.removeClass("coming").addClass("disable"):e.addClass("disable"),b.clickCutDown=!1,c.isPreLoad){var f=c.preloadSeconds;f=Math.floor(f&&d>f?Math.random()*f+(d-f):Math.random()*d),setTimeout(function(){a.app.request("quizsection:getAllSectionData",{isRecordInterrupt:!1,_v:Math.floor(1e4*Math.random())})},1e3*f)}}else if(0==d){if(b.setCutdown(10),b.$el.find(".countdown_pre").text("进入试卷（ "),b.$el.find(".countdown_after").text(" ）"),e.hasClass("coming")?e.removeClass("coming").addClass("disable"):e.addClass("disable"),b.clickCutDown=!1,c.isPreLoad){var f=Math.floor(10*Math.random(0,1));setTimeout(function(){a.app.request("quizsection:getAllSectionData",{isRecordInterrupt:!1,_v:Math.floor(1e4*Math.random())})},1e3*f)}}else if(0>d){if(b.clickCutDown)return a.Context.setBSGlobalInfo({isEnter:!0}),void a.app.execute("history:navigate","#quiz/formal",!0);b.$el.find(".countdown_pre").text("进入试卷"),b.$el.find(".countdown").text(""),b.$el.find(".countdown_after").text(""),e.hasClass("disable")?e.removeClass("disable").addClass("coming"):e.addClass("coming")}})},setCutdown:function(a,b){var b=b||"",d=this,e=d.$el.find(".countdown");this.countdown&&this.countdown._clear(),this.countdown=new c({node:e,countdown:a,format:"h时m分s秒",emptyHide:!0,hideZero:!0,type:b}),this.countdown.start(),e.on("nearAnswerSeconds",function(){d.nearAnswerSecondsFlag&&(d.setAnswerCountDownText(),d.nearAnswerSecondsFlag=!1)}),e.on("over",function(){d.$el.find(".countdown").text("0秒"),d.setBtnActive()})},setAnswerCountDownText:function(){var b=this;this.getCutdown().done(function(c){var d=b.$el.find(".btns"),c=c>0&&10>=c?10:c;if(c>0)b.setCutdown(c),b.$el.find(".countdown_pre").text("距离开始还有"),b.$el.find(".countdown_after").text(",请耐心等待"),d.hasClass("coming")?d.removeClass("coming").addClass("disable"):d.addClass("disable"),b.clickCutDown=!1;else if(0==c)b.setCutdown(10),b.$el.find(".countdown_pre").text("进入试卷（ "),b.$el.find(".countdown_after").text(" ）"),d.hasClass("coming")?d.removeClass("coming").addClass("disable"):d.addClass("disable"),b.clickCutDown=!1;else if(0>c){if(b.clickCutDown)return a.Context.setBSGlobalInfo({isEnter:!0}),void a.app.execute("history:navigate","#quiz/formal",!0);b.$el.find(".countdown_pre").text("进入试卷"),b.$el.find(".countdown").text(""),b.$el.find(".countdown_after").text(""),d.hasClass("disable")?d.removeClass("disable").addClass("coming"):d.addClass("coming")}})},setBtnActive:function(){var a=this,b=a.$el.find(".btns");a.$el.find(".countdown_pre").text("进入试卷"),a.$el.find(".countdown").text(""),a.$el.find(".countdown_after").text(""),b.hasClass("disable")?b.removeClass("disable").addClass("coming"):b.addClass("coming")},nextStep:function(b){var c=a.$(b.currentTarget);this.clickCutDown=!0,c.parent().hasClass("coming")&&(a.Context.setBSGlobalInfo({notRequestAnswer:!0}),a.app.execute("history:navigate","#quiz/formal",!0))},onRender:function(){var b=a.Context.getBaseGlobalInfoByName("isHaveResult"),c=this.$el.find(".btns");b&&(c.hasClass("disable")?c.removeClass("disable").addClass("coming"):c.addClass("coming"),this.$el.find(".coming .countdown_pre").text("继续作答"))},onShow:function(){a._.splash("pre-read")},onClose:function(){}});return a.BasePageView.extend({mainViewClass:d,pageTitle:"考前阅读",hideSidebar:!0})}),define("views/quiz/promise/index-page-view",["talent","templates/quiz","$.cookie","views/common/component/user-feedback-board"],function(a,b){var c=a.Layout.extend({template:b["quiz/promise/index-page"],className:"quiz_container",initialize:function(){window.skipPage=!0},regions:{messBoard:".user_feedback"},ui:{},events:function(){var a={};return a["click .agree"]="onAgree",a["click .disagree"]="onDisAgree",a},onAgree:function(){BSGlobal.IsAgree=!0,a.app.execute("history:navigate","#quiz/route",!0)},onDisAgree:function(){a.app.execute("history:navigate","#quiz/login-error?type=disagree",!0)},onRender:function(){},onShow:function(){a._.splash("promise")},onClose:function(){}});return a.BasePageView.extend({mainViewClass:c,pageTitle:"作答承诺",hideSidebar:!0})}),define("views/quiz/route/index-page-view",["talent","templates/quiz","$.cookie"],function(a,b){var c=a.Layout.extend({template:b["quiz/route/index-page"],initialize:function(){var b=this;BSGlobal.isSkipBrowerSupport=!0,this.checkStatus={checkIsMaintain:!0,checkBrowerVersion:!0,checkPageBlurCount:!0,checkIsSkipToErroe:!0,checkBrowerSupport:!0,checkIsHaveResult:!0,checkCheckCamaraConfig:!0},this.isCookieOpen();var c=!0;a._.each(b.checkStatus,function(a,d){b[d]&&c&&(c=c&&b[d]())})},regions:{},ui:{},events:function(){var a={};return a},onRender:function(){},checkIsMaintain:function(){return BSGlobal.isMainTaining.isUpgrade?(a.app.execute("history:navigate","#quiz/maintain",!0),!1):!0},checkBrowerVersion:function(){var b,c=a.$.browser,d=navigator.userAgent.toLowerCase(),e=/(chrome)(?:.*version)?[ \/]([\w.]+)/,f=e.exec(d)||[],g=a.Context.getActivityInfo()&&a.Context.getActivityInfo().isEnableCamera,h=a.Context.getActivityInfo()&&a.Context.getActivityInfo().IsVideoAnswer,i=a.Context.getBaseGlobalInfoByName("isHaveNtpTest");if(i&&c.msie)return a.app.execute("history:navigate","#quiz/login-error?type=ntp",!0),!1;if(c.msie&&parseInt(c.version)<8)return a.app.execute("history:navigate","#quiz/no-support",!0),!1;if("chrome"==f[1]&&f[2]&&(b=f[2]),h){if(h&&("Google Inc."!=navigator.vendor||b&&parseInt(b)<42))return a.app.execute("history:navigate","#quiz/login-error?type=video",!0),!1}else if(i){if("Google Inc."!=navigator.vendor||b&&parseInt(b)<42)return a.app.execute("history:navigate","#quiz/login-error?type=ntp",!0),!1}else if(g&&("Google Inc."!=navigator.vendor||b&&parseInt(b)<42))return a.app.execute("history:navigate","#quiz/login-error?type=login",!0),!1;return!0},checkBrowerSupport:function(){var b=location.search.split("=")[0],c=a.Context.getBaseGlobalInfoByName("isSkipBrowerSupport");return c?"?elink"==b?!0:BSGlobal.IsFromLogin?!0:(a.app.execute("history:navigate","#quiz/login",!0),!1):(a.app.execute("history:navigate","#quiz/guidance",!0),!1)},checkPageBlurCount:function(){var b=parseInt(a.Context.getBaseGlobalInfoByName("jumpCount")||0),c=a.Context.getBaseGlobalInfoByName("activityInfo")||{},d=c.IsJumpPage,e=parseInt(c.JumpCount||0);return!d||e>b?!0:a.$.cookie("beisencp")?(a.app.execute("history:navigate","#quiz/login-error?type=pageblur",!0),!1):(a.app.execute("history:navigate","#quiz/login",!0),!1)},checkIsSkipToErroe:function(){var b=a.Context.getTenantInfo().message,c=a.Context.getActivityInfo(),d=location.search.split("=")[0],e=a.Context.getUserInfo();if("?elink"==d){if(b.message&&1==b.type)return a.app.execute("history:navigate","#quiz/login-error",!0),!1;if(c&&!c.id)return a.app.execute("history:navigate","#quiz/login-error",!0),!1;if(e.message&&e.message.message)return a.app.execute("history:navigate","#quiz/login-error",!0),!1}else if(b.message&&1==b.type)return a.app.execute("history:navigate","#quiz/login-error",!0),!1;return!0},checkIsHaveResult:function(){var b=a.Context.getBaseGlobalInfoByName("isHaveResult"),c=a.Context.getBaseGlobalInfoByName("IsAgree");return c?!0:b?!0:(a.app.execute("history:navigate","#quiz/promise",!0),!1)},checkCheckCamaraConfig:function(){var b=a.Context.getActivityInfo()&&a.Context.getActivityInfo().isEnableCamera,c=a.Context.getBaseGlobalInfoByName("isSavePhoto");
!b||b&&c?a.app.execute("history:navigate","#quiz/user_mes",!0):b&&!c&&a.app.execute("history:navigate","#quiz/take-photo",!0)},isCookieOpen:function(){$.cookie("theCookie","theValue");var a=$.cookie("theCookie");this.isCookie=a?!0:!1,BSGlobal.isSkipBrowerSupport=this.isCookie?!0:!1},onShow:function(){a._.splash("route")},onClose:function(){}});return a.BasePageView.extend({mainViewClass:c,pageTitle:"quiz/promise",layout:"empty-layout"})}),define("views/quiz/take-photo/index-page-view",["talent","templates/quiz","views/common/component/user-feedback-board"],function(a,b){var c=a.Layout.extend({template:b["quiz/take-photo/index-page"],className:"quiz_container",initialize:function(){BSGlobal.activityInfo.isEnableCamera?this.getWebcam():(window.isRejectGamera=!0,this.noSupportCallback()),this.photoUrl=[],this.isStop=!1,this.currentPageUrl=location.hash,this.hasSaved=!1},regions:{messBoard:".user_feedback"},ui:{btns:".btns .samll",saveBtn:".save",skipBtn:".skip",exitBtn:".exit",againBtn:".again",video:"#video",picture:".picture",tipText:".tip",fadePop:".fadePop"},events:function(){var a={};return a["click  .skip"]="skipThisStep",a["click  .webcam_btn"]="takePhoto",a["click  .again"]="againTakePhoto",a["click  .save"]="savePhoto",a["click  .exit"]="exit",a["click  .con_btn"]="closeFadePop",a["click  .skip_btn"]="nextStep",a},getWebcam:function(){var b=this;navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,this.getUserMedia=navigator.getUserMedia,navigator.getUserMedia?navigator.getUserMedia({video:!0},function(a){b.successCallback(a)},function(){window.isRejectGamera=!0,a.app.vent.trigger("change:GameraStatus",!0)}):this.noSupportCallback()},successCallback:function(a){if(this.currentPageUrl==location.hash){window._assessmentStreamRef=a,window.openGamera=!0,this.$el.find(".photo_con").hide(),this.$el.find("#webcam").show(),this.$el.find(".takephoto_tip").show(),this.$el.find(".webcam_btn_wrap").show();var b=this.$el.find("video")[0];b.height=300,b.width=400,void 0!==b.mozSrcObject?b.mozSrcObject=a:(b.src=window.URL&&window.URL.createObjectURL(a)||a,localMediaStream=a),b.play()}},noSupportCallback:function(){var b=this;window.isRejectGamera=!0,setTimeout(function(){a.$(b.ui.skipBtn).attr("type",1),a.$(b.ui.skipBtn).text("跳过，继续").show(),a.$(b.ui.exitBtn).css("display","inline-block").show(),a.$(b.ui.saveBtn).hide(),a.$(b.ui.againBtn).hide(),a.$(b.ui.tipText).text("您的浏览器不支持启用摄像头，您可以跳过拍照环节")},0)},takePhoto:function(b){var c=this,d=a.$(b.currentTarget),e=document.createElement("canvas"),f=e.getContext("2d"),g=a.$(this.ui.video).get(0),h=g.width,i=g.height;if(e.width=h,e.height=i,a.$(e).hide(),a.$(document.body).append(e),0==this.photoUrl.length){f.drawImage(g,0,0,h,i);var j="",j=e.toDataURL("image/jpeg");this.photoUrl.push(e.toDataURL("image/jpeg").split(",")[1]),a.$(this.ui.picture).find("img").attr({src:j,width:400,height:300}),a.$(this.ui.picture).css("margin-left","1px").show(),d.parent().addClass("webcam_btn_wrap_disabled")}a.$(c.ui.saveBtn).show(),a.$(c.ui.againBtn).show()},againTakePhoto:function(){this.photoUrl=[],a.$(this.ui.picture).hide(),this.$el.find(".webcam_btn_wrap_disabled").removeClass("webcam_btn_wrap_disabled")},savePhoto:function(){var b=this;this.hasSaved||""!=b.photoUrl&&(this.hasSaved=!0,a.app.request("user:saveIpSchoolTime",{imgBase64Data:b.photoUrl,monitorDataType:0,type:1,isFaceDetect:a.Context.getBaseGlobalInfoByName("isFaceDetect")}).done(function(c){var d=JSON.parse(c);null==d.message&&null==d.type?a.app.execute("history:navigate","#quiz/user_mes",!0):"false"==d.message&&b.oldSavePhoto()}))},oldSavePhoto:function(){var b=this;a.app.request("user:takePhoto",{ImgBase64Data:b.photoUrl,monitorDataType:0}).done(function(b){JSON.parse(b);a.app.execute("history:navigate","#quiz/user_mes",!0)})},skipThisStep:function(){a.$(this.ui.fadePop).show()},closeFadePop:function(){a.$(this.ui.fadePop).hide()},exit:function(){window.opener=null,window.open("","_self",""),window.close()},nextStep:function(){a.app.execute("history:navigate","#quiz/user_mes",!0)},onRender:function(){var b=this;a.$(b.ui.saveBtn).hide(),a.$(b.ui.againBtn).hide()},onShow:function(){},onClose:function(){}});return a.BasePageView.extend({mainViewClass:c,pageTitle:"拍照",hideSidebar:!0})}),define("views/quiz/user_mes/index-page-view",["talent","validation","templates/quiz","views/common/component/quiz-fade-view","views/common/component/user-feedback-board"],function(a,b,c,d){var e=a.Layout.extend({template:c["quiz/user_mes/index-page"],className:"quiz_container",initialize:function(){var b=a.Context.getUserInfo().email;this.name=a.Context.getUserInfo().name;var c=a.Context.getCommonData(),d=JSON.stringify(c),e=BSGlobal.apiPath.split("/api")[0];if(this.model.set({UserInfo:d,email:b,iframeUrl:e}),BSGlobal.activityInfo.IsContact){var f=BSGlobal.activityInfo.Contact;this.model.set("phone",f)}else this.model.set("phone","");window.updateIframeStatus=_.bind(this.IframeFN,this),document.domain=window.location.host.indexOf(".cn")>0?"ceping.com.cn":"ceping.com"},regions:{fade:".fadePop",messBoard:".user_feedback"},ui:{},events:function(){var a={};return a["click .btns .skip"]="skip",a},IframeFN:function(b,c){if(1==b){var e=a.Context.getBaseGlobalInfoByName("activityInfo")||{},f=e.isEnableCamera;if(window._assessmentStreamRef||!f)a.app.execute("history:navigate","#quiz/pre-read",!0),BSGlobal.loginUserInfo.name=c,a.app.vent.trigger("updateUserName",c),this.setRequestUrlsFlag();else if(f&&!window._assessmentStreamRef){{a.Context.getBaseGlobalInfoByName("staticPath"),location.hostname}this.fade.show(new d({model:new a.Model({message:a.Context.getPopNoMediDes(),btns:[{type:"btn_continue",text:"确定"}]})}))}}else 0==b&&a.app.execute("history:navigate","#quiz/login",!0)},onRender:function(){var b=this,c=document.createElement("iframe");c.setAttribute("id","ifrm1"),c.setAttribute("src",b.model.get("iframeUrl")+"/AssessmentInfo/ConformInfo?email="+encodeURIComponent(b.model.get("email"))+"&UserInfo="+encodeURIComponent(b.model.get("UserInfo"))),c.setAttribute("frameBorder","0"),c.setAttribute("scrolling","no"),this.$el.find(".mes_wrap").append(c),this.$el.find("#ifrm1").on("load",function(){a.$(".mes_tip").show(),b.$el.find(".loading").hide(),$($("#ifrm1")[0].contentWindow.document.body).find(".wrapper").css({"padding-top":"0px",width:900}),$($("#ifrm1")[0].contentWindow.document.body).find(".main").css({width:"100%"}),$($("#ifrm1")[0].contentWindow.document.body).find(".form_part").css({fontFamily:"Microsoft YaHei","font-size":"14px"}),$($("#ifrm1")[0].contentWindow.document.body).find(".desc").css({"font-size":"12px","margin-top":"5px",color:"aeb7bf"}),$($("#ifrm1")[0].contentWindow.document.body).find(".form_part_container li").attr("style","background:#fff"),$($("#ifrm1")[0].contentWindow.document.body).find('.form_part_container li input[type!="radio"]').attr("style","width:360px;height:28px;padding-left:5px;border-color:#aeb7bf"),$($("#ifrm1")[0].contentWindow.document.body).find(".form_part_container li select").attr("style","width:368px;height:30px;padding-left:5px;border-color:#aeb7bf"),$($("#ifrm1")[0].contentWindow.document.body).find(".form_part_container li .radio_label").css("padding-right","40px"),$($("#ifrm1")[0].contentWindow.document.body).find(".form_container").css({"margin-left":"-55px",padding:"7px 10px",width:941}),$($("#ifrm1")[0].contentWindow.document.body).find("#submitBtn").css({padding:"8px 0px","line-height":"12px",display:"inline-block"}),$($("#ifrm1")[0].contentWindow.document.body).find("#submitBtn span").attr("style","background:#3C61A6;width180px;color:#fff;font-size:14px;"),$($("#ifrm1")[0].contentWindow.document.body).find(".form_part_container li input.mul_checkbox").attr("style","width:auto;padding-left:5px");var c=($($("#ifrm1")[0].contentWindow.document.body).find(".wrapper").width()+60,$($("#ifrm1")[0].contentWindow.document.body).find(".wrapper").height());b.$el.find("#ifrm1").css({width:860,height:c,"margin-left":"-10px"}),$($("#ifrm1")[0].contentWindow.document.body).find(".saveBtn").css({background:"#0095ff",padding:"7px 20px !important"}),$($("#ifrm1")[0].contentWindow.document.body).find(".Wdate").css({background:"url('https://stnewcp03.beisen.com/ux/tools-assessment/release/app/images/select_time.png') no-repeat right"}),$($("#ifrm1")[0].contentWindow.document.body).find(".area").css({background:"url('https://stnewcp03.beisen.com/ux/tools-assessment/release/app/images/select_area.png') no-repeat 555px 50%",padding:"0 0 0 5px"}),$($("#ifrm1")[0].contentWindow.document.body).find(".btngray").css({"margin-top":"30px"})})},skip:function(){a.app.execute("history:navigate","#quiz/pre-read",!0)},onShow:function(){""!=this.name?a.$(".mes_tip").show():a.$(".mes_tip").hide(),(window.isRejectGamera||window.openGamera)&&a.$(".tip").hide(),this.model.get("phone")?this.$el.find(".phone").show():this.$el.find(".phone").hide(),a.app.vent.on("change:GameraStatus",function(b){b&&setTimeout(function(){a.$(".tip").hide()},0)}),_.splash("user_mes")},setRequestUrlsFlag:function(){a.Context.setBSGlobalInfo({isFirstRememberStartTime:!0,isFirstRecordPageChange:!0,isEntryed:!0})},onClose:function(){}});return a.BasePageView.extend({mainViewClass:e,pageTitle:"个人信息",hideSidebar:!0})}),define("views/quiz/complete/index-page-view",["talent","templates/quiz","views/common/component/user-feedback-board"],function(a,b){var c=a.Layout.extend({template:b["quiz/complete/index-page"],className:"quiz_container",initialize:function(){this.model=new a.Model({loginUserInfo:a.Context.getBaseGlobalInfoByName("loginUserInfo"),tenantInfo:a.Context.getBaseGlobalInfoByName("tenantInfo"),activityInfo:a.Context.getBaseGlobalInfoByName("activityInfo")});var b=decodeURIComponent(window.location.hash),c=b.match(/type=(.*)/)||[],d="";switch(c=c[1]){case"complete":d='<p style="margin-top:60px">您已完成作答，作答结果已提交</p>',BSGlobal.activityInfo&&BSGlobal.activityInfo.id&&a.app.request("report:searchReport",{activityId:BSGlobal.activityInfo.id}).done(function(a){var b=JSON.parse(a)||{};b.isSeacher&&(d='<p style="margin-top:30px">您已完成作答，作答结果已提交</p>',d+='<p class="completed_tips">',d+="<span>您还可以点此查询答题结果，</span>",d+='<a href="#quiz/search-one?sn='+BSGlobal.activityInfo.sn+"&email="+BSGlobal.loginUserInfo.email+"&tenantId="+BSGlobal.tenantInfo.id+'">点此查询</a>',b.time&&(d+="（有效期"+b.time+"小时）"),d+="</p>")});break;case"Interrupt":d="<p>作答结果已保存</p><p>请稍后重新登录继续作答</p>";break;case"pageblur":d="<p>离开作答页面次数过多，答题已终止</p>"}this.model.set("text",d);a.Context.getTenantInfo().message,a.Context.getActivityInfo();try{window._assessmentStreamRef&&window._assessmentStreamRef.stop()}catch(e){}this.addCookie("theCookie","",-1)},addCookie:function(a,b,c){if(c){var d=new Date;d.setDate(d.getDate()+c),document.cookie=a+"="+b+";path=/;expires="+d}},regions:{messBoard:".user_feedback"},ui:{},events:function(){var a={};return a},onRender:function(){},onShow:function(){window.location.replace(location.href);var b=decodeURIComponent(window.location.hash),c=b.match(/type=(.*)/)||[];switch(c=c[1]){case"complete":$(".foot_bg").addClass("complete_bg"),$(".mascot_img").addClass("mascot_comlete_img");break;case"Interrupt":$(".foot_bg").addClass("erro_bg"),$(".mascot_img").addClass("mascot_erro_img");break;case"pageblur":$(".foot_bg").addClass("erro_bg"),$(".mascot_img").addClass("mascot_page_jump")}a.Context.resultManager.clear()},onClose:function(){}});return a.BasePageView.extend({mainViewClass:c,pageTitle:"完成页面",layout:"empty-layout"})}),define("views/quiz/search/index-page-view",["talent","templates/quiz","$.cookie","QuizErrorView"],function(a,b,c,d){var e=a.Layout.extend({template:b["quiz/search/index-page"],initialize:function(){this.hasSubmit=!1,this.hasID=!1,this.hasEmail=!1,this.hasCode=!1,this.isclickSubmit=!0;var b=a.Context.getTenantInfo();this.model=new a.Model(b),this.model.set("codeUrl",BSGlobal.apiPath+"/captcha?tmp="+new Date);var c=this;a.$(document).on("keydown",function(a){13==a.which&&c.isSubmit1()})},regions:{main:".search_report"},ui:{id:'input[name="id"]',email:'input[name="email"]',code:'input[name="code"]',idError:".id_error .error_ico",emailError:".email_error .error_ico",codeError:".code_error .error_ico",codeCorr:".code_status",submit:".login_btn span"},events:function(){var a={};return a["click .report_search span"]="isSubmit1",a['blur input[name="id"]']="checkId",a['blur input[name="email"]']="checkEmail",a['blur input[name="code"]']="checkCode",a['keyup input[name="code"]']="KcheckCode",a["click .refresh_code"]="refreshCode",a["click .code_status_err"]="deleteCode",a},checkId:function(){var b=a.$.trim(a.$(this.ui.id).val());""!=b?/^\d{13,13}$/.test(b)?(a.$(this.ui.idError).hide(),this.hasID=!0):(a.$(this.ui.idError).text("请输入正确的通行证").show(),this.hasID=!1):(a.$(this.ui.idError).text("必填").show(),this.hasID=!1)},refreshCode:function(){var a=this.$el.find(".code_img");a.attr("src",BSGlobal.apiPath+"/captcha?tmp="+new Date)},checkEmail:function(){var b=a.$.trim(a.$(this.ui.email).val()),c=/^([a-zA-Z0-9][_\.\-]*)+\@([A-Za-z0-9])+((\.|-|_)[A-Za-z0-9]+)*((\.[A-Za-z0-9]{2,4}){1,2})$/,d=c.test(b);""!=b?(b.length>50&&(a.$(this.ui.emailError).text("最多允许输入50个字符").show(),this.hasEmail=!1),0==d?b.length>50?(a.$(this.ui.emailError).text("最多允许输入50个字符").show(),this.hasEmail=!1):(a.$(this.ui.emailError).text("邮箱格式不正确").show(),this.hasEmail=!1):b.length>50?(a.$(this.ui.emailError).text("最多允许输入50个字符").show(),this.hasEmail=!1):(a.$(this.ui.emailError).hide(),this.hasEmail=!0)):(a.$(this.ui.emailError).text("必填").show(),this.hasEmail=!1)},checkCode:function(){var b=$.Deferred(),c=a.$(this.ui.code),d=a.$.trim(c.val());if(""!=d)if(5==d.length){var e=this.validateCode(d);e.done(function(){b.resolve()})}else a.$(this.ui.codeError).text("验证码长度有误").show(),this.hasCode=!1,b.resolve();else a.$(this.ui.codeError).text("必填").show(),this.hasCode=!1,b.resolve();return b.promise()},deleteCode:function(){a.$(this.ui.code).val(""),a.$(".code_status").removeClass("code_status_err").removeClass("code_status_cor").show(),a.$(this.ui.codeError).hide()},KcheckCode:function(){var b=$.Deferred(),c=a.$(this.ui.code),d=a.$.trim(c.val());if(5==d.length){var e=this.validateCode(d);e.done(function(){b.resolve()})}else 0==d.length?(a.$(".code_status").removeClass("code_status_err").removeClass("code_status_cor").show(),a.$(this.ui.codeError).hide(),this.hasCode=!1):d.length>5&&(a.$(this.ui.codeCorr).removeClass("code_status_cor").addClass("code_status_err").show(),a.$(this.ui.codeError).text("验证码长度有误").show(),this.hasCode=!1);return b.promise()},isSubmit1:function(){$.Deferred();this.checkId(),this.checkEmail(),this.checkCode(),this.hasSubmit&&(this.isclickSubmit=!1,this.formSubmit())},formSubmit:function(){var b=this,c=a.$.trim(a.$(this.ui.id).val()),e=a.$.trim(a.$(this.ui.email).val()),f=a.$.trim(a.$(this.ui.code).val()),g=!1;this.hasID&&this.hasEmail&&this.hasSubmit&&this.hasCode&&(g=!0),g&&!this.isclickSubmit&&(a.$(this.ui.submit).text("登录中···"),a.app.request("report:searchLogin",{id:c,email:e,code:f,tenantId:BSGlobal.tenantInfo.id}).done(function(c){b.isclickSubmit=!1;var e=JSON.parse(c)||{};if(e.message.message&&e.message.type){var f=e.message.message,g=new a.Model;g.set({message:f,isShowHead:!0,report:!0});var h=new d({model:g});b.main.show(h),a.app.execute("document:changePageTitle","提示页面",!0),b.$el.find(".login_foot_wrap").css({"border-top":"1px solid #FFF",background:"#E0E0E0","margin-top":"100px"}),b.$el.find(".login_foot").css({background:"#E0E0E0",border:"none"})}else a._.isUndefined(e.currentJumpCount)||(e.jumpCount=e.currentJumpCount),a.Context.setBSGlobalInfo(e),a.app.execute("history:navigate","#quiz/report",!0)}))},validateCode:function(b){var c=this,d=$.Deferred();return a.app.request("user:getCode",{code:b}).done(function(b){var e=JSON.parse(b);e.message.message&&e.message.type?3==e.message.type?(c.hasSubmit=!1,c.hasCode=!1,a.$(c.ui.codeCorr).removeClass("code_status_cor").addClass("code_status_err").show(),a.$(c.ui.codeError).text(e.message.message).show(),d.resolve()):1==e.message.type&&(c.hasSubmit=!1,a.app.execute("history:navigate","#quiz/login-error",!0),d.resolve()):(c.hasSubmit=!0,c.hasCode=!0,a.$(c.ui.codeCorr).removeClass("code_status_err").addClass("code_status_cor").show(),a.$(c.ui.codeError).hide(),d.resolve())}),d.promise()},onRender:function(){BSGlobal.tenantInfo&&BSGlobal.tenantInfo.logoUrl&&this.$el.find(".logo img").attr("src",BSGlobal.tenantInfo.logoUrl)},onShow:function(){a._.splash("login")},onClose:function(){a.$(document).off("keydown")}});return a.BasePageView.extend({mainViewClass:e,pageTitle:"自助查询平台",layout:"empty-layout"})}),define("views/quiz/report/report-item",["talent","templates/quiz"],function(a,b){return a.ItemView.extend({template:b["quiz/report/report-item"],tagName:"div",initialize:function(){},ui:{},events:function(){var a={};return a},onRender:function(){},onShow:function(){},onClose:function(){}})}),define("views/quiz/report/report-composite",["talent","templates/quiz","views/quiz/report/report-item"],function(a,b,c){return a.CompositeView.extend({template:b["quiz/report/report-composite"],itemView:c,itemViewContainer:".report_link",initialize:function(){this.collection=new a.Collection(this.options.data)},ui:{},events:function(){},onRender:function(){},onShow:function(){},onClose:function(){}})}),define("views/quiz/report/score-item",["talent","templates/quiz"],function(a,b){return a.ItemView.extend({template:b["quiz/report/score-item"],tagName:"div",initialize:function(){},ui:{},events:function(){var a={};return a},onRender:function(){},onShow:function(){},onClose:function(){}})}),define("views/quiz/report/score-composite",["talent","templates/quiz","views/quiz/report/score-item"],function(a,b,c){return a.CompositeView.extend({template:b["quiz/report/score-composite"],itemView:c,itemViewContainer:".report_score",initialize:function(){this.collection=new a.Collection(this.options.data)},ui:{},events:function(){},onRender:function(){},onShow:function(){},onClose:function(){}})}),define("views/quiz/report/index-page-view",["talent","templates/quiz","QuizErrorView","views/quiz/report/report-composite","views/quiz/report/score-composite"],function(a,b,c,d,e){var f=a.Layout.extend({template:b["quiz/report/index-page"],initialize:function(){var b=this;b.selObj={},a.app.request("history:getQueryObject").done(function(c){return c&&(b.selObj.sn=c.sn,b.selObj.tid=c.tid,b.selObj.mail=c.mail),BSGlobal.activityInfo&&BSGlobal.activityInfo!={}&&(b.selObj.sn=BSGlobal.activityInfo.sn||b.selObj.sn,b.selObj.tid=BSGlobal.tenantInfo.id||b.selObj.tid,b.selObj.mail=BSGlobal.loginUserInfo.email||b.selObj.mail),b.selObj=={}||null==b.selObj.sn||null==b.selObj.tid||null==b.selObj.mail?void a.app.execute("history:navigate","#quiz/search",!0):void 0}),this.hasSubmit=!1,this.hasID=!1,this.hasEmail=!1,this.hasCode=!1,this.isclickSubmit=!0;var c=a.Context.getTenantInfo();this.model=new a.Model(c),this.model.set("codeUrl",BSGlobal.apiPath+"/captcha?tmp="+new Date)},regions:{main:".search_report",score:".score_layout",report:".report_layout"},ui:{},events:function(){var a={};return a},onRender:function(){},onShow:function(){var b=this;a.app.request("report:reportDetail",{sn:b.selObj.sn,mail:b.selObj.mail,tenantId:b.selObj.tid}).done(function(f){b.$el.find(".report_layout").html("");var g=JSON.parse(f)||{};if(g.message&&g.message.type){var h=g.message.message;if(1==g.message.type){var i=new a.Model;i.set({message:h,isShowHead:!0,report:!0});var j=new c({model:i});b.main.show(j),a.app.execute("document:changePageTitle","提示页面",!0),b.$el.find(".login_foot_wrap").css({"border-top":"1px solid #FFF",background:"#E0E0E0","margin-top":"100px"}),b.$el.find(".login_foot").css({background:"#E0E0E0",border:"none"})}else b.$el.find(".report_name").html(g.name),b.$el.find(".report_score")&&b.$el.find(".report_score").hide(),b.$el.find(".report_layout").html(h)}else{if(b.$el.find(".report_name").html(g.name),g.isScore&&g.testScores&&g.testScores.length){var k=new e({data:g.testScores});b.score&&b.score.show(k)}else b.$el.find(".report_score")&&b.$el.find(".report_score").hide();if(g.isReport&&g.testReports&&g.testReports.length){var l=new d({data:g.testReports});b.report&&b.report.show(l)}else b.$el.find(".report_link")&&b.$el.find(".report_link").hide(),b.$el.find(".report_score")&&b.$el.find(".report_score").css("border-bottom","none");null!=g.testScores&&g.testScores.length||null!=g.testReports&&g.testReports.length||b.$el.find(".report_layout").html("没有可供查询的结果")}})},onClose:function(){}});return a.BasePageView.extend({mainViewClass:f,pageTitle:"自助查询平台",layout:"empty-layout"})}),define("views/quiz/maintain/index-page-view",["talent","templates/quiz"],function(a,b){var c=a.Layout.extend({template:b["quiz/maintain/index-page"],initialize:function(){},regions:{},ui:{},events:function(){var a={};return a},onRender:function(){},onShow:function(){},onClose:function(){}});return a.BasePageView.extend({mainViewClass:c,pageTitle:"升级维护",layout:"empty-layout"})}),define("views/quiz/new-search/content",["talent","templates/quiz"],function(a,b){var c=a.ItemView.extend({template:b["quiz/new-search/content"],initialize:function(){}});return c}),function(a){function b(){try{return h in a&&a[h]}catch(b){return!1}}function c(a){return function(){var b=Array.prototype.slice.call(arguments,0);b.unshift(e),j.appendChild(e),e.addBehavior("#default#userData"),e.load(h);var c=a.apply(f,b);return j.removeChild(e),c}}function d(a){return a.replace(/^d/,"___$&").replace(m,"___")}var e,f={},g=a.document,h="localStorage",i="script";if(f.disabled=!1,f.set=function(){},f.get=function(){},f.remove=function(){},f.clear=function(){},f.transact=function(a,b,c){var d=f.get(a);null==c&&(c=b,b=null),"undefined"==typeof d&&(d=b||{}),c(d),f.set(a,d)},f.getAll=function(){},f.forEach=function(){},f.serialize=function(a){return JSON.stringify(a)},f.deserialize=function(a){if("string"!=typeof a)return void 0;try{return JSON.parse(a)}catch(b){return a||void 0}},f.withExp={set:function(a,b,c){f.set(a,{val:b,exp:c,time:(new Date).getTime()})},get:function(a){var b=f.get(a);return b?(new Date).getTime()-b.time>b.exp?null:b.val:null}},b())e=a[h],f.set=function(a,b){return void 0===b?f.remove(a):(e.setItem(a,f.serialize(b)),b)},f.get=function(a){return f.deserialize(e.getItem(a))},f.remove=function(a){e.removeItem(a)},f.clear=function(){e.clear()},f.getAll=function(){var a={};return f.forEach(function(b,c){a[b]=c}),a},f.forEach=function(a){for(var b=0;b<e.length;b++){var c=e.key(b);a(c,f.get(c))}};else if(g.documentElement.addBehavior){var j,k;try{k=new ActiveXObject("htmlfile"),k.open(),k.write("<"+i+">document.w=window</"+i+'><iframe src="/favicon.ico"></iframe>'),k.close(),j=k.w.frames[0].document,e=j.createElement("div")}catch(l){e=g.createElement("div"),j=g.body}var m=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g");f.set=c(function(a,b,c){return b=d(b),void 0===c?f.remove(b):(a.setAttribute(b,f.serialize(c)),a.save(h),c)}),f.get=c(function(a,b){return b=d(b),f.deserialize(a.getAttribute(b))}),f.remove=c(function(a,b){b=d(b),a.removeAttribute(b),a.save(h)}),f.clear=c(function(a){var b=a.XMLDocument.documentElement.attributes;a.load(h);for(var c,d=0;c=b[d];d++)a.removeAttribute(c.name);a.save(h)}),f.getAll=function(){var a={};return f.forEach(function(b,c){a[b]=c}),a},f.forEach=c(function(a,b){for(var c,d=a.XMLDocument.documentElement.attributes,e=0;c=d[e];++e)b(c.name,f.deserialize(a.getAttribute(c.name)))})}try{var n="__storejs__";f.set(n,n),f.get(n)!=n&&(f.disabled=!0),f.remove(n)}catch(l){f.disabled=!0}f.enabled=!f.disabled,"undefined"!=typeof module&&module.exports?module.exports=f:"function"==typeof define&&define.amd?define("localStorage",f):a.store=f}(Function("return this")()),define("views/quiz/search-ticket/foot-view",["talent","templates/quiz"],function(a,b){var c=a.ItemView.extend({template:b["quiz/search-ticket/foot-view"],initialize:function(){var b=a.Context.getTenantInfo();this.model=new a.Model(b)},onRender:function(){}});return c}),define("views/quiz/new-search/index-page-view",["talent","templates/quiz","QuizErrorView","views/quiz/new-search/content","localStorage","views/quiz/search-ticket/foot-view"],function(a,b,c,d,e,f){var g=a.Layout.extend({template:b["quiz/new-search/index-page"],regions:{searchContent:".search_link",title:".test_title",footer:".search_footer"},initialize:function(){},onShow:function(){var b=this;a.app.request("search:show",{}).done(function(c){BSGlobal.logo=JSON.parse(c).logo,e.set("companyLogo",BSGlobal.logo),b.logo=e.get("companyLogo"),b.logo?a.$(".logo_img").attr("src",b.logo):a.$(".logo_img").css("display","none"),b.model.set(JSON.parse(c)),b.showContent()})},showContent:function(){var a=new d({model:this.model});this.searchContent.show(a)},onRender:function(){this.footView=new f,this.footer.show(this.footView)}});return a.BasePageView.extend({mainViewClass:g,pageTitle:"自助查询平台",layout:"empty-layout"})}),define("views/quiz/score-info/index-page-view",["talent","templates/quiz","$.cookie","QuizErrorView","localStorage","views/quiz/search-ticket/foot-view"],function(a,b,c,d,e,f){var g=a.Layout.extend({template:b["quiz/score-info/index-page"],regions:{footer:".search_footer"},initialize:function(){var b=e.get("scoreMessageStore"),c=e.get("scoreResultStore"),d={scoreResultStore:c,scoreMessageStore:b};this.model=new a.Model(d)},onShow:function(){this.logo=e.get("companyLogo"),this.logo?a.$(".logo_img").attr("src",this.logo):a.$(".logo_img").css("display","none")},onRender:function(){this.footView=new f,this.footer.show(this.footView)}});return a.BasePageView.extend({mainViewClass:g,pageTitle:"自助查询平台",layout:"empty-layout"})}),define("views/quiz/search-one/info-one",["talent","templates/quiz"],function(a,b){var c=a.ItemView.extend({template:b["quiz/search-one/info-one"],initialize:function(){}});return c}),define("views/quiz/search-one/index-page-view",["talent","templates/quiz","$.cookie","QuizErrorView","localStorage","views/quiz/search-one/info-one","views/quiz/search-ticket/foot-view"],function(a,b,c,d,e,f,g){var h=a.Layout.extend({template:b["quiz/search-one/index-page"],regions:{content:".search_content",footer:".search_footer"},initialize:function(){var b=this;a.app.request("history:getQueryObject").done(function(a){b.sn=a.sn,b.email=a.email,b.tenantId=a.tenantId}),a.app.request("search:searchOne",{sn:b.sn,email:b.email,tenantId:b.tenantId}).done(function(a){var c=JSON.parse(a)||{};b.model.set(c),b.showOneGrade()})},showOneGrade:function(){this.content.show(new f({model:this.model}))},onShow:function(){this.logo=e.get("companyLogo"),this.logo?a.$(".logo_img").attr("src",this.logo):a.$(".logo_img").css("display","none")},onRender:function(){this.footView=new g,this.footer.show(this.footView)}});return a.BasePageView.extend({mainViewClass:h,pageTitle:"自助查询平台",layout:"empty-layout"})}),define("views/quiz/search-result/index-page-view",["talent","templates/quiz","$.cookie","QuizErrorView","localStorage","views/quiz/search-ticket/foot-view"],function(a,b,c,d,e,f){var g=a.Layout.extend({template:b["quiz/search-result/index-page"],regions:{footer:".search_footer"},initialize:function(){var b=e.get("resultStore"),c=e.get("messageStore");this.fixData(b);var d={resultStore:b,messageStore:c};this.model=new a.Model(d)},fixData:function(a){var b=/\d{4}([.])\d{2}\1\d{2}\s{1}\d{2}([:])\d{2}\2\d{2}/;_.each(a,function(a){if(a.notice.match(b)){var c="<span style='color:#fc5d06'>"+a.notice.match(b)[0]+"</span>";a.notice=a.notice.replace(b,c)}})},onShow:function(){this.logo=e.get("companyLogo"),this.logo?a.$(".logo_img").attr("src",this.logo):a.$(".logo_img").css("display","none")},onRender:function(){this.footView=new f,this.footer.show(this.footView)}});return a.BasePageView.extend({mainViewClass:g,pageTitle:"自助查询平台",layout:"empty-layout"})}),define("views/quiz/search-ticket/index-page-view",["talent","templates/quiz","$.cookie","QuizErrorView","localStorage","views/quiz/search-ticket/foot-view"],function(a,b,c,d,e,f){var g=a.Layout.extend({template:b["quiz/search-ticket/index-page"],initialize:function(){this.hasSubmit=!1,this.hasID=!1,this.hasEmail=!1;var b={isSuccess:1,activityCount:0,activityList:null,isVerify:0,message:"没有正在进行的笔试。"};this.model=new a.Model(b),this.model.set("codeUrl",BSGlobal.apiPath+"/captcha?tmp="+new Date);var c=this;a.$(document).on("keydown",function(a){13==a.which&&c.isSubmit1()})},regions:{main:".search_report",append:".append",footer:".search_footer"},ui:{id:'input[name="id"]',email:'input[name="email"]',code:'input[name="code"]',idError:".id_error .error_ico",emailError:".email_error .error_ico",codeError:".code_error .error_ico",codeCorr:".code_status",submit:".login_btn span"},events:function(){var a={};return a["click .report_search"]="isSubmit1",a['blur input[name="id"]']="checkId",a['blur input[name="email"]']="checkEmail",a['blur input[name="code"]']="checkCode",a['keyup input[name="code"]']="checkCode",a["click .refresh_code"]="refreshCode",a["click .code_status_err"]="deleteCode",a['focus input[name="id"]']="deleteNameValue",a['focus input[name="email"]']="deleteEmailValue",a['focus input[name="code"]']="deleteCodeValue",a},deleteCodeValue:function(){a.$('input[name="code"]').attr("placeholder","")},deleteNameValue:function(){a.$('input[name="id"]').attr("placeholder","")},deleteEmailValue:function(){a.$('input[name="email"]').attr("placeholder","")},checkId:function(){var b=a.$.trim(a.$(this.ui.id).val());""==b?(a.$('input[name="id"]').attr("placeholder","请输入姓名"),a.$(this.ui.idError).text("必填").show(),this.hasID=!1):(a.$(this.ui.idError).text("必填").hide(),this.hasID=!0)},refreshCode:function(){var a=this.$el.find(".code_img");a.attr("src",BSGlobal.apiPath+"/captcha?tmp="+new Date)},checkEmail:function(){var b=a.$.trim(a.$(this.ui.email).val()),c=/^([a-zA-Z0-9][_\.\-]*)+\@([A-Za-z0-9])+((\.|-|_)[A-Za-z0-9]+)*((\.[A-Za-z0-9]{2,4}){1,2})$/,d=c.test(b);""!=b?(b.length>50&&(a.$(this.ui.emailError).text("最多允许输入50个字符").show(),this.hasEmail=!1),0==d?b.length>50?(a.$(this.ui.emailError).text("最多允许输入50个字符").show(),this.hasEmail=!1):(a.$(this.ui.emailError).text("邮箱格式不正确").show(),this.hasEmail=!1):b.length>50?(a.$(this.ui.emailError).text("最多允许输入50个字符").show(),this.hasEmail=!1):(a.$(this.ui.emailError).hide(),this.hasEmail=!0)):(a.$('input[name="email"]').attr("placeholder","请输入邮箱"),a.$(this.ui.emailError).text("必填").show(),this.hasEmail=!1)},checkCode:function(){var b=a.$('input[name="code"]'),c=a.$.trim(b.val());""==c?(a.$('input[name="code"]').attr("placeholder","验证码"),a.$(".code_error").text("必填").show()):a.$(".code_error").hide()},deleteCode:function(){a.$('input[name="code"]').val(""),a.$(".code_status").removeClass("code_status_err").removeClass("code_status_cor").show(),a.$(this.ui.codeError).hide()},isSubmit1:function(){this.checkId(),this.checkEmail(),this.formSubmit()},formSubmit:function(){var b=this,c=a.$.trim(a.$(this.ui.id).val()),d=a.$.trim(a.$(this.ui.email).val()),f=a.$.trim(a.$('input[name="code"]').val());null==f&&(f="");var g=!1;this.hasID&&this.hasEmail&&(g=!0),g&&(a.app.request("search:input",{name:c,email:d,captcha:f,t:(new Date).getTime()}).done(function(c){var d=JSON.parse(c)||{};b.model.set(d),0==d.isSuccess?1==d.isVerify&&(a.$(".code_show").show(),a.$('input[name="code"]').val().length>0&&(d.message?a.$(".code_error").text(d.message).show():a.$(".code_error").hide())):1==d.isSuccess&&(e.set("messageStore",d.message),e.set("resultStore",d.activityList),a.app.execute("history:navigate","#quiz/search-result",!0),a.$(".download_img").show())}),this.on("model:change",function(){this.render()},this))},onRender:function(){this.footView=new f,this.footer.show(this.footView)},onShow:function(){a._.splash("login"),this.logo=e.get("companyLogo"),this.logo?a.$(".logo_img").attr("src",this.logo):a.$(".logo_img").css("display","none")},onClose:function(){a.$(document).off("keydown")}});return a.BasePageView.extend({mainViewClass:g,pageTitle:"自助查询平台",layout:"empty-layout"})
}),define("views/quiz/search-score/index-page-view",["talent","templates/quiz","$.cookie","QuizErrorView","localStorage","views/quiz/search-ticket/foot-view"],function(a,b,c,d,e,f){var g=a.Layout.extend({template:b["quiz/search-score/index-page"],initialize:function(){this.hasSubmit=!1,this.hasID=!1,this.hasEmail=!1,this.hasCode=!1,this.isclickSubmit=!0;var b={isSuccess:1,activityCount:0,activityList:null,isVerify:0,message:"没有正在进行的笔试。"};this.model=new a.Model(b),this.model.set("codeUrl",BSGlobal.apiPath+"/captcha?tmp="+new Date);var c=this;a.$(document).on("keydown",function(a){13==a.which&&c.isSubmit1()})},regions:{main:".search_report",footer:".search_footer"},ui:{id:'input[name="id"]',email:'input[name="email"]',code:'input[name="code"]',idError:".id_error .error_ico",emailError:".email_error .error_ico",codeError:".code_error .error_ico",codeCorr:".code_status",submit:".login_btn span",append:".append"},events:function(){var a={};return a["click .report_search"]="isSubmit1",a['blur input[name="id"]']="checkId",a['blur input[name="email"]']="checkEmail",a['blur input[name="code"]']="checkCode",a['keyup input[name="code"]']="checkCode",a["click .refresh_code"]="refreshCode",a["click .code_status_err"]="deleteCode",a['focus input[name="id"]']="deleteNameValue",a['focus input[name="email"]']="deleteEmailValue",a['focus input[name="code"]']="deleteCodeValue",a},deleteCodeValue:function(){a.$('input[name="code"]').attr("placeholder","")},deleteNameValue:function(){a.$('input[name="id"]').attr("placeholder","")},deleteEmailValue:function(){a.$('input[name="email"]').attr("placeholder","")},checkId:function(){var b=a.$.trim(a.$(this.ui.id).val());""==b?(a.$('input[name="id"]').attr("placeholder","请输入姓名"),a.$(this.ui.idError).text("必填").show(),this.hasID=!1):(a.$(this.ui.idError).text("必填").hide(),this.hasID=!0)},refreshCode:function(){var a=this.$el.find(".code_img");a.attr("src",BSGlobal.apiPath+"/captcha?tmp="+new Date)},checkEmail:function(){var b=a.$.trim(a.$(this.ui.email).val()),c=/^([a-zA-Z0-9][_\.\-]*)+\@([A-Za-z0-9])+((\.|-|_)[A-Za-z0-9]+)*((\.[A-Za-z0-9]{2,4}){1,2})$/,d=c.test(b);""!=b?(b.length>50&&(a.$(this.ui.emailError).text("最多允许输入50个字符").show(),this.hasEmail=!1),0==d?b.length>50?(a.$(this.ui.emailError).text("最多允许输入50个字符").show(),this.hasEmail=!1):(a.$(this.ui.emailError).text("邮箱格式不正确").show(),this.hasEmail=!1):b.length>50?(a.$(this.ui.emailError).text("最多允许输入50个字符").show(),this.hasEmail=!1):(a.$(this.ui.emailError).hide(),this.hasEmail=!0)):(a.$('input[name="email"]').attr("placeholder","请输入邮箱"),a.$(this.ui.emailError).text("必填").show(),this.hasEmail=!1)},checkCode:function(){var b=a.$('input[name="code"]'),c=a.$.trim(b.val());""==c?(a.$('input[name="code"]').attr("placeholder","验证码"),a.$(".code_error").text("必填").show()):a.$(".code_error").hide()},deleteCode:function(){a.$('input[name="code"]').val(""),a.$(".code_status").removeClass("code_status_err").removeClass("code_status_cor").show(),a.$(this.ui.codeError).hide()},isSubmit1:function(){$.Deferred();this.checkId(),this.checkEmail(),this.formSubmit()},formSubmit:function(){var b=this,c=a.$.trim(a.$(this.ui.id).val()),d=a.$.trim(a.$(this.ui.email).val()),f=a.$.trim(a.$('input[name="code"]').val());null==f&&(f="");var g=!1;this.hasID&&this.hasEmail&&(g=!0),g&&(a.app.request("search:searchResult",{name:c,email:d,captcha:f,t:(new Date).getTime()}).done(function(c){var d=JSON.parse(c)||{};b.model.set(d),0==d.isSuccess?1==d.isVerify&&(a.$(".code_show").show(),a.$('input[name="code"]').val().length>0&&(d.message?a.$(".code_error").text(d.message).show():a.$(".code_error").hide())):1==d.isSuccess&&(e.set("scoreMessageStore",d.message),e.set("scoreResultStore",d.activityList),a.app.execute("history:navigate","#quiz/score-info",!0),a.$(".download_img").show())}),this.on("model:change",function(){this.render()},this))},onRender:function(){this.footView=new f,this.footer.show(this.footView)},onShow:function(){a._.splash("login"),this.logo=e.get("companyLogo"),this.logo?a.$(".logo_img").attr("src",this.logo):a.$(".logo_img").css("display","none")},onClose:function(){a.$(document).off("keydown")}});return a.BasePageView.extend({mainViewClass:g,pageTitle:"自助查询平台",layout:"empty-layout"})}),define("timedialog",["talent","moment"],function(a,b){var c=a.ItemView.extend({template:a._.template(['<div class="time_container">','<div class="time_time">','<div class="time_title"><%=this.options.title%></div>','<div class="time_countdown"></div>',"<%if(this.options.showPro){%>",'<div class="time_showpro">','当前进度：<span id="pro_done"><%=this.options.done%></span>/','<span id="pr0_total"><%=this.options.total%></span>',"</div>","<%}%>","</div>",'<div class="time_tips">','<div class="time_tips_container"></div>','<span class="time_tips_close">X</span>',"</div>","</div>"].join("")),defaults:{interval:1e3,intervalName:"milliseconds",countdown:0,format:"hh:mm:ss",endTime:0,hideZero:!1,maxUnit:"h",title:"剩余时间",showPro:!0,done:0,total:7,containment:"#bs_layout_container",isbreak:!1,totalTime:0,autoSubmit:!0},ui:{countdown:".time_countdown",done:"#pro_done",total:"pro_total",tips:".time_tips",tipscontainer:".time_tips_container",tipsclose:".time_tips_close",timetitle:".time_title"},events:function(){var a={};return a["mouseenter "+this.ui.tips]="showCloseIcon",a["mouseleave "+this.ui.tips]="hideCloseIcon",a["click "+this.ui.tipsclose]="closeIcon",a},initialize:function(c){var d=/^(?:[^dhms]*)([d|h|m|s])/;this.options=a._.extend({},this.defaults,c);var e=this.options.format.match(d);e&&e[1]&&(this.options.maxUnit=e[1]),this.tipFlag=!0;var f=b.duration(1e3*parseInt(this.options.totalTime),this.options.intervalName).as("minutes");this.leftTimeRound=Math.ceil(f/10),this.centSeconds=this.options.totalTime/10},onRender:function(){},onShow:function(){},show:function(){this.$el.html(this.template(this.options)),$("#bs_layout_container").append(this.$el),this.$el.find(".time_container").draggable({containment:this.options.containment,scroll:!1,cursor:"move",stop:function(){var a=$(".time_container").offset().left,b=$(window.document).width();$(".time_container").css({left:a/b*100+"%"})}}),this.setTime()},setTime:function(){this._clear(),this.start()},start:function(){var a=this;this.intervalDuration=b.duration(1e3*parseInt(this.options.countdown),this.options.intervalName),this.changeHtml(this.intervalDuration),this._interval=setInterval(function(){a.intervalDuration=b.duration(a.intervalDuration).subtract(a.options.interval,a.options.intervalName),a.changeHtml(b.duration(a.intervalDuration))},this.options.interval)},changeHtml:function(a){var b=this,c=a.as("seconds"),d=a.as("minutes");b.options.countdown=c,b._setHtml(a);var e=this.$el.find(this.ui.tips);if(d==this.leftTimeRound&&c>=60)b.showTips(a,"minutes");else if(b.options.isbreak&&c<b.centSeconds&&c>=60&&/(^[1-9]\d*$)/.test(d)){if(e.is(":visible"))return!1;b.showTips(a,"minutes")}else b.options.autoSubmit&&30>=c?b.showTips(a,"seconds"):!b.options.autoSubmit&&c<=b.options.endTime&&b.showTips(a,"videotimeend");0==c&&b.trigger("timeOver")},_setHtml:function(a){var b={d:a.days(),h:a.hours(),m:a.minutes(),s:a.seconds()},c=this.origanizeFormat(b),d=this.origanizeHtml(c);this.$el.find(this.ui.countdown).html(d)},origanizeHtml:function(b){var c=b.split(":"),d="";return a._.each(c,function(a,b){var e=Math.abs(a)<10?"0"+Math.abs(a):Math.abs(a);d+=b==c.length-1?"<span>"+e+"</span>":"<span>"+e+"</span><em>:</em>"}),d},_clear:function(){clearInterval(this._interval),clearTimeout(this.tipTime)},end:function(){this._clear(),this.$el.trigger("over")},changePro:function(a){this.$el.find(this.ui.done).text(a)},showTips:function(a,b){var c=this,d=this.$el.find(this.ui.tips),e=this.$el.find(this.ui.tipscontainer),f="",g=c.$el.find(c.ui.timetitle);if(g.removeClass("timeover_color"),"minutes"==b&&c.tipFlag){c.tipTime&&clearTimeout(c.tipTime);var h=Math.ceil(a.as("minutes"));f="处理时间剩下"+h+'分钟<br/><span class="timetip_color">请尽快完成</span>',e.html(f),d.attr("data-close",!0),d.fadeIn(),c.tipFlag=!1,c.tipTime=setTimeout(function(){d.fadeOut()},3e4)}else if("seconds"==b){var i=a.as("seconds");f=i+'s后系统将强制提交<br/><span class="timetip_color">请尽快完成</span>',0>=i&&c.end(),e.html(f),d.fadeIn(),d.attr("data-close",!1)}else"videotimeend"==b&&(g.addClass("timeover_color").text("超出时间"),f='处理时间已过<br/><span class="timetip_color">请尽快提交</span>',e.html(f),d.fadeIn(),d.attr("data-close",!1))},showCloseIcon:function(){var a=this.$el.find(this.ui.tips);if("true"==a.attr("data-close")){var b=this.$el.find(this.ui.tipsclose);b.show()}},hideCloseIcon:function(){var a=this.$el.find(this.ui.tipsclose);a.hide()},closeIcon:function(){var a=this.$el.find(this.ui.tips);a.hide()},origanizeFormat:function(b){var c=this,d=this.options.format,e={d:/(d+)/,h:/(h+)/,m:/(m+)/,s:/(s+)/},f={d:/(d+[^h]*)(h+)/,h:/(h+[^m]*)(m+)/,m:/(m+[^s]*)(s+)/,s:/(s+[\s\S]*)/},g=this.options.maxUnit;switch(g){case"h":b.h=24*b.d+b.h;break;case"m":b.m=60*(24*b.d+b.h)+b.m;break;case"s":b.s=60*(60*(24*b.d+b.h)+b.m)+b.s}var h=!0;return a._.each(e,function(a,e){if(a.test(d)){var g=RegExp.$1,i=new String(g).length,j=i-new String(b[e].toString()).length,k="";if(0==j)k+=b[e];else{for(var l=0;j>l;l++)k+="0";k+=b[e]}c.options.hideZero?"0"!=k&&"00"!=k||!h?(h=!1,d=d.replace(RegExp.$1,k)):f[e].test(d)&&(d=d.replace(RegExp.$1,"")):d=d.replace(RegExp.$1,k)}}),d},onClose:function(){this._clear()}});return c}),define("vendor/plugins/simplemodal-view-v2",["talent","_","$","backbone"],function(a,b,c,d){var e=c(document),f=navigator.userAgent.toLowerCase(),g=c(window),h={ieQuirks:null,msie:/msie/.test(f)&&!/opera/.test(f),opera:/opera/.test(f)};h.ie6=h.msie&&/msie 6./.test(f)&&"object"!=typeof window.XMLHttpRequest,h.ie7=h.msie&&/msie 7.0/.test(f),h.boxModel="CSS1Compat"===document.compatMode;var i={focus:!1,opacity:50,overlayId:"simplemodal-overlay",overlayCss:{backgroundColor:"black"},containerId:"simplemodal-container",containerCss:{},dataId:"simplemodal-data",dataCss:{},minHeight:null,minWidth:null,maxHeight:null,maxWidth:null,autoResize:!1,autoPosition:!0,zIndex:1e3,close:!0,closeHTML:'<a class="modalCloseImg" title="Close"></a>',closeClass:"simplemodal-close",escClose:!1,overlayClose:!1,fixed:!0,position:null,persist:!1,modal:!0,onOpen:null,onShow:null,onClose:null},j=0;return d.View.extend({template:b.template(""),ui:{},events:function(){var a={};return a},initialize:function(a){this.options=a,this.d=[],this.dTemp=[],this.wTemp=[],h.ieQuirks=h.msie&&!h.boxModel;var b=c.extend({},i),d=j++;b.overlayId=i.overlayId+"-"+d,b.containerId=i.containerId+"-"+d,b.dataId=i.dataId+"-"+d,this.o=c.extend(b,this.options),this.zIndex=this.o.zIndex,this.occb=!1},render:function(a){return a?this.o.data=a:a=this.options.data,"object"==typeof a?(a=a instanceof c?a:c(a),this.d.placeholder=!1,a.parent().parent().size()>0&&(a.before(c("<span></span>").attr("id","simplemodal-placeholder").css({display:"none"})),this.d.placeholder=!0,this.display=a.css("display"),this.o.persist||(this.d.orig=a.clone(!0)))):"string"==typeof a||"number"==typeof a?a=c("<div></div>").html(a):alert("SimpleModal Error: Unsupported data type: "+typeof a),this.create(a),this.open(),c.isFunction(this.o.onShow)&&this.o.onShow.apply(this,[this.d]),this.$el},show:function(b){return b?this.o.data=b:b=this.options.data,"object"!=typeof b?this.render(b):b instanceof a.View?(this.create(b,!0),this.open(),c.isFunction(this.o.onShow)&&this.o.onShow.apply(this,[this.d]),this.$el):this.render(b)},wrapDataInRegion:function(b){return this.tmpr=new a.Region({el:c("<div></div>")}),this.tmpr.show(b),this.tmpr.$el},create:function(a,b){b&&(a=this.wrapDataInRegion(a)),this.getDimensions();var d=this,e=this.dTemp,f=this.wTemp;d.o.modal&&h.ie6&&(d.d.iframe=c('<iframe src="javascript:false;"></iframe>').css(c.extend(d.o.iframeCss,{display:"none",opacity:0,position:"fixed",height:f[0],width:f[1],zIndex:d.o.zIndex,top:0,left:0})).appendTo(d.$el)),d.d.overlay=c("<div></div>").attr("id",d.o.overlayId).addClass("simplemodal-overlay").css(c.extend(d.o.overlayCss,{display:"none",opacity:d.o.opacity/100,filter:"alpha(opacity="+d.o.opacity+")",height:"100%",width:d.o.modal?e[1]:0,position:"fixed",left:0,top:0,zIndex:d.o.zIndex+1})).appendTo(d.$el),d.d.container=c("<div></div>").attr("id",d.o.containerId).addClass("simplemodal-container").css(c.extend({position:d.o.fixed?"fixed":"absolute"},d.o.containerCss,{display:"none",zIndex:d.o.zIndex+2})).append(d.o.close&&d.o.closeHTML?c(d.o.closeHTML).addClass(d.o.closeClass):"").appendTo(d.$el),d.d.wrap=c("<div></div>").attr("tabIndex",-1).addClass("simplemodal-wrap").css({height:"100%",outline:0,width:"100%"}).appendTo(d.d.container),d.d.data=a.attr("id",a.attr("id")||d.o.dataId).addClass("simplemodal-data").css(c.extend(d.o.dataCss,{display:"none"})).appendTo("body"),a=null,d.setContainerDimensions(),d.d.data.appendTo(d.d.wrap),(h.ie6||h.ieQuirks)&&d.fixIE()},bindEvents:function(){var a=this,b=this.dTemp,c=this.wTemp;a.$el.find("."+a.o.closeClass).bind("click.simplemodal",function(b){b.preventDefault(),setTimeout(function(){a.close()},10)}),a.o.modal&&a.o.close&&a.o.overlayClose&&a.d.overlay.bind("click.simplemodal",function(b){b.preventDefault(),a.close()}),e.bind("keydown.simplemodal",function(b){a.o.modal&&9===b.keyCode?a.watchTab(b):a.o.close&&a.o.escClose&&27===b.keyCode&&(b.preventDefault(),a.close())}),g.bind("resize.simplemodal orientationchange.simplemodal",function(){a.getDimensions(),a.o.autoResize?a.setContainerDimensions():a.o.autoPosition&&a.setPosition(),h.ie6||h.ieQuirks?a.fixIE():a.o.modal&&(a.d.iframe&&a.d.iframe.css({height:c[0],width:c[1]}),a.d.overlay.css({height:b[0],width:b[1]}))})},unbindEvents:function(){c("."+this.o.closeClass).unbind("click.simplemodal"),e.unbind("keydown.simplemodal"),g.unbind(".simplemodal"),this.d.overlay.unbind("click.simplemodal")},fixIE:function(){{var a=this,b=a.o.position;this.dTemp,this.wTemp}c.each([a.d.iframe||null,a.o.modal?a.d.overlay:null,"fixed"===a.d.container.css("position")?a.d.container:null],function(a,c){if(c){var d="document.body.clientHeight",e="document.body.clientWidth",f="document.body.scrollHeight",g="document.body.scrollLeft",h="document.body.scrollTop",i="document.body.scrollWidth",j="document.documentElement.clientHeight",k="document.documentElement.clientWidth",l="document.documentElement.scrollLeft",m="document.documentElement.scrollTop",n=c[0].style;if(n.position="absolute",2>a)n.removeExpression("height"),n.removeExpression("width"),n.setExpression("height",""+f+" > "+d+" ? "+f+" : "+d+' + "px"'),n.setExpression("width",""+i+" > "+e+" ? "+i+" : "+e+' + "px"');else{var o,p;if(b&&b.constructor===Array){var q=b[0]?"number"==typeof b[0]?b[0].toString():b[0].replace(/px/,""):c.css("top").replace(/px/,"");if(o=-1===q.indexOf("%")?q+" + (t = "+m+" ? "+m+" : "+h+') + "px"':parseInt(q.replace(/%/,""))+" * (("+j+" || "+d+") / 100) + (t = "+m+" ? "+m+" : "+h+') + "px"',b[1]){var r="number"==typeof b[1]?b[1].toString():b[1].replace(/px/,"");p=-1===r.indexOf("%")?r+" + (t = "+l+" ? "+l+" : "+g+') + "px"':parseInt(r.replace(/%/,""))+" * (("+k+" || "+e+") / 100) + (t = "+l+" ? "+l+" : "+g+') + "px"'}}else o="("+j+" || "+d+") / 2 - (this.offsetHeight / 2) + (t = "+m+" ? "+m+" : "+h+') + "px"',p="("+k+" || "+e+") / 2 - (this.offsetWidth / 2) + (t = "+l+" ? "+l+" : "+g+') + "px"';n.removeExpression("top"),n.removeExpression("left"),n.setExpression("top",o),n.setExpression("left",p)}}})},focus:function(a){var b=this,d=a&&-1!==c.inArray(a,["first","last"])?a:"first",e=c(":input:enabled:visible:"+d,b.d.wrap);setTimeout(function(){e.length>0?e.focus():b.d.wrap.focus()},10)},getDimensions:function(){var a="undefined"==typeof window.innerHeight?g.height():window.innerHeight;this.dTemp=[e.height(),e.width()],this.wTemp=[a,g.width()]},getVal:function(a,b){var c=this.wTemp;return a?"number"==typeof a?a:"auto"===a?0:a.indexOf("%")>0?parseInt(a.replace(/%/,""))/100*("h"===b?c[0]:c[1]):parseInt(a.replace(/px/,"")):null},update:function(a,b){var c=this;return c.d.data?(c.d.origHeight=c.getVal(a,"h"),c.d.origWidth=c.getVal(b,"w"),c.d.data.hide(),a&&c.d.container.css("height",a),b&&c.d.container.css("width",b),c.setContainerDimensions(),c.d.data.show(),c.o.focus&&c.focus(),c.unbindEvents(),void c.bindEvents()):!1},setContainerDimensions:function(){var a=this,b=h.ie6||h.ie7,c=(a.o.position,this.dTemp,this.wTemp),d=a.d.origHeight?a.d.origHeight:h.opera?a.d.container.height():a.getVal(b?a.d.container[0].currentStyle.height:a.d.container.css("height"),"h"),e=a.d.origWidth?a.d.origWidth:h.opera?a.d.container.width():a.getVal(b?a.d.container[0].currentStyle.width:a.d.container.css("width"),"w"),f=a.d.data.outerHeight(!0),g=a.d.data.outerWidth(!0);a.d.origHeight=a.d.origHeight||d,a.d.origWidth=a.d.origWidth||e;var i=a.o.maxHeight?a.getVal(a.o.maxHeight,"h"):null,j=a.o.maxWidth?a.getVal(a.o.maxWidth,"w"):null,k=i&&i<c[0]?i:c[0],l=j&&j<c[1]?j:c[1],m=a.o.minHeight?a.getVal(a.o.minHeight,"h"):"auto";d=d?a.o.autoResize&&d>k?k:m>d?m:d:f?f>k?k:a.o.minHeight&&"auto"!==m&&m>f?m:f:m;var n=a.o.minWidth?a.getVal(a.o.minWidth,"w"):"auto";e=e?a.o.autoResize&&e>l?l:n>e?n:e:g?g>l?l:a.o.minWidth&&"auto"!==n&&n>g?n:g:n,a.d.container.css({height:d,width:e}),a.d.wrap.css({overflow:f>d||g>e?"auto":"visible"}),a.o.autoPosition&&a.setPosition()},setPosition:function(){var a,b,d=(this.dTemp,this.wTemp),e=this,f=d[0]/2-e.d.container.outerHeight(!0)/2,h=d[1]/2-e.d.container.outerWidth(!0)/2,i="fixed"!==e.d.container.css("position")?g.scrollTop():0;e.o.position&&"[object Array]"===Object.prototype.toString.call(e.o.position)?(a=i+(e.o.position[0]||f),b=e.o.position[1]||h):(a=i+f,b=h),e.o.modal&&(e.d.overlay=c("<div></div>").attr("id",e.o.overlayId).addClass("simplemodal-overlay").css(c.extend(e.o.overlayCss,{display:"none",opacity:e.o.opacity/100,filter:"alpha(opacity="+e.o.opacity+")",height:"100%",width:"100%",position:"fixed",left:0,top:0,zIndex:e.o.zIndex+1})).appendTo(e.$el)),e.d.container.css({left:b,top:a})},watchTab:function(a){var b=this;if(c(a.target).parents(".simplemodal-container").length>0){if(b.inputs=c(":input:enabled:visible:first, :input:enabled:visible:last",b.d.data[0]),!a.shiftKey&&a.target===b.inputs[b.inputs.length-1]||a.shiftKey&&a.target===b.inputs[0]||0===b.inputs.length){a.preventDefault();var d=a.shiftKey?"last":"first";b.focus(d)}}else a.preventDefault(),b.focus()},open:function(){var a=this;a.d.iframe&&a.d.iframe.show(),c.isFunction(a.o.onOpen)?a.o.onOpen.apply(a,[a.d]):(a.d.overlay.show(),a.d.container.show(),a.d.data.show()),a.o.focus&&a.focus(),a.bindEvents()},close:function(){var a=this;return a.d.data?(a.unbindEvents(),void(c.isFunction(a.o.onClose)&&!a.occb?(a.occb=!0,a.o.onClose.apply(a,[a.d])):setTimeout(function(){if(a.d.placeholder){var b=c("#simplemodal-placeholder");a.o.persist?b.replaceWith(a.d.data.removeClass("simplemodal-data").css("display",a.display)):(a.d.data.hide().remove(),b.replaceWith(a.d.orig))}else a.d.data.hide().remove();this.tmpr&&this.tmpr.close(),a.d.container.hide().remove(),a.d.overlay.hide(),a.d.iframe&&a.d.iframe.hide().remove(),a.d.overlay.remove(),a.d={},a.$el.remove()},0))):!1}})}),define("views/common/plugins/dialog/bsdialog-content-view",["_","$","talent","templates/common"],function(a,b,c,d){return c.ItemView.extend({template:d["common/plugins/dialog/bsdialog-content-view"]})}),define("views/common/plugins/dialog/bsdialog",["_","$","talent","templates/common","vendor/plugins/simplemodal-view-v2","views/common/plugins/dialog/bsdialog-content-view","jquery.ui"],function(a,b,c,d,e,f){return c.Layout.extend({template:d["common/plugins/dialog/bsdialog"],events:{},regions:{content:".bsdialog_content"},defaults:{type:"common",title:"",buttons:void 0,simpleModal:void 0,isDrag:!0,moveDown:!1,icon:"common",radius:!1,dialogId:""},initialize:function(){this.model.set(a.extend(a.clone(this.defaults),this.options.config)),this.renderPopView()},onShow:function(){this.bindBtnsEvents(),this.bindDragDropEvents(),this.showContent()},showContent:function(){var a=this,b=a.model.get("content");b=a.parseContent(b),a.content.show(b)},parseContent:function(a){if(a instanceof c.View||a instanceof Backbone.View)return a;var b=new c.Model({content:a});return new f({model:b})},bindBtnsEvents:function(){var b=this,c=b.model.get("buttons");a.each(c,function(a){var c="text"==a.type?a.id:"click #"+a.id;b.events[c]=function(c){b.trigger(a.eventName,c,b)}})},bindDragDropEvents:function(){this.model.get("isDrag")&&this.$el.find(".bs_dialog3").draggable({containment:"body"})},renderPopView:function(){var a=this.configSimpleModal();this.popView=new e(a),this.popView.$el.appendTo("body");var b=this.popView.show();this.configStyle(b)},configStyle:function(a){if(this.model.get("moveDown")&&a.find(".bs_dialog3").addClass("move_down"),this.model.get("title")||this.model.get("radius")||a.find(".bs_dialog3_wrap").addClass("noradius"),this.model.get("simpleModal").modal&&a.find(".bs_dialog3_wrap").addClass("shadow"),this.model.get("position")){if("right_bottom"==this.model.get("position"))var b=document.documentElement.clientHeight-a.find(".simplemodal-container").height()-60,c=document.documentElement.clientWidth-a.find(".simplemodal-container").width()-10;a.find(".simplemodal-container").css({left:c,top:b})}a.find(".simplemodal-wrap").css({overflow:"visible"})},configSimpleModal:function(){var b={zIndex:1100,position:[0],data:this},c=this.model.get("simpleModal");return c?(c=a.pick(c,"modal","minWidth","maxWidth","minHeight","maxHeight","opacity"),a.extend(b,c)):b},onClose:function(){this.popView.close()}})}),define("views/quiz/appraise/foot-page-view",["talent","templates/quiz","$.cookie","views/common/plugins/dialog/bsdialog"],function(a,b,c,d){var e=a.ItemView.extend({template:b["quiz/appraise/foot-page"],ui:{footer:".appraise_footer",timeCon:".desktop_time"},events:function(){var a={};return a["click .soft_icon"]="iconTrigger",a},nameConfig:{recommand:"appraise_recmd",email:"appraise_email",video:"appraise_video",ntp:"appraise_ntp"},initialize:function(){},onBeforeRender:function(){this.model.set("time",this.dealTime(this.model.get("time")))},onShow:function(){this.getDeskTime()},addIcon:function(a){var b='<span class="soft_icon" data-flag="'+a+'"><em class="'+this.nameConfig[a]+'"></em></span>';this.ui.footer.append(b)},removeIcon:function(a){this.ui.footer.find("span[data-flag="+a+"]").remove()},iconTrigger:function(a){var b=$(a.currentTarget),c=b.attr("data-flag");this.trigger("iconClick",c)},getDeskTime:function(){var b=this,c={sectionId:a.Context.getSessionData("sectionId")};this.timeInterval=setInterval(function(){a.app.request("time:getDesktopTime",c).done(function(c){return c.netError?(b.showNetErrorDialog(),!1):void a.$(".desktop_time").html(b.dealTime(c))})},5e4)},dealTime:function(a){var b=a.split("<br />");return"<div>"+b[0]+"</div><div>"+b[1]+"</div>"},showNetErrorDialog:function(){if(a.$(".net-error-dialog").length<1){var b=this,c=[{name:"刷新",type:"blue_btn",id:"sure",eventName:"click:sure"},{name:"取消",type:"grey_btn",id:"cancle",eventName:"click:cancle"}],e={title:"错误提示",content:"数据传输错误，请刷新重试或联系客服人员解决。",icon:"sigh",buttons:c,isDrag:!0,moveDown:!0,simpleModal:{modal:!0,minWidth:350},dialogId:"net-error-dialog"},f=new d({config:e});b.listenTo(f,"click:cancle",function(){f.close()}),b.listenTo(f,"click:sure",function(){location.reload()})}},onClose:function(){var a=this;clearInterval(a.timeInterval)}});return e}),define("views/quiz/appraise/desk-page-view",["talent","templates/quiz","$.cookie"],function(a,b){var c=a.ItemView.extend({template:b["quiz/appraise/desk-page"],ui:{iconCon:".appraise_desk_img ul",icons:".appraise_desk_img li"},events:function(){var a={};return a["dblclick "+this.ui.icons]="openSoftView",a["click "+this.ui.icons]="openSoftView",a},taskNameConfig:{"模拟活动介绍":"recommand","邮件":"email","视频通讯":"video","NTP内部工作平台":"ntp"},initialize:function(){var a=this;this.$el.on("click",function(){a.ui.icons.removeClass("desk_icon_click")})},onRender:function(){},onShow:function(){$(".appraise_desk").parents().css({width:"100%",height:"100%"}),this.addTaskNum(),$(".desktop_content").css("border","none")},addTaskNum:function(){var b=this,c=this.model.get("list"),d=0;a._.each(c,function(a){if("email"==a.soft&&(d=a.taskCount),!("video"==a.soft&&d>0)&&a.taskCount>0){var c=1==a.isAllowEnter?!0:!1;b.addNum(b.taskNameConfig[a.name],a.taskCount,c)}})},addNum:function(a,b,c){var d=this.ui.iconCon.find("li[data-flag="+a+"]").find("span");d.append(c?"<var class='desk_first'></var><em>"+b+"</em>":"<em>"+b+"</em>")},openSoftView:function(a){var b=$(a.currentTarget);this.ui.icons.removeClass("desk_icon_click"),b.addClass("desk_icon_click"),a.stopPropagation();var c=b.attr("data-flag");this.trigger("openSoftware",c)},onClose:function(){}});return c}),function(a){function b(){function b(a){"remove"===a&&this.each(function(a,b){var c=e(b);c&&c.remove()}),this.find("span.mceEditor,div.mceEditor").each(function(a,b){var c=tinyMCE.get(b.id.replace(/_parent$/,""));c&&c.remove()})}function d(a){var d,e=this;if(a!==c)b.call(e),e.each(function(b,c){var d;(d=tinyMCE.get(c.id))&&d.setContent(a)});else if(e.length>0&&(d=tinyMCE.get(e[0].id)))return d.getContent()}function e(a){var b=null;return a&&a.id&&f.tinymce&&(b=tinyMCE.get(a.id)),b}function g(a){return!!(a&&a.length&&f.tinymce&&a.is(":tinymce"))}var h={};a.each(["text","html","val"],function(b,f){var i=h[f]=a.fn[f],j="text"===f;a.fn[f]=function(b){var f=this;if(!g(f))return i.apply(f,arguments);if(b!==c)return d.call(f.filter(":tinymce"),b),i.apply(f.not(":tinymce"),arguments),f;var h="",k=arguments;return(j?f:f.eq(0)).each(function(b,c){var d=e(c);h+=d?j?d.getContent().replace(/<(?:"[^"]*"|'[^']*'|[^'">])*>/g,""):d.getContent({save:!0}):i.apply(a(c),k)}),h}}),a.each(["append","prepend"],function(b,d){var f=h[d]=a.fn[d],i="prepend"===d;a.fn[d]=function(a){var b=this;return g(b)?a!==c?(b.filter(":tinymce").each(function(b,c){var d=e(c);d&&d.setContent(i?a+d.getContent():d.getContent()+a)}),f.apply(b.not(":tinymce"),arguments),b):void 0:f.apply(b,arguments)}}),a.each(["remove","replaceWith","replaceAll","empty"],function(c,d){var e=h[d]=a.fn[d];a.fn[d]=function(){return b.call(this,d),e.apply(this,arguments)}}),h.attr=a.fn.attr,a.fn.attr=function(b,f){var i=this,j=arguments;if(!b||"value"!==b||!g(i))return f!==c?h.attr.apply(i,j):h.attr.apply(i,j);if(f!==c)return d.call(i.filter(":tinymce"),f),h.attr.apply(i.not(":tinymce"),j),i;var k=i[0],l=e(k);return l?l.getContent({save:!0}):h.attr.apply(a(k),j)}}var c,d,e=[],f=window;a.fn.tinymce=function(c){function g(){var d=[],e=0;b&&(b(),b=null),l.each(function(a,b){var f,g=b.id,h=c.oninit;g||(b.id=g=tinymce.DOM.uniqueId()),f=new tinymce.Editor(g,c),d.push(f),f.onInit.add(function(){var a,b=h;l.css("visibility",""),h&&++e==d.length&&(tinymce.is(b,"string")&&(a=-1===b.indexOf(".")?null:tinymce.resolve(b.replace(/\.\w+$/,"")),b=tinymce.resolve(b)),b.apply(a||tinymce,d))})}),a.each(d,function(a,b){b.render()})}var h,i,j,k,l=this,m="",n="";return l.length?c?(l.css("visibility","hidden"),f.tinymce||d||!(h=c.script_url)?1===d?e.push(g):g():(d=1,i=h.substring(0,h.lastIndexOf("/")),/_(src|dev)\.js/g.test(h)&&(n="_src"),j=h.lastIndexOf("?"),-1!=j&&(m=h.substring(j+1)),f.tinyMCEPreInit=f.tinyMCEPreInit||{base:i,suffix:n,query:m},-1!=h.indexOf("gzip")&&(k=c.language||"en",h=h+(/\?/.test(h)?"&":"?")+"js=true&core=true&suffix="+escape(n)+"&themes="+escape(c.theme)+"&plugins="+escape(c.plugins)+"&languages="+k,f.tinyMCE_GZ||(tinyMCE_GZ={start:function(){function b(a){tinymce.ScriptLoader.markDone(tinyMCE.baseURI.toAbsolute(a))}tinymce.suffix=n,b("langs/"+k+".js"),b("themes/"+c.theme+"/editor_template"+n+".js"),b("themes/"+c.theme+"/langs/"+k+".js"),a.each(c.plugins.split(","),function(a,c){c&&(b("plugins/"+c+"/editor_plugin"+n+".js"),b("plugins/"+c+"/langs/"+k+".js"))})},end:function(){}})),a.ajax({type:"GET",url:h,dataType:"script",cache:!0,success:function(){tinymce.dom.Event.domLoaded=1,d=2,c.script_loaded&&c.script_loaded(),g(),a.each(e,function(a,b){b()})}})),l):tinyMCE.get(l[0].id):l},a.extend(a.expr[":"],{tinymce:function(a){return!!(a.id&&"tinyMCE"in window&&tinyMCE.get(a.id))}})}(jQuery),define("Editor",function(){}),define("vendor/plugins/editor",["_","$","backbone","helpers/context","Editor","require"],function(a,b,c,d,e,f){function g(b){return b?(this.btnsList=[{name:"ActivityCreateTime",image:"activitycreatetime.png",title:"活动创建时间"},{name:"ReplyeMail",image:"replyemail.png",title:"发件人邮件地址"},{name:"Applicantlist",image:"applicantlist.png",title:"应聘者列表"},{name:"ActivityName",image:"activityname.png",title:"活动名称"},{name:"ActivityDescription",image:"activitydescription.png",title:"活动描述"},{name:"ActivityTotalCount",image:"activitytotalcount.png",title:"活动参加人数"},{name:"ActivitYopeningTime",image:"activityopeningtime.png",title:"活动开启时间"},{name:"Appraiser",image:"appraiser.png",title:"评价人"},{name:"ActivityParticiPantList",image:"activityparticipantlist.png",title:"被评价者列表"},{name:"PlanendTime",image:"planendtime.png",title:"发展周期（止）"},{name:"InterviewInfo",image:"interviewinfo.png",title:"面试说明"},{name:"InterviewSchedule",image:"interviewschedule.png",title:"面试安排表"},{name:"InterviewerName",image:"interviewername.png",title:"面试官姓名"},{name:"ApplicantName",image:"applicantname.png",title:"应聘者姓名"},{name:"PositionTitle",image:"positiontitle.png",title:"职位名称"},{name:"InterviewTime",image:"interviewtime.png",title:"面试时间"},{name:"WorkStartTime",image:"workstarttime.png",title:"到岗日期"},{name:"OtherDesc",image:"otherdesc.png",title:"福利"},{name:"Director",image:"director.png",title:"负责人"},{name:"Salary",image:"salary.png",title:"薪资"},{name:"SendTime",image:"sendtime.png",title:"发送时间"},{name:"ReceiverName",image:"receivername.png",title:"收件人"},{name:"UserName",image:"username.png",title:"用户姓名"},{name:"EndTime",image:"endtime.png",title:"截止时间"},{name:"LoginUrl",image:"loginurl.png",title:"登录地址"},{name:"UserEmail",image:"useremail.png",title:"邮件地址"},{name:"SerialNumber",image:"serialnumber.png",title:"通行证号"},{name:"CompanyName",image:"companyname.png",title:"企业名称"},{name:"TestUrl",image:"testurl.png",title:"作答链接"},{name:"StartTime",image:"starttime.png",title:"生效时间"},{name:"CandidateId",image:"candidateid.png",title:"应聘者ID"},{name:"SendMailTime",image:"sendmailtime.png",title:"发送时间"},{name:"DepartmentDirector",image:"departmentdirector.png",title:"部门负责人"},{name:"RecruDir",image:"recrudir.png",title:"招聘负责人"},{name:"StffRecomm",image:"stffrecomm.png",title:"员工推荐人"},{name:"HhRecomm",image:"hhrecomm.png",title:"猎头推荐人"},{name:"InterviewAddress",image:"interviewaddress.png",title:"面试地点"},{name:"DeliveryTime",image:"deliverytime.png",title:"最新投递时间"},{name:"JobAdvList",image:"jobadvlist.png",title:"职位广告列表"},{name:"LoginAndUrl",image:"loginandurl.png",title:"登录方式及链接"},{name:"OfficialRecruitmentPortal",image:"officialrecruitmentportal.png",title:"官方招聘门户"},{name:"EnterpriseName",image:"enterprisename.png",title:"企业名称"},{name:"JobResponsibilities",image:"jobresponsibilities.png",title:"工作职责"},{name:"VocationalQualification",image:"vocationalqualification.png",title:"任职资格"},{name:"DepartmentName",image:"departmentname.png",title:"部门名称"},{name:"DirectSuperior",image:"directsuperior.png",title:"直接上级"},{name:"WordAddress",image:"wordaddress.png",title:"工作地点"},{name:"BeginTime",image:"begintime.png",title:"开始日期"},{name:"EndDate",image:"enddate.png",title:"结束日期"},{name:"ProbationDate",image:"probationdate.png",title:"试用期"},{name:"BasicPay",image:"basicpay.png",title:"基本工资"},{name:"ProbationSalary",image:"probationsalary.png",title:"试用期工资"},{name:"Department",image:"department.png",title:"部门"},{name:"ValidateCode",image:"validatecode.png",title:"验证码"},{name:"TwoCode",image:"twocode.png",title:"二维码"},{name:"ExamPlace",image:"examplace.png",title:"考场地址"},{name:"ExamTime",image:"examtime.png",title:"考试时间"},{name:"ExamLength",image:"examlength.png",title:"考试时长"},{name:"HunterApplicantlist",image:"hunterapplicantlist.png",title:"猎头推荐应聘者列表"},{name:"InterviewDetailLink",image:"interviewdetaillink.png",title:"面试详情链接"},{name:"Networkapplicantlist",image:"networkapplicantlist.png",title:"网络人才库应聘者列表"}],this.add=function(){var b=this;
a.each(this.btnsList,function(a){b.addOne(a)})},void(this.addOne=function(a){var c,e=d.getStaticUrl("extras/tiny_mce_2.0_0/themes/advanced/img/"),f=a.name.toLowerCase(),g="mce"+a.name,h="<% "+f+" %>",i='<img src="'+e+a.image+'" class="'+g+" "+g+'Resize" />',j=b.getParam(a.name+"_separator",h);c=new RegExp(j.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(a){return"\\"+a}),"g"),b.addCommand(g,function(){b.execCommand("mceInsertContent",0,i)}),b.addButton(f,{title:a.title,cmd:g}),b.onInit.add(function(){b.theme.onResolveName&&b.theme.onResolveName.add(function(c,d){"IMG"==d.node.nodeName&&b.dom.hasClass(d.node,g)&&(d.name=a.name)})}),b.onClick.add(function(a,b){b=b.target,"IMG"===b.nodeName&&a.dom.hasClass(b,g)&&a.selection.select(b)}),b.onNodeChange.add(function(a,b,c){b.setActive(f,"IMG"===c.nodeName&&a.dom.hasClass(c,g))}),b.onBeforeSetContent.add(function(a,b){b.content=b.content.replace(c,i)}),b.onPostProcess.add(function(a,b){b.get&&(b.content=b.content.replace(/<img[^>]+>/g,function(a){return-1!==a.indexOf('class="'+g)&&(a=j),a}))})})):!1}return c.View.extend({initialize:function(a){this.options=a,this.ui={},this.ui.tinymceId=this.options.eId,this.editor=new c.Model({script_url:f.toUrl("tinymce"),eId:"",language:"zh",theme:"advanced",theme_advanced_resizing_min_height:20,plugins:this.options.plugins,theme_advanced_buttons1:this.options.theme_advanced_buttons1,theme_advanced_buttons2:this.options.theme_advanced_buttons2,theme_advanced_buttons3:this.options.theme_advanced_buttons3,theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",theme_advanced_statusbar_location:"none",theme_advanced_resizing:!0,encoding:"html"})},show:function(){this.$el.find(this.ui.tinymceId).tinymce().show()},hide:function(){this.$el.find(this.ui.tinymceId).tinymce().hide()},getContent:function(){return this.$el.find(this.ui.tinymceId).html()},editorGetText:function(){return this.$el.find(this.ui.tinymceId).text()},setContent:function(b){this.$el.find(this.ui.tinymceId).html(a.escape(b))},getSelContent:function(){return this.$el.find(this.ui.tinymceId).tinymce().selection.getContent()},getSelText:function(){return this.$el.find(this.ui.tinymceId).tinymce().selection.getContent({format:"text"})},insertContent:function(a){this.$el.find(this.ui.tinymceId).tinymce().execCommand("mceInsertContent",!1,a)},remove:function(){this.$el.find(this.ui.tinymceId).tinymce().remove()},render:function(){this.$el.find(this.ui.tinymceId).tinymce({script_url:this.editor.get("script_url"),language:this.editor.get("language"),theme:this.editor.get("theme"),convert_urls:!1,theme_advanced_resizing_min_height:this.editor.get("theme_advanced_resizing_min_height"),plugins:this.editor.get("plugins"),theme_advanced_buttons1:this.editor.get("theme_advanced_buttons1"),theme_advanced_buttons2:this.editor.get("theme_advanced_buttons2"),theme_advanced_buttons3:this.editor.get("theme_advanced_buttons3"),theme_advanced_toolbar_location:this.editor.get("theme_advanced_toolbar_location"),theme_advanced_toolbar_align:this.editor.get("theme_advanced_toolbar_align"),theme_advanced_statusbar_location:this.editor.get("theme_advanced_statusbar_location"),theme_advanced_resizing:this.editor.get("theme_advanced_resizing"),encoding:this.editor.get("encoding"),setup:function(a){var b=new g(a);b.add()}})}})}),define("views/quiz/appraise/dialog-assist/instruction-view",["talent","templates/quiz","vendor/plugins/editor"],function(a,b){return a.ItemView.extend({template:b["quiz/appraise/dialog-assist/instruction"],events:function(){var a={};return a["click .close"]="closeView",a["click .sure_btn"]="sure",a},initialize:function(){},onShow:function(){},closeView:function(){this.trigger("close-dialog")},sure:function(){this.trigger("sure-dialog")},onClose:function(){}})}),define("views/quiz/introduce/ceshi-view",["talent","templates/quiz"],function(a,b){var c=a.ItemView.extend({template:b["quiz/introduce/ceshi-view"]});return c}),define("views/quiz/introduce/task-role-view",["talent","templates/quiz","views/common/plugins/dialog/bsdialog"],function(a,b,c){var d=a.ItemView.extend({template:b["quiz/introduce/task-role-view"],initialize:function(){var b=this.getCntSessionData("testee"),c=$.cookie("UserPhotoPath")||JSON.parse(b).avatar;c=c.length>0?c:this.getLocalAvatar(),this.model=new a.Model({avatar:c})},onRender:function(){},getLocalAvatar:function(){var b,c=this.getCntSessionData("testee");return b=a.Context.getStaticUrl(0==JSON.parse(c).sex?"images/autophoto/girl.jpg":"images/autophoto/boy.jpg")},getCntSessionData:function(b){var d=this;try{return a.Context.getTemporaryData(b)}catch(e){if(a.$(".net-error-dialog").length<1){var f=[{name:"确定",type:"blue_btn",id:"sure",eventName:"click:sure"}],g={title:"错误提示",content:"获取数据失败，请重新登陆",icon:"sigh",buttons:f,isDrag:!0,moveDown:!0,simpleModal:{modal:!0,minWidth:350},dialogId:"net-error-dialog"};d.dialog=new c({config:g}),d.listenTo(d.dialog,"click:sure",function(){d.dialog.close(),a.app.execute("history:navigate","#quiz%2Flogin",!1)}),console.error(e.message)}}}});return d}),define("views/quiz/introduce/index-page-view",["talent","templates/quiz","views/quiz/introduce/ceshi-view","views/quiz/introduce/task-role-view","$.cookie"],function(a,b,c,d){var e=a.Model.extend(),f=a.Model.extend(),g=a.Layout.extend({template:b["quiz/introduce/index-page"],className:"activity_intro_main",regions:{content:".show_group",role:".task_role"},events:function(){var a={};return a["click .tab_menu li"]="tan",a["click .close_big"]="closeSoft",a},initialize:function(){var a=new e;this.charView=new c({model:a});var b=new f;this.roleView=new d({model:b})},onShow:function(){a.$("ul.tab_menu li:first").css("color","#fff").addClass("toggle_bg")},onRender:function(){var a=this;this.content.show(this.charView),this.role.show(this.roleView),this.initializeStar(),this.resetHeight(),$(window).bind("resize",function(){a.resetHeight()})},initializeStar:function(){this.$("#org").jOrgChart({chartElement:this.$(".show_group"),nodeClassName:"node",isClick:!1}),this.$("#org01").jOrgChart({chartElement:this.$(".task_role"),nodeClassName:"node",isClick:!1});var a=this.$(".intro_org_name");$($(a[a.length-1]).parents()[7]).prev().empty()},resetHeight:function(){this.$(".activity_intro_content").css("height",document.documentElement.clientHeight-76)},tan:function(b){var c=a.$(b.target).index();a.$(b.target).css({color:"#ffffff"}).addClass("toggle_bg").siblings().css({color:"#000000"}).removeClass("toggle_bg"),this.$el.find(".tab_con>div").eq(c).removeClass("con_hide").siblings().addClass("con_hide")},closeSoft:function(){this.trigger("closeSoftWare","recommand")}});return g}),define("views/quiz/video/list-page-view",["talent","templates/quiz","moment"],function(a,b){var c=a.ItemView.extend({template:b["quiz/video/list-item-page"],ui:{},events:function(){var a={};return a["click li"]="changeActiveItem",a},initialize:function(){},onRender:function(){},onShow:function(){},changeActiveItem:function(a){if("undefined"==typeof window.isSendingFlag||1==window.isSendingFlag){var b=$(a.currentTarget),c=b.attr("id");$(".appvideo_list li").removeClass("appvideo_active"),b.addClass("appvideo_active"),this.trigger("changeActiveItem",c)}},onClose:function(){}}),d=a.CompositeView.extend({template:b["quiz/video/list-page"],itemViewContainer:"ul",itemView:c,ui:{},events:function(){var a={};return a["click .activity_close"]="closeSoft",a},initialize:function(){this.itemViewOptions=this.options.options,this.on("itemview:changeActiveItem",this.onChangeActiveItem,this)},onRender:function(){},onShow:function(){},onChangeActiveItem:function(){this.trigger("changeActiveItem",arguments[1])},onClose:function(){}});return d}),define("views/quiz/video/index-page-view",["talent","templates/quiz","$.cookie","timedialog","views/common/plugins/dialog/bsdialog","views/quiz/video/list-page-view"],function(a,b,c,d,e,f){var g=a.Model.extend({id:-1,status:!1,speed:"0%(0KB/s)",fileSize:"0M"}),h=a.Collection.extend({model:g}),i=a.ItemView.extend({template:b["quiz/video/speed-item-view"],tagName:"tr",initialize:function(){},regions:{},ui:{},events:function(){var a={};return a},onRender:function(){},modelEvents:{change:"viewModelChange"},viewModelChange:function(){this.render()},onShow:function(){},onClose:function(){}}),j=a.CompositeView.extend({itemView:i,template:b["quiz/video/speed-win-view"],itemViewContainer:"#itemloop",initialize:function(){this.collection=new h;var b=this;this.model=new a.Model({queueCount:b.collection.length})},modelEvents:{change:"viewModelChange"},viewModelChange:function(){this.$el.find(".queueLen").html("发送列表："+this.model.get("queueCount"))},collectionEvents:{add:"queueAdded"},redraw:function(){},queueAdded:function(){this.model.set({queueCount:this.collection.length})},getItemViewContainer:function(a){if("$itemViewContainer"in a)return a.$itemViewContainer;var b;if(a.itemViewContainer){var c=_.result(a,"itemViewContainer");b=a.$(c),b.length<=0&&(b=a.$el)}else b=a.$el;return a.$itemViewContainer=b,b},regions:{},ui:{},events:function(){var a={};return a},onRender:function(){},onShow:function(){},onClose:function(){}}),k=a.Layout.extend({template:b["quiz/video/index-page"],className:"appvideo_container",regions:{list:".appvideo_list",content:".appvideo_info",speedContainer:".loopContainer"},ui:{speedWinButton:".speedWin>.header>span",speedWinContent:".speedWin>.content"},events:function(){var a={};return a["click .close_big"]="closeSoft",a["click .speedWin>.header>.minBtn"]="miniWin",a},initialize:function(a){window.location.host.indexOf(".cn")>0?(document.domain="ceping.com.cn",this.videoHost="//videocloud.ceping.com.cn"):(document.domain="ceping.com",this.videoHost="//videocloud.ceping.com"),this.options=a;var b=this.getCntSessionData("testee");this.model.set("name",JSON.parse(b).name);var c=$.cookie("UserPhotoPath")||JSON.parse(b).avatar;c=c.length>0?c:this.getLocalAvatar(),this.model.set("avatar",c),window._assessmentStreamRef=null,this.autoSaveTime(),window.updateIframeStatus=_.bind(this.SaveIframeValue,this),window.uploadError=_.bind(this.uploadError,this),window.hadleAddListItem=_.bind(this.hadleAddListItem,this),window.preventClickItem=_.bind(this.preventClickItem,this),window.resumeClickItem=_.bind(this.resumeClickItem,this),window.removeLoading=_.bind(this.removeLoading,this),window._showConfirmDialog=_.bind(this._showConfirmDialog,this),window.saveStatusArr=[],window.saveStatus=function(a){window.saveStatusArr.push(a)},window.dovisualclick=function(){setTimeout(function(){$(".appvideo_list li").each(function(a,b){var c=$(b).html();c.indexOf("张涛")>-1&&$(b).click()})},3e3)}},onRender:function(){this.speedCompositeView=new j,this.speedContainer.show(this.speedCompositeView)},miniWin:function(){var a=$(".speedWin>.content");a.attr("style").indexOf("none")>-1?(a.show(),$(".minBtn").removeClass("icon1").addClass("icon2")):(a.hide(),$(".minBtn").removeClass("icon2").addClass("icon1"))},onShow:function(){var a=this;this.listData=null,this._requestData(function(b){a.showTimeDialog(b),a.renderList(b)});var b=$(".speedWin>.content");b.hide(),$(".desktop_container").css({backgroundColor:"#fff"});$(".appvideo_msg").height();$(".appvideo_main").css("height","-=100"),window.onresize=function(){$(".appvideo_msg").height();$(".appvideo_main").height("100%"),$(".appvideo_main").css("height","-=100")}},getLocalAvatar:function(){var b=this.getCntSessionData("testee");this.model.set("name",JSON.parse(b).name);var c;return c=a.Context.getStaticUrl(0==JSON.parse(b).sex?"images/autophoto/lady-circle.png":"images/autophoto/boy-circle.png")},_requestData:function(b){var c=this,d={SectionId:this.getCntSessionData("sectionId"),partType:c.options.partType};a.app.request("deskVideo:getVideoPart",d).done(function(a){return a.netError?(c.showNetErrorDialog(),!1):void b(a)}.bind(this))},showTimeDialog:function(a){var b=this;this.timeDialog=new d({title:"剩余时间",showPro:!0,done:a.handledCount,total:2,countdown:a.requireTimes-a.useTime,totalTime:a.requireTimes,containment:"#bs_layout_container",isbreak:0==this.getCntSessionData("isBreak")?!1:!0,autoSubmit:!1,endTime:0}),this.timeDialog.show(),this.listenTo(this.timeDialog,"timeOver",function(){b.requestIsCompelete(!1)})},requestIsCompelete:function(b){var c=this,d={sectionId:this.getCntSessionData("sectionId"),partType:c.options.partType};a.app.request("deskVideo:checkPartComplete",d).done(function(a){if(a.netError)return c.showNetErrorDialog(),!1;if(b)if(0==a){var d={type:"common",title:" ",content:"<div class='tip_dialog'><span></span>您的视频留言还没有处理完，是否仍然退出？</div>",buttons:[{name:"是",id:"tip_sure",type:"tip_sure",eventName:"tipSure"},{name:"否",id:"tip_cancle",type:"tip_cancle",eventName:"tipCancle"}],simpleModal:{modal:!0,minWidth:438,opacity:0},isDrag:!1,moveDown:!1,icon:"common"};c._showDialog(d,"btnSure","btnCancle")}else{var d={type:"common",title:" ",content:"<div class='tip_dialog'><span></span>您的视频留言已全部处理完毕，请点击确定退出该软件，结束视频的处理</div>",buttons:[{name:"确定",id:"tip_sure",type:"tip_sure",eventName:"tipSure"}],simpleModal:{modal:!0,minWidth:438,opacity:0},isDrag:!1,moveDown:!1,icon:"common"};c._showDialog(d,"btnSure")}})},_showDialog:function(a,b,c){var d=this,b=b||"btnSure",c=c||"btnCancle",f=a,g=new e({config:f});d.listenTo(g,b,function(){g.close(),window.isSendingFlag=!0,window.isfirstshowingthis=!1,d.removeView()}),d.listenTo(g,c,function(){g.close()})},_showConfirmDialog:function(a){var b={icon:"video",isDrag:!1,moveDown:!0,simpleModal:{modal:!0,minWidth:350,opacity:0},content:"您是否检查过视频，确认发送给对方吗？",buttons:[{name:"确定",type:"blue_btn",id:"text",eventName:"btnSureMention"},{name:"取消",type:"grey_btn",id:"canc",eventName:"btnCancleMention"}]},c=this,d="btnSureMention",f="btnCancleMention",g=b,h=new e({config:g});c.listenTo(h,d,function(){a.isSendCallBackFn(),h.close()}),c.listenTo(h,f,function(){h.close()})},renderList:function(b){var c=this,d=0;$(".appvideo_list li").each(function(a,b){var b=$(b),c=b.attr("class");"undefined"!=typeof c&&b.attr("class").indexOf("appvideo_active")>-1&&(d=a)});var e=!1,g=!1;$(".appvideo_list li").each(function(){var a=$(this).html();a.indexOf("张涛")>-1&&(e=!0)});var h=new a.Collection(b.taskList);this.listPageView=new f({options:this.options,collection:h}),this.list.show(this.listPageView),$(".appvideo_list li").each(function(a,b){$(b).removeClass("appvideo_active"),a==d&&$(b).addClass("appvideo_active");var c=$(this).html();c.indexOf("张涛")>-1&&(g=!0)}),0==g&&1==e&&c.hadleAddListItem(),("undefined"==typeof window.isfirstshowingthis||0==window.isfirstshowingthis)&&(this.renderContent(b.taskList[0]),window.isfirstshowingthis=!0),this.listenTo(this.listPageView,"changeActiveItem",function(a){this.renderContent(h.findWhere({id:a}).toJSON())}.bind(this))},renderContent:function(b){var c=this;if($("#ifrm"+b.index).length>0)$("iframe").hide(),window.saveStatusArr.indexOf(b.index.toString())>-1&&$("#ifrm"+b.index).attr("src",c.videoHost+"/Home/NtpVideo?_id="+b.index+"&_v="+Math.random(1e4)),$("#ifrm"+b.index).show();else{$("iframe").hide(),c.$el.find(".loading").show();var d=document.createElement("iframe");d.setAttribute("id","ifrm"+b.index),d.setAttribute("name","ifrm"+b.index),d.setAttribute("src",c.videoHost+"/Home/NtpVideo?_id="+b.index+"&_v="+Math.random(1e4)),d.setAttribute("frameBorder","0"),d.setAttribute("scrolling","no"),d.setAttribute("width","100%"),d.setAttribute("height","100%"),this.$el.find(".appvideo_info").append(d)}window.iframeData||(window.iframeData={uploadQueue:this.speedCompositeView.collection}),window.iframeData["ifrm"+b.index]={part:this.options,avatar:this.model.get("avatar"),sectionId:this.getCntSessionData("sectionId"),taskList:b,userInfo:a.Context.getUserInfo()},this.$el.find("#ifrm1").on("load",function(){})},removeLoading:function(){this.$el.find(".loading").hide()},removeView:function(){var a=this;a.timeDialog.remove(),a.trigger("closeSoftWare","video")},closeSoft:function(){var b=this,c={sectionId:this.getCntSessionData("sectionId"),partType:b.options.partType};a.app.request("deskVideo:checkPartComplete",c).done(function(a){if(a.netError)return b.showNetErrorDialog(),!1;var c="视频通讯未处理完,您确定关闭软件吗?",d=$("iframe");if($(d).each(function(){var a=$(this).attr("name");"undefined"==typeof a||a.indexOf("ifrm")<0||this.contentWindow.isOnSending()&&(c="您确定关闭软件吗？软件将不会记录未成功发送的视频留言")}),0==a){var e={icon:"video",isDrag:!1,moveDown:!0,simpleModal:{modal:!0,minWidth:350,opacity:0},content:c,buttons:[{name:"确定",type:"blue_btn",id:"text",eventName:"btnSure"},{name:"取消",type:"grey_btn",id:"canc",eventName:"btnCancle"}]};b._showDialog(e,"btnSure","btnCancle")}else b.removeView()})},autoSaveTime:function(){var b=this,c={SectionId:this.getCntSessionData("sectionId"),partType:this.options.partType,firstEmailUseTime:0,operateType:"close"};this.autoSaveTimeInter=setTimeout(function(){a.app.request("time:recordPartTime",c).done(function(a){a.netError&&(b.showNetErrorDialog(),clearTimeout(b.autoSaveTimeInter))}),setTimeout(arguments.callee,187e3)},187e3)},getCntSessionData:function(b){var c=this;try{return a.Context.getTemporaryData(b)}catch(d){if(a.$(".net-error-dialog").length<1){var f=[{name:"确定",type:"blue_btn",id:"sure",eventName:"click:sure"}],g={title:"错误提示",content:"获取数据失败，请重新登陆",icon:"sigh",buttons:f,isDrag:!0,moveDown:!0,simpleModal:{modal:!0,minWidth:350},dialogId:"net-error-dialog"};c.dialog=new e({config:g}),c.listenTo(c.dialog,"click:sure",function(){c.dialog.close(),a.app.execute("history:navigate","#quiz%2Flogin",!1)}),console.error(d.message)}}},showNetErrorDialog:function(){if(a.$(".net-error-dialog").length<1){var b=this,c=[{name:"刷新",type:"blue_btn",id:"sure",eventName:"click:sure"},{name:"取消",type:"grey_btn",id:"cancle",eventName:"click:cancle"}],d={title:"错误提示",content:"数据传输错误，请刷新重试或联系客服人员解决",icon:"sigh",buttons:c,isDrag:!0,moveDown:!0,simpleModal:{modal:!0,minWidth:350},dialogId:"net-error-dialog"},f=new e({config:d});b.listenTo(f,"click:cancle",function(){f.close()}),b.listenTo(f,"click:sure",function(){location.reload()})}},uploadError:function(){if(a.$(".net-error-dialog").length<1){var b={type:"common",title:"  ",content:"<div class='tip_dialog'><span></span>网络状况不佳，请重新上传</div>",buttons:[{name:"确定",id:"tip_sure",type:"tip_sure",eventName:"tipSure"}],simpleModal:{modal:!0,minWidth:438,opacity:0},isDrag:!1,moveDown:!1,icon:"common",dialogId:"net-error-dialog"},c=new e({config:b});this.listenTo(c,"tipSure",function(){c.close(),$("#ifrm1")[0].contentWindow.removeProcessView()})}},SaveIframeValue:function(b,c,d){var e=this,f={resultStr:b,taskId:d,sectionId:e.getCntSessionData("sectionId"),partType:e.options.partType,recordDuration:c,isSentEmptyData:0};a.app.request("deskVideo:saveAnswer",f).done(function(a){return a.netError?(e.uploadError(),!1):void setTimeout(function(){e._requestData(function(a){for(var b=Number(a.handledCount),c=0;c<a.taskList.length;c++)"张涛"==a.taskList[c].contactInfo.name.trim()&&(a.taskList[c].index=3),"陈心昱"==a.taskList[c].contactInfo.name.trim()&&(a.taskList[c].index=1),"刘奇"==a.taskList[c].contactInfo.name.trim()&&(a.taskList[c].index=2);if(e.renderList(a),e.timeDialog.changePro(b),2==b){var d={type:"common",title:"  ",content:"<div class='tip_dialog'><span></span>您的视频留言已全部处理完毕，请点击确定退出该软件，结束视频的处理</div>",buttons:[{name:"确定",id:"tip_sure",type:"tip_sure",eventName:"btnSure"}],simpleModal:{modal:!0,minWidth:438,opacity:0},isDrag:!1,moveDown:!1,icon:"common"};e._showDialog(d,"btnSure","btnCancle")}})},100)})},hadleAddListItem:function(){var b=a.Context.getStaticUrl("images/photos/zhangtao.png"),c=a._.template(['<div><li  class="appvideo_active">','<img src="'+b+'">','<div class="appvideo_contact_msg">',"P事业部-张涛 <br>","视频留言：","<span></span>","</div>","</li></div>"].join(""));this.$el.find(".appvideo_list li").removeClass("appvideo_active"),this.$el.find("ul.appvideo_list").prepend(c)},preventClickItem:function(){window.isSendingFlag=!1},resumeClickItem:function(){window.isSendingFlag=!0},onClose:function(){this.autoSaveTimeInter&&clearTimeout(this.autoSaveTimeInter),window.ntpIframeData&&(window.ntpIframeData=null),window.iframeData=null}});return k}),define("views/quiz/email/email-preview-view",["talent","templates/quiz"],function(a,b){return a.ItemView.extend({template:b["quiz/email/email-preview"],status:{NOTREAD:1,READED:2,REPLY:3,FORWARD:4},events:function(){var a={};return a["click .email_item"]="readMail",a},initialize:function(){var a=this.model.get("receive"==this.model.get("flag")?"sender":"receiver");this.model.set("outman",a),this.model.get("outman")||this.model.set("outman","<无收件人>"),this.model.get("title")||this.model.set("title","（无主题）")},readMail:function(){this.$(".email_status_icon").removeClass("not_read"),this.model.get("status")==this.status.NOTREAD&&this.model.set("status",this.status.READED)}})}),define("views/quiz/email/email-list-view",["talent","templates/quiz","views/quiz/email/email-preview-view"],function(a,b,c){return a.CollectionView.extend({itemView:c,tagName:"ul",events:function(){var a={};return a["click .email_item"]="seeEmail",a["dblclick .email_item[flag='draft']"]="showEmail",a},initialize:function(b){this.activeModel=new a.Model({activeMailId:b.activeMailId}),this.listenTo(this.activeModel,"change:activeMailId",function(){this.trigger("activeEmail",this.activeModel.get("activeMailId"),this.activeModel.get("oldActiveMailId"))})},onShow:function(){var a=this.activeModel.get("activeMailId");a&&this.$("#"+a).addClass("active_email")},seeEmail:function(a){var b=this.$(a.currentTarget),c=this.activeModel.get("activeMailId");c&&b.attr("id")==c||(this.activeModel.set("activeMailId",b.attr("id")),this.activeModel.set("oldActiveMailId",c),c?this.$("#"+c).removeClass("active_email"):"",b.addClass("active_email"))},showEmail:function(){this.trigger("write:email","draft")},focusEmail:function(a){a&&(this.$(".email_item").removeClass("active_email"),this.$("#"+a).addClass("active_email").find(".email_status_icon").removeClass("not_read"))}})}),define("views/quiz/email/email-detail-view",["talent","templates/quiz"],function(a,b){return a.Layout.extend({template:b["quiz/email/email-detail"],initialize:function(a){this.model=a.model},onBeforeRender:function(){this.model.get("receiver")||this.model.set("receiver","<无收件人>"),this.model.get("title")||this.model.set("title","（无主题）")}})}),define("views/quiz/email/email-catalog-view",["talent","templates/quiz"],function(a,b){return a.ItemView.extend({template:b["quiz/email/email-catalog"],initialize:function(a){this.model=a.model}})}),define("views/quiz/email/edit/edit-cont-view",["talent","templates/quiz","vendor/plugins/editor"],function(a,b,c){return a.ItemView.extend({template:b["quiz/email/edit/edit-cont"],initialize:function(){this.EmailEditor=new c({el:this.$el,language:"en",eId:"#elm3",plugins:"style,layer,save,advhr,advlink,insertdatetime,preview,media,searchreplace,print",theme_advanced_buttons1:"fontsizeselect,forecolor,bold,italic,underline,|,justifyleft,justifycenter,justifyright"}),this.model=new a.Model({height:this.options.height})},onShow:function(){var a=this;setTimeout(function(){var b=a.options.emailCont;a.EmailEditor.render();try{a.EmailEditor.insertContent(b)}catch(c){a.EmailEditor.setContent(b)}},100)},onClose:function(){this.EmailEditor.remove()}})}),define("views/quiz/email/email-edit-view",["talent","templates/quiz","views/quiz/email/edit/edit-cont-view","views/common/plugins/dialog/bsdialog"],function(a,b,c,d){return a.Layout.extend({template:b["quiz/email/email-edit"],ui:{recevier:".recevier",theme:".theme",saveTime:".save_time"},events:function(){var a={};return a["click .edit_email"]="checkBlur",a["click .can_sent"]="sentMail",a["click .save_draft"]="saveDraft",a["input .recevier"]="couldSent",a["focus .recevier"]="toggleInput",a["blur .recevier"]="toggleInput",a["input .theme"]="limitLength",a["click .close_div"]="showPromptDialog",a["click .big_size_small"]="toggleSize",a},regions:{editContent:".edit_email_content"},UIStr:["0","低","中","高"],shiftUIStr:{"请选择":0,"低":1,"中":2,"高":3},initialize:function(b){this.submitModel=b.submitModel,this.operateType=b.operateType;var c=1==this.operateType?"新建":2==this.operateType?"回复":"转发";this.model=b.model?b.model:new a.Model({sender:"",title:""}),this.model.set({height:360,operateTypeName:c}),this.model.get("title").indexOf("转发")<0||"draft"==this.model.get("flag")||this.model.set("sender",""),this.listenTo(this.model,"change",this.updateEmailMD5)},onShow:function(){this.$(".importance").val(this.shiftUIStr[this.model.get("importance")]),this.$(".urgency").val(this.shiftUIStr[this.model.get("urgency")]);var a=this.model.get("content");this.editContView=new c({emailCont:a,height:this.model.get("height")}),this.editContent.show(this.editContView),this.couldSent(),this.triggerMethod("record:MD5"),$("body").delegate(".simplemodal-overlay,.simplemodal-wrap,.bs_dialog3","click",function(a){a.stopPropagation(),$(a.currentTarget).attr("class").indexOf("bs_dialog3")<0&&($(".bs_dialog3>.noradius").addClass("dialog_edit_view"),setTimeout(function(){$(".bs_dialog3>.noradius").removeClass("dialog_edit_view")},200))})},onRecordMD5:function(){var a=this;setTimeout(function(){a.updateEmailMD5()},200),setTimeout(function(){a.updateEmailMD5()},900)},updateEmailMD5:function(){this.oldEmailMD5=this.getEmailMD5(),$($(".mceIframeContainer").find("iframe").prop("contentDocument")).scrollTop(0)},checkBlur:function(a){"recevier"!=$(a.target).attr("class")&&this.$(".recevier").blur(),"theme"!=$(a.target).attr("class")&&this.$(".theme").blur()},sentMail:function(a){var b=this;if(0!=b.$(".urgency").val()&&0!=b.$(".importance").val()||1==a)if(b.$(".theme").val().trim()||1==a){var c=b.buildEmail();b.trigger("sentEmail",c,a),this.closeView()}else b.showThemeEmptyDialog("主题为空，您确定发送这封邮件吗？","sureAndCanc");else b.showThemeEmptyDialog("请先判断紧急性和重要性后，再发送邮件","sure")},saveDraft:function(a){var b=this.buildEmail();this.trigger("saveEmail",b,a),1==a&&this.closeView()},saveDraftSccuess:function(a){!this.promptDialog||this.promptDialog.close(),this.ui.saveTime.html(a+" 已保存")},buildEmail:function(a){function b(){for(var a=window.frames,b=null,c=a.length-1;c>=0&&!(b=a[c].document.getElementById("tinymce"));c--);return b}var c=this.$(".theme").val().trim(),d=this.$(".urgency").val(),e=this.$(".importance").val(),f=this.$(".recevier").val().trim(),g=b(),h=$(g).find("p");$(h).each(function(){var a=$(this).html().trim();0==a.length&&$(this).remove()});var i=encodeURIComponent(this.editContView.EmailEditor.getContent()),j={title:c,urgency:this.UIStr[d],importance:this.UIStr[e],receiver:f,content:i,operateName:this.operateType,emailId:this.model.get("id"),recordId:this.model.get("recordId")||0,submitPart:0};return a||this.model.set(j),j},getEmailMD5:function(){var a={title:this.$(".theme").val(),urgency:this.UIStr[this.$(".urgency").val()],importance:this.UIStr[this.$(".importance").val()],receiver:this.$(".recevier").val(),content:_.unescape(this.editContView.EmailEditor.getContent())};return JSON.stringify(a)},couldSent:function(a){var b=this.ui.recevier.val().trim();b.length>0?(this.$(".sent_email").removeClass("canot_sent"),this.$(".sent_email").addClass("can_sent")):(this.$(".sent_email").removeClass("can_sent"),this.$(".sent_email").addClass("canot_sent")),a&&this.limitLength(a)},limitLength:function(a){var b=50,c=$(a.currentTarget);if(!c.prop("comStart")){c.on("compositionstart",function(){$(this).prop("comStart",!0)}).on("compositionend",function(){$(this).prop("comStart",!1)});var d=c.val(),e=c.val().trim();e.length>b&&c.val(d.substring(0,d.indexOf(e))+e.substring(0,b))}},toggleInput:function(a){var b=$(a.currentTarget);"focusin"==a.type&&b.attr("placeholder",""),"focusout"==a.type&&0==b.val().trim().length&&b.attr("placeholder","填写收件人姓名或工作岗位名称即可，如有多个收件人请用分号隔开")},toggleSize:function(){var a=this;a.buildEmail(),a.$(".big").length?(a.model.set("height",700),a.$(".big_size_small").removeClass("big"),a.$(".big_size_small").addClass("small"),a.trigger("maxDig",a)):(a.model.set("height",360),a.$(".big_size_small").removeClass("small"),a.$(".big_size_small").addClass("big"),a.trigger("minDig",a))},showPromptDialog:function(){if(this.promptDialog&&this.promptDialog.close(),this.oldEmailMD5==this.getEmailMD5())this.closeView();else{var a=this.model.get("emailId")?"邮件内容已修改，是否需要保存?":"是否需要保存该邮件至草稿箱?",b=[{name:"确定保存",type:"blue_btn",id:"sure",eventName:"click:save"},{name:"取消",type:"grey_btn",id:"canc",eventName:"click:canc"}],c={content:a,icon:"email",buttons:b,isDrag:!1,moveDown:!0,simpleModal:{modal:!1,minWidth:350}};this.promptDialog=new d({config:c}),this.listenTo(this.promptDialog,"click:save",this.orderSaveDraft),this.listenTo(this.promptDialog,"click:canc",this.closeView)}},showThemeEmptyDialog:function(a,b){var c,e=this,f=!0;"sure"==b&&(c=[{name:"确定",type:"blue_btn",id:"canc",eventName:"click:canc"}]),"sureAndCanc"==b&&(c=[{name:"确定",type:"blue_btn",id:"save",eventName:"click:save"},{name:"取消",type:"grey_btn",id:"canc",eventName:"click:canc"}]);var g={content:a,icon:"email",buttons:c,isDrag:!1,moveDown:!0,simpleModal:{modal:!1,minWidth:350}};e.themeEmptyDialog&&(f=e.themeEmptyDialog.isClosed),f&&(e.themeEmptyDialog=new d({config:g}),e.listenTo(e.themeEmptyDialog,"click:save",function(){var a=e.buildEmail();e.trigger("sentEmail",a),e.themeEmptyDialog.close()}),e.listenTo(e.themeEmptyDialog,"click:canc",function(){e.themeEmptyDialog.close()}))},orderSaveDraft:function(){this.saveDraft(),this.closeView()},closeView:function(){this.trigger("clsDig"),!this.promptDialog||this.promptDialog.close(),!this.themeEmptyDialog||this.themeEmptyDialog.close(),this.close()}})}),define("views/quiz/email/edit/cont-preview-view",["talent","templates/quiz","vendor/plugins/editor"],function(a,b){return a.ItemView.extend({template:b["quiz/email/edit/cont-preview"],events:function(){var a={};return a["click .close_div"]="closeView",a["click .reply_email_use"]="replyEmail",a["click .forward_email_use"]="forwardEmail",a},initialize:function(){},onShow:function(){},replyEmail:function(){this.trigger("preview:reply")},forwardEmail:function(){this.trigger("preview:forward")},closeView:function(){this.trigger("clsDig")},onClose:function(){}})}),define("views/quiz/email/email-app-view",["talent","_","templates/quiz","views/quiz/email/email-list-view","views/quiz/email/email-detail-view","views/quiz/email/email-catalog-view","views/quiz/email/email-edit-view","views/quiz/email/edit/cont-preview-view","views/common/plugins/dialog/bsdialog"],function(a,b,c,d,e,f,g,h,i){var j=a.Layout.extend({template:c["quiz/email/email-app"],templateEmailCont:c["quiz/email/email-content"],ui:{receive:".receive",draft:".draft",sent:".sent",emailDetail:".app_email_detail",emailList:".app_email_list"},regions:{emailList:".app_email_list",emailDetail:".app_email_detail",emailCatalog:".email_catalog"},status:{NOTREAD:1,READED:2,REPLY:3,FORWARD:4},operateType:{WRITE:1,REPLY:2,FORWARD:3},respType:{SUCCESS:null,ERROR:2},events:function(){var a={};return a["click .catalog_item"]="catalogChange",a["click .write_email_use"]="writeEmail",a["click .reply_email_use"]="replyEmail",a["click .forward_email_use"]="forwardEmail",a["click .close_div"]="closeView",a["dblclick .email_item"]="showPreviewDialog",a},initialize:function(b){this.dialogSwitch="off",this.emailListData=b.listData,this.options=b.parentOptions,this.getCntSessionData=b.getCntSessionData,this.testee=JSON.parse(this.getCntSessionData("testee")),this.emailDetailListData={receive:[],sent:[],draft:[]},this.emailCatalogActiveData={receive:"",sent:"",draft:""},this.emailCatalogActiveData[this.emailListData.activeTab]=this.emailListData.activeMailId,this.completeNumModel=new a.Model({completeNum:this.emailListData.activeMailNum}),this.listenTo(this.completeNumModel,"change",this.completeEmail),this.emailListData.activeMailId&&"sent"!=this.emailListData.activeTab&&this.recordReadEmail(void 0,this.emailListData.activeMailId,void 0,this.emailListData.activeTab)},onRender:function(){this.listenModel()},listenModel:function(){this.initModel(),this.listenTo(this.emailStatusModel,"change:activeTab",this.refreshList),this.listenTo(this.emailStatusModel,"change:activeMailId",this.focusEmail),this.listenTo(this.catalogModel,"change",this.refreshCatalog)
},initModel:function(){this.initCataModel(),this.emailStatusModel=new a.Model(b.pick(this.emailListData,"activeTab","activeMailId","activeMailNum")),this.activeEmailModel=new a.Model({receiver:this.testee.name}),this.emailStatusModel.get("activeMailId")&&this.activeEmailModel.set(this.getActiveEmailDetail())},initCataModel:function(b){var c,d,e;if(b){var f=this.emailStatusModel.get("activeTab");"receive"==f?(c=this.receiveStatusNum(b.models).notRead,this.catalogModel.set("receiveNotReadNum",c?"("+c+")":"")):"draft"==f?(d=b.models.length,this.catalogModel.set("draftNum",d?"("+d+")":"")):"sent"==f&&(e=b.models.length,this.catalogModel.set("sentNum",e?"("+e+")":""))}else c=this.receiveStatusNum(this.emailListData.receive.list).notRead,d=this.emailListData.draft.total,e=this.emailListData.sent.total,this.catalogModel=new a.Model({receiveNotReadNum:c?"("+c+")":"",draftNum:d?"("+d+")":"",sentNum:e?"("+e+")":"",mail:this.testee.email})},onShow:function(){this.showCatalog(),this.showList(),this.showDetail()},showCatalog:function(){this.emailCatalogView=new f({model:this.catalogModel}),this.emailCatalog.show(this.emailCatalogView);var a=this.emailStatusModel.get("activeTab")+"_li";this.emailCatalogView.$("."+a).addClass("active")},showList:function(){var b=this.emailStatusModel.get("activeTab"),c=this.emailListData[b].list;"receive"!=b&&(c=this.cloneList(c)),"draft"==b&&(c=c.sort(function(a,b){var c=a.sendDate.split(":")[0]+a.sendDate.split(":")[1],d=b.sendDate.split(":")[0]+b.sendDate.split(":")[1];return d-c}));var e=new a.Collection(c);c.length>0?(this.emailListView=new d({collection:e,activeMailId:this.emailStatusModel.get("activeMailId")}),this.emailList.show(this.emailListView),this.listenTo(this.emailListView,"activeEmail",this.activeEmail),this.listenTo(this.emailListView,"write:email",this.writeEmail)):(this.emailStatusModel.get("activeMailId")&&this.emailStatusModel.set("activeMailId",void 0),this.ui.emailList.html("<div class='no_list'><span>无内容</span></div>"))},showDetail:function(){var a=this;if(a.emailStatusModel.get("activeMailId")){var b=a.getActiveEmailDetail();b?(a.activeEmailModel.set(b),a.emailDetail.currentView?(a.emailDetail.currentView.model=a.activeEmailModel,a.emailDetail.currentView.render()):a.emailDetail.show(new e({model:a.activeEmailModel}))):this.ui.emailDetail.html('<span class="email_icon"></span>')}a.toggleOperation()},refreshList:function(){var b=this,c=this.emailStatusModel.get("activeTab");b.emailListData.activeTab=c;var e=b.emailListData[c].list;"receive"!=c&&(e=this.cloneList(e)),e.length>0?(this.emailListView=new d({collection:new a.Collection(e),activeMailId:this.emailStatusModel.get("activeMailId")}),this.emailList.show(this.emailListView),this.listenTo(this.emailListView,"activeEmail",this.activeEmail),this.listenTo(this.emailListView,"write:email",this.writeEmail)):(this.emailStatusModel.get("activeMailId")&&this.emailStatusModel.set("activeMailId",void 0),this.ui.emailList.html("<div class='no_list'><span>无内容</span></div>")),b.emailList.currentView.collection=new a.Collection(e),b.emailList.currentView.render()},catalogChange:function(a){var b,c=this,d=c.$(a.currentTarget),e=c.emailStatusModel.get("activeTab"),f=c.emailStatusModel.get("activeMailId"),g=d.find("span").attr("class");g!=e&&(c.$("."+e).parent().removeClass("active"),d.addClass("active"),c.emailCatalogActiveData[e]=f,b=c.emailCatalogActiveData[g],c.emailStatusModel.set("activeTab",g),c.emailStatusModel.set("activeMailId",b),c.setListViewActiveModel(b),c.recordReadEmailCondition(f,b,e,g))},recordReadEmailCondition:function(a,b,c,d){"sent"==d&&a?this.recordReadEmail(a,null,c,null):"sent"==c&&b?this.recordReadEmail(null,b,null,d):this.recordReadEmail(a,b,c,d)},recordReadEmail:function(a,b,c,d){var e={name:d,caseCode:b,operateType:"start"},f={name:c,caseCode:a,operateType:"close"};this.trigger("record:readEmail",e,f)},focusEmail:function(){var a=this.emailStatusModel.get("activeMailId"),b=this.emailStatusModel.get("activeTab");a?(this.emailList.currentView.focusEmail(a),this.emailListData.activeMailId=a,"receive"==b&&this.changeEmailStatus(null,null),this.refreshDeatil()):this.detailEmpty(),this.toggleOperation()},changeEmailStatus:function(a,b,c){var d=this.getActiveEmail(a,b);if(!d){var e=a+"中没有id="+b+"的邮件！";throw new Error(e)}d.status==this.status.NOTREAD?d.status=this.status.READED:c&&(d.status=c)},refreshDeatil:function(){var a=this,b=a.emailStatusModel.get("activeMailId");b&&(a.getActiveEmailDetail()?a.showDetail():a.requestEmailDetail())},requestEmailDetail:function(){var b=this,c=new a.$.Deferred,d=b.emailStatusModel.get("activeTab"),e=b.emailStatusModel.get("activeMailId");return a.app.request("email:getEmailDetail",{sectionId:b.getCntSessionData("sectionId"),id:e,flag:d,partType:this.options.partType}).done(function(a){return a.netError?(b.showNetErrorDialog(),!1):(b.setActiveEmailDetail(JSON.parse(a)),b.showDetail(),void c.resolve(a))}),c.promise()},getActiveEmail:function(a,c){var d,e;return a&&c?(d=a,e=c):(d=this.emailStatusModel.get("activeTab"),e=this.emailStatusModel.get("activeMailId")),b.findWhere(this.emailListData[d].list,{id:e})},getActiveEmailDetail:function(){var a=this.emailStatusModel.get("activeTab"),c=this.emailStatusModel.get("activeMailId");return b.findWhere(this.emailDetailListData[a],{id:c})},setActiveEmailDetail:function(a){var c=this.emailStatusModel.get("activeTab"),d=this.getActiveEmailDetail();a.content=decodeURIComponent(a.content),"receive"==a.flag&&(a.receiver=this.testee.name||""),a.sendDate=a.sendDate.substring(0,a.sendDate.lastIndexOf(":")),d?b.extend(this.getActiveEmailDetail(),a):this.emailDetailListData[c].push(a)},updateActiveEmailDetail:function(a,b){this.requestEmailDetail(a,b)},refreshCatalog:function(){var a=this;a.emailCatalog.currentView.model=a.catalogModel,a.emailCatalog.currentView.render();var b=this.emailStatusModel.get("activeTab")+"_li";this.emailCatalogView.$("."+b).addClass("active")},activeEmail:function(a,b){this.emailStatusModel.set("activeMailId",a),"receive"==this.emailStatusModel.get("activeTab")&&this.initCataModel(this.emailList.currentView.collection);var c=this.emailStatusModel.get("activeTab");"sent"!=c&&this.recordReadEmail(b,a,c,c)},toggleOperation:function(){"receive"==this.emailStatusModel.get("activeTab")&&this.emailStatusModel.get("activeMailId")?(this.$(".write_email_use").length||this.$(".write_email").addClass("write_email_use").removeClass("write_email_no"),this.$(".reply_email_use").length||this.$(".reply_email").addClass("reply_email_use").removeClass("reply_email_no"),this.$(".forward_email_use").length||this.$(".forward_email").addClass("forward_email_use").removeClass("forward_email_no")):(this.$(".reply_email").removeClass("reply_email_use").addClass("reply_email_no"),this.$(".forward_email").removeClass("forward_email_use").addClass("forward_email_no"),this.$(".write_email").removeClass("write_email_use").addClass("write_email_no"))},writeEmail:function(b){var c=this,d="draft"==b?c.buildEmailModel("write"):new a.Model({id:c.emailStatusModel.get("activeMailId"),content:"",sender:"",title:""}),e=function(a){var d="draft"==b?c.getActiveEmail().status-1:c.operateType.WRITE;c.debounceRequestRecordId(d,a)};d?e(d):c.requestEmailDetail().done(function(){e(c.buildEmailModel("write"))})},replyEmail:function(){var a=this.buildEmailModel("reply");this.debounceRequestRecordId(this.operateType.REPLY,a)},forwardEmail:function(){var a=this.buildEmailModel("forward");this.debounceRequestRecordId(this.operateType.FORWARD,a)},debounceRequestRecordId:b.debounce(function(a,b){this.requestRecordId(a,b)},200),requestRecordId:function(b,c){var d=this;if("off"==d.dialogSwitch){d.dialogSwitch="on";var e=d.emailStatusModel.get("activeMailId"),f={submitType:1,sectionId:d.getCntSessionData("sectionId"),partType:d.options.partType,email:JSON.stringify({title:"",urgency:"",importance:"",receiver:"",content:"",operateName:b,emailId:e,recordId:0,submitPart:0}),validationRule:JSON.stringify({title:!1,content:!1,receiver:!1}),isSentEmptyData:1};a.app.request("email:sentEmail",f).done(function(a){if(a.netError)return d.showNetErrorDialog(),!1;var e=JSON.parse(a);e.message.type==d.respType.SUCCESS&&(c.set("recordId",e.message.id),d.showEmailDialog(b,c))})}},buildEmailModel:function(b){var c={write:"",reply:"回复: ",forward:"转发: "},d=this.getActiveEmailDetail();if(!d)return null;var d=a._.clone(d);return d.sender="write"==b?d.receiver:d.sender,d.content="write"==b?d.content:this.templateEmailCont(d),d.title=c[b]+d.title,new a.Model(d)},showPreviewDialog:function(){var a=this;if("receive"==a.emailStatusModel.get("activeTab")){a.contPreviewView=new h({model:a.activeEmailModel});var b={content:a.contPreviewView,isDrag:!0,simpleModal:{modal:!0,minWidth:1e3,opacity:0}};a.previewDialogView=new i({config:b}),a.listenTo(a.contPreviewView,"preview:reply",a.replyEmail),a.listenTo(a.contPreviewView,"preview:forward",a.forwardEmail),a.listenTo(a.contPreviewView,"clsDig",a.closeDialogView)}},showEmailDialog:function(a,b){this.emailEditView=new g({submitModel:this.emailListData.submitMode,model:b,operateType:a});var c={content:this.emailEditView,isDrag:!0,simpleModal:{modal:!0,minWidth:1e3,opacity:0}};this.dialogView=new i({config:c}),this.listenTo(this.emailEditView,"saveEmail",this.saveEmail),this.listenTo(this.emailEditView,"sentEmail",this.sentEmail),this.listenTo(this.emailEditView,"maxDig",this.maxDig),this.listenTo(this.emailEditView,"clsDig",this.closeDialogView)},saveEmail:function(a,b){this.trigger("save:email",a,b)},sentEmail:function(a,b){this.trigger("sent:email",a,b),this.closeDialogView()},maxDig:function(a){this.trigger("max:dialog",a),this.closeDialogView()},receiveStatusNum:function(c){var d=b.countBy(c,function(b){var c=b instanceof a.Model?b.get("status"):b.status;return 1==c?"notRead":2==c?"readed":3==c?"reply":4==c?"forward":""});return d},detailEmpty:function(){this.emailDetail.close(),this.setListViewActiveModel(void 0),this.ui.emailDetail.html('<span class="email_icon"></span>')},setListViewActiveModel:function(a){this.emailList.currentView&&a!=this.emailList.currentView.activeModel.get("activeMailId")&&this.emailList.currentView.activeModel.set("activeMailId",a)},completeEmail:function(a){var b,c="确定",d="取消",e={title:" ",icon:"message",simpleModal:{modal:!0,maxWidth:450,opacity:0}};"complete"==a?("FirstEmail"==this.options.partType&&(b="是否确认关闭软件，回到桌面处理其他任务？",this.showCompleteEmailDialog(c,d,b,e,null,!0,!0)),"SecondEmail"==this.options.partType&&(b="是否确认关闭软件，结束邮件的处理？",this.showCompleteEmailDialog(c,d,b,e,"complete:secondEmail",!0,!0))):"uncomplete"==a?(b="您的邮件还没有处理完，是否仍然退出？",this.showCompleteEmailDialog(c,d,b,e)):"FirstEmail"==this.options.partType&&7==this.completeNumModel.get("completeNum")?(c="结束处理",d="继续处理",b="您的邮件已全部至少处理了一次，是否关闭软件，回到桌面处理其他任务？",this.showCompleteEmailDialog(c,d,b,e,null,!0,!1)):"SecondEmail"==this.options.partType&&4==this.completeNumModel.get("completeNum")&&(c="结束处理",d="继续处理",b="您的邮件已全部至少处理了一次，是否关闭软件，结束邮件的处理？",this.showCompleteEmailDialog(c,d,b,e,"complete:secondEmail",!0,!1))},showCompleteEmailDialog:function(c,d,e,f,g,h){var j=this,k=[{name:c,type:"blue_btn",id:"sure",eventName:"click:sure"},{name:d,type:"grey_btn",id:"canc",eventName:"click:cancle"}],l={content:e,icon:"email",buttons:k,isDrag:!0,moveDown:!0,simpleModal:{modal:!0,minWidth:350,opacity:0}};l=b.extend(l,f),this.completeEmailDialog&&this.completeEmailDialog.close(),this.completeEmailDialog=new i({config:l}),j.listenTo(this.completeEmailDialog,"click:sure",function(){if(h){var b={sectionId:j.getCntSessionData("sectionId"),partType:j.options.partType};a.app.request("email:submitNtpPart",b).done(function(a){return a.netError?(j.showNetErrorDialog(),!1):void j.closeView("closeView",g)})}else j.closeView("closeView",g);j.completeEmailDialog.close()}),j.listenTo(this.completeEmailDialog,"click:cancle",function(){j.completeEmailDialog.close()})},closeView:function(a,b){this.closeDialogView();var c=this.completeNumModel.get("completeNum");"closeView"==a?this.trigger("close:appEmail",b):"FirstEmail"==this.options.partType&&7>c||"SecondEmail"==this.options.partType&&4>c?this.completeEmail("uncomplete"):("FirstEmail"==this.options.partType&&7==c||"SecondEmail"==this.options.partType&&4==c)&&this.completeEmail("complete")},cloneList:function(a){var a=b.map(a,function(a){return a=b.clone(a),a.status=self.status.READED,a});return a},closeDialogView:function(){this.dialogView&&this.dialogView.close(),this.completeEmailDialog&&this.completeEmailDialog.close(),this.previewDialogView&&this.previewDialogView.close(),this.dialogSwitch="off"},showNetErrorDialog:function(){if(a.$(".net-error-dialog").length<1){var b=this,c=[{name:"刷新",type:"blue_btn",id:"sure",eventName:"click:sure"},{name:"取消",type:"grey_btn",id:"cancle",eventName:"click:cancle"}],d={title:"错误提示",content:"数据传输错误，请刷新重试或联系客服人员解决",icon:"sigh",buttons:c,isDrag:!0,moveDown:!0,simpleModal:{modal:!0,minWidth:350},dialogId:"net-error-dialog"},e=new i({config:d});b.listenTo(e,"click:cancle",function(){e.close()}),b.listenTo(e,"click:sure",function(){location.reload()})}}});return j}),define("views/quiz/email/progress-view",["talent","templates/quiz"],function(a,b){return a.Layout.extend({template:b["quiz/email/progress"],ui:{progressBar:".progress_bar",progressText:".progress_text",totalWidth:".progress_outline",progressRate:".progress_rate"},initialize:function(){this.model=new a.Model(this.model)},onShow:function(){var a=this;setTimeout(function(){if(!a.isClosed){a.ui.progressBar.addClass("loading_start");var b=a.ui.totalWidth.width();a.timeInterval=setInterval(function(){if(!a.isClosed){var c=a.ui.progressBar.width()/b;c=parseFloat(100*c).toFixed(0)+"%",a.ui.progressRate.text(c),"90%"==c&&a.stopProgress()}},100)}},500)},stopProgress:function(){clearInterval(this.timeInterval),this.endProgress()},endProgress:function(){var a=this;a.ui.progressBar.addClass("loading_end"),a.ui.progressText.text(a.model.get("endText")),a.ui.progressRate.text("100%"),setTimeout(function(){a.trigger("close:progress")},1e3)}})}),define("views/quiz/email/index-page-view",["talent","templates/quiz","timedialog","views/quiz/email/email-app-view","views/quiz/email/progress-view","views/common/plugins/dialog/bsdialog"],function(a,b,c,d,e,f){var g=a.Layout.extend({template:b["quiz/email/index-page"],regions:{content:".email_zone"},respType:{SUCCESS:null,ERROR:2},initialize:function(b){var c=this;this.options=b;var d={sectionId:c.getCntSessionData("sectionId"),partType:b.partType};a.app.request("email:getEmailList",d).done(function(a){if(a.netError)return c.showNetErrorDialog(),!1;var d=JSON.parse(a);c.totalTime=d.requireTimes-d.useTime,c.triggerMethod("showApp",d,b),c.maintainTime(d.submitMode.autoSubmit)})},onShowApp:function(a,b){this.showTimeDialog(a);var c={listData:a,parentOptions:b,getCntSessionData:this.getCntSessionData};this.emailAppView=new d(c),this.content.show(this.emailAppView),this.listenTo(this.emailAppView,"max:dialog",this.maxDig),this.listenTo(this.emailAppView,"save:email",this.saveEmail),this.listenTo(this.emailAppView,"sent:email",this.sentEmail),this.listenTo(this.emailAppView,"close:appEmail",this.closeView),this.listenTo(this.emailAppView,"record:readEmail",this.recordReadEmail)},maxDig:function(a){this.emailEditView=a,this.content.show(this.emailEditView),this.emailEditView.toggleSize(),this.listenTo(this.emailEditView,"minDig",this.minDig),this.listenTo(this.emailEditView,"clsDig",this.closeDig),this.listenTo(this.emailEditView,"saveEmail",this.saveEmail),this.listenTo(this.emailEditView,"sentEmail",this.sentEmail)},minDig:function(a){this.content.show(this.emailAppView),this.emailAppView.showEmailDialog(a.model.get("operateName"),a.model),this.emailEditView.close()},saveEmail:function(b,c){var d=this;a.app.request("email:sentEmail",d.bulidEmailResquestData("save",b,c)).done(function(a){if(a.netError)return d.showNetErrorDialog(),!1;var b=JSON.parse(a);if(b.message.type==d.respType.SUCCESS){if(1==c)return;var e=JSON.parse(b.message.message),f=e.id.split("||");e.id=f[0],e.orgId=f[1];var g=e.sendDate;e.sendDate=e.sendDate.substring(0,5),d.updateEmailListList("draft",b.message.id,e);var h;d.emailAppView.dialogView.isClosed||(h=d.emailAppView.dialogView.content.currentView,h.model.set("recordId",e.id),h.saveDraftSccuess(g)),d.content.currentView==d.emailAppView&&d.content.show(d.emailAppView)}})},sentEmail:function(b,c){var d=this;1!=c&&(this.progressDialog=this.showProgressDialog()),a.app.request("email:sentEmail",d.bulidEmailResquestData("sent",b,c)).done(function(a){if(a.netError)return d.showNetErrorDialog(),!1;var b=JSON.parse(a);if(b.message.type==d.respType.SUCCESS){if(1==c)return;var e=JSON.parse(b.message.message);d.emailAppView.completeNumModel.set({completeNum:e.completeNum}),d.timeDialog.changePro(e.completeNum,7),e.sendDate=e.sendDate.substring(0,5);var f=e.id.split("||");e.id=f[0],e.orgId=f[1],d.updateEmailListList("sent",e.id,e),d.content.show(d.emailAppView),d.progressAndShowDialogTimer=setTimeout(function(){1!=c&&d.progressDialog.close(),d.showSendDialog()},1500)}})},bulidEmailResquestData:function(a,b,c){var d,e=this,f={save:1,sent:2};c=1==c?1:0,"save"==a?d={title:!1,content:!1,receiver:!1}:"sent"==a&&(d={title:!1,content:!1,receiver:!0});var g={submitType:f[a],sectionId:e.getCntSessionData("sectionId"),partType:this.options.partType,email:JSON.stringify(b),validationRule:JSON.stringify(d),isSentEmptyData:0,isCutDown:c};return g},updateEmailListList:function(a,b,c){var d=this;d.emailAppView.emailListData[a].list||(d.emailAppView.emailListData[a].list=[]);var e=d.emailAppView.emailListData[a].list,f=_.pluck(e,"id");if(f.indexOf(b)<0?e.unshift(c):_.extend(_.findWhere(e,{id:b}),c),d.emailAppView.emailListData[a].total=e.length,"draft"==a&&d.emailAppView.updateActiveEmailDetail(a,b),"sent"==a){var g=d.emailAppView.getActiveEmail("draft",b),h=c.status;if(g){var i=d.emailAppView.emailListData.draft.list;d.emailAppView.emailListData.draft.list=_.filter(i,function(a){return a.id!=b}),d.emailAppView.emailListData.draft.total=d.emailAppView.emailListData.draft.list.length,"receive"!=d.emailAppView.emailStatusModel.get("activeTab")&&(d.emailAppView.emailListData.activeMailId=void 0),d.emailAppView.emailStatusModel.set("activeMailId",void 0),h=g.status}try{d.emailAppView.changeEmailStatus("receive",c.orgId,h)}catch(j){console.error(j.message)}}},showProgressDialog:function(){var a=new e({model:{progress_text:"邮件发送中...",endText:"发送成功！"}}),b=new f({config:{content:a,isDrag:!0,simpleModal:{modal:!1,minWidth:300},position:"right_bottom"}});return this.listenTo(a,"close:progress",function(){b.close()}),b},showSendDialog:function(){var a=this;a.sendDialog=new f({config:{content:"邮件发送成功",icon:"success",isDrag:!0,simpleModal:{modal:!1,minWidth:250},position:"right_bottom"}}),a.sendDialogTimer=setTimeout(function(){a.sendDialog.close()},500)},showTimeDialog:function(a){var b=this;this.timeDialog=new c({title:"剩余时间",showPro:!0,done:a.activeMailNum,total:"FirstEmail"==this.options.partType?7:4,countdown:a.requireTimes-a.useTime,totalTime:a.requireTimes,containment:"#bs_layout_container",isbreak:0==b.getCntSessionData("isBreak")?!1:!0,autoSubmit:!0,endTime:0}),this.timeDialog.show(),this.listenTo(this.timeDialog,"timeOver",function(){b.requestIsCompelete()})},maintainTime:function(a){var b=this;this.interval=setInterval(function(){b.autoSubmit()},1e3*a)},autoSubmit:function(){this.trigger("rememberPartTime"),this.emailAppView.emailEditView&&0==this.emailAppView.emailEditView.isClosed&&this.emailAppView.emailEditView.saveDraft()},requestIsCompelete:function(){var a,b,c=this;if(c.timeDialog.close(),c.emailAppView.completeEmailDialog&&c.emailAppView.completeEmailDialog.close(),c.emailAppView.dialogView&&(b=c.emailAppView.dialogView.isClosed),0==b){var d=c.emailAppView.dialogView.content.currentView;"FirstEmail"==c.options.partType&&d.saveDraft(!0),"SecondEmail"==c.options.partType&&(d.sentMail(!0),a="complete:secondEmail")}else{"SecondEmail"==c.options.partType&&(a="complete:secondEmail");var e={title:"",urgency:"",importance:"",receiver:"",content:"",operateName:"",emailId:"",recordId:0,submitPart:1};this.saveEmail(e,!0)}var g="";"FirstEmail"==c.options.partType&&(g="时间已到，系统将强制关闭邮件，回到桌面，请您继续处理其他工作"),"SecondEmail"==c.options.partType&&(g="时间已到，系统将强制关闭邮件，结束邮件处理");var h={title:" ",content:g,icon:"sigh",buttons:[{name:"确定",type:"blue_btn",id:"text",eventName:"click:sure"}],simpleModal:{modal:!1,minWidth:350}},i=new f({config:h});c.listenTo(i,"click:sure",function(){i.close(),c.closeView(a),clearTimeout(c.forceTimeouter)}),c.forceTimeouter=setTimeout(function(){i.close(),c.closeView(a)},5e3)},recordReadEmail:function(b,c){var d=this,e={sectionId:this.getCntSessionData("sectionId"),partType:this.options.partType};c.caseCode&&(c=_.extend(e,c),a.app.request("email:recordReadEmail",c).done(function(a){return a.netError?(d.showNetErrorDialog(),!1):void 0})),b.caseCode&&(b=_.extend(e,b),a.app.request("email:recordReadEmail",b).done(function(a){return a.netError?(d.showNetErrorDialog(),!1):void 0}))},closeDig:function(){this.content.show(this.emailAppView)},closeView:function(a){this.emailAppView.closeDialogView();var b=this.progressDialog?!this.progressDialog.isClosed:!1;b&&this.progressDialog.close(),this.timeDialog.close(),clearInterval(this.interval),this.trigger("closeSoftWare","email",a),this.close()},onClose:function(){this.progressDialog&&this.progressDialog.close(),this.sendDialog&&this.sendDialog.close(),clearTimeout(this.progressAndShowDialogTimer)},getCntSessionData:function(b){var c=this;try{return a.Context.getTemporaryData(b)}catch(d){if(a.$(".net-error-dialog").length<1){var e=[{name:"确定",type:"blue_btn",id:"sure",eventName:"click:sure"}],g={title:"错误提示",content:"获取数据失败，请重新登陆",icon:"sigh",buttons:e,isDrag:!0,moveDown:!0,simpleModal:{modal:!0,minWidth:350},dialogId:"net-error-dialog"};c.dialog=new f({config:g}),c.listenTo(c.dialog,"click:sure",function(){c.dialog.close(),a.app.execute("history:navigate","#quiz%2Flogin",!1)}),console.error(d.message)}}},showNetErrorDialog:function(){if(a.$(".net-error-dialog").length<1){var b=this,c=[{name:"刷新",type:"blue_btn",id:"sure",eventName:"click:sure"},{name:"取消",type:"grey_btn",id:"cancle",eventName:"click:cancle"}],d={title:"错误提示",content:"数据传输错误，请刷新重试或联系客服人员解决",icon:"sigh",buttons:c,isDrag:!0,moveDown:!0,simpleModal:{modal:!0,minWidth:350},dialogId:"net-error-dialog"},e=new f({config:d});b.listenTo(e,"click:cancle",function(){e.close()}),b.listenTo(e,"click:sure",function(){location.reload()})}}});return g}),define("views/quiz/ntp/task-item-view",["talent","templates/quiz"],function(a,b){return a.ItemView.extend({template:b["quiz/ntp/task-item"],events:function(){},initialize:function(){}})}),define("views/quiz/ntp/task-list-view",["talent","templates/quiz","views/quiz/ntp/task-item-view"],function(a,b,c){return a.CollectionView.extend({itemView:c,events:function(){var a={};return a["click .notice"]="activeTask",a},initialize:function(){},activeTask:function(a){var b=$(a.currentTarget),c=b.attr("task"),d=b.attr("id");this.trigger("showTask",d,c)}})}),define("views/common/plugins/wait/time-wait",["talent","templates/common","moment","views/common/plugins/dialog/bsdialog","countdown"],function(a,b,c,d,e){return a.Layout.extend({template:b["common/wait/time-wait"],className:"time-wait",ui:{desk:".time-wait-desk",lamp:".time-wait-lamp",backbone:".time-wait-backbone",screen:".time-wait-screen",keyboard:".time-wait-keyboard",cup:".time-wait-cup",mouse:".time-wait-mouse",btn:".wait-btn"},events:function(){var a={};return a["click .wait-btn"]="closeView",a},initialize:function(){},onRender:function(){var a=this;setTimeout(function(){a.showAnimate()},1e3)},onShow:function(){},showAnimate:function(){var a=this;setTimeout(function(){a.ui.desk.addClass("dis-show animated fadeInUp"),setTimeout(function(){a.ui.lamp.addClass("dis-show animated rotateInDownLeft"),setTimeout(function(){a.ui.backbone.addClass("dis-show animated bounceIn"),setTimeout(function(){a.ui.screen.addClass("dis-show animated bounceInDown"),setTimeout(function(){a.ui.keyboard.addClass("dis-show animated bounceInDown"),setTimeout(function(){a.ui.mouse.addClass("dis-show animated fadeInDown"),setTimeout(function(){a.ui.cup.addClass("dis-show animated fadeInDown"),setTimeout(function(){a._setCutUp(),a.ui.btn.show()},1e3)},500)},1e3)},1e3)},500)},1e3)},500)},0)},_setCutUp:function(){var a=this,b=a.$el.find(".use-timer");this.countDown=new e({node:b,countdown:this.options.maxTime,hideZero:!1,format:"mm:ss",minTime:this.options.minTime}),this.countDown.start(),b.on("over",function(){a.close(),a.trigger("autoFinishRest")})},closeView:function(a){var b=$(a.currentTarget);return b.hasClass("wait-btn-gray")?!1:void this.trigger("handFinishRest")},onClose:function(){}})}),define("views/quiz/ntp/task-catalog-view",["talent","templates/quiz","views/quiz/ntp/task-list-view","views/common/plugins/wait/time-wait"],function(a,b,c){return a.Layout.extend({template:b["quiz/ntp/task-catalog"],regions:{content:".notice_content"},events:function(){var a={};return a},initialize:function(a){this.taskList=a.taskList},onShow:function(){var b=_.map(this.taskList,function(a){return a=_.clone(a)});this.dealTaskListData(b),this.taskListView=new c({collection:new a.Collection(b)}),this.content.show(this.taskListView),this.listenTo(this.taskListView,"showTask",function(a,b){this.trigger("showTask",a,b)})},dealTaskListData:function(b){a._.each(b,function(a){a.requireTimes=parseFloat(a.requireTimes/60).toFixed(0),a.color=a.title.indexOf("天城")<0?"green":"blue",a.task=a.title.indexOf("天城")<0?"chenfang":"tiancheng"})}})}),define("views/quiz/ntp/hotel/task-introduce-view",["talent","templates/quiz","playvideo","countdown"],function(a,b,c){var d=a.Layout.extend({template:b["quiz/ntp/hotel/task-introduce"],regions:{video:".intro_video"},ui:{video:".intro_video",proBtn:".promise",countCon:".promise span",countEle:".promise span em"},events:function(){var a={};return a["click  .promise"]="goToDesk",a},initialize:function(){},onRender:function(){},onShow:function(){var a=this.ui.video;this.videoView=new c({width:a.width(),height:a.height(),videoSrc:this.options.videoUrl}),this.video.show(this.videoView)},goToDesk:function(b){var c=$(b.currentTarget);return c.hasClass("disabled")?!1:void a.app.execute("history:navigate","#quiz/appraise",!0)},onClose:function(){}});return d}),function(a){function b(d,e,f,g){var h,i=a("<table cellpadding='0' cellspacing='0' border='0'/>"),j=a("<tbody/>"),k=a("<tr/>").addClass("node-cells"),l=a("<td/>").addClass("node-cell").attr("colspan",2),m=d.children("ul:first").children("li");m.length>1&&l.attr("colspan",2*m.length);var n=d.clone().children("ul,li").remove().end().html();if(c++,d.data("tree-node",c),h=a("<div>").addClass("node").data("tree-node",c).append(n),m.length>0&&g.isClick&&h.click(function(){var b=a(this),c=b.closest("tr");c.hasClass("contracted")?(b.css("cursor","n-resize"),c.removeClass("contracted").addClass("expanded"),c.nextAll("tr").css("visibility",""),d.removeClass("collapsed")):(b.css("cursor","s-resize"),c.removeClass("expanded").addClass("contracted"),c.nextAll("tr").css("visibility","hidden"),d.addClass("collapsed"))}),l.append(h),k.append(l),j.append(k),m.length>0){if(h.css("cursor","n-resize"),-1==g.depth||f+1<g.depth){var o=a("<tr/>"),p=a("<td/>").attr("colspan",2*m.length);o.append(p),$downLine=a("<div></div>").addClass("line down"),p.append($downLine),j.append(o);var q=a("<tr/>");m.each(function(){var b=a("<td>&nbsp;</td>").addClass("line left top"),c=a("<td>&nbsp;</td>").addClass("line right top");q.append(b).append(c)}),q.find("td:first").removeClass("top").end().find("td:last").removeClass("top"),j.append(q);var r=a("<tr/>");m.each(function(){var c=a("<td class='node-container'/>");c.attr("colspan",2),b(a(this),c,f+1,g),r.append(c)})}j.append(r)}if(void 0!=d.attr("class")){var s=d.attr("class").split(/\s+/);a.each(s,function(a,b){"collapsed"==b?(k.nextAll("tr").css("visibility","hidden"),k.removeClass("expanded"),k.addClass("contracted"),h.css("cursor","s-resize")):h.addClass(b)})}i.append(j),e.append(i),h.children("a").click(function(a){console.log(a),a.stopPropagation()})}a.fn.jOrgChart=function(c){var d=a.extend({},a.fn.jOrgChart.defaults,c),e=a(d.chartElement);$this=a(this);var f=a("<div class='"+d.chartClass+"'/>");$this.is("ul")?b($this.find("li:first"),f,0,d):$this.is("li")&&b($this,f,0,d),e.append(f),d.dragAndDrop&&(a("div.node").draggable({cursor:"move",distance:40,helper:"clone",opacity:.8,revert:"invalid",revertDuration:100,snap:"div.node.expanded",snapMode:"inner",stack:"div.node"}),a("div.node").droppable({accept:".node",activeClass:"drag-active",hoverClass:"drop-hover"}),a("div.node").bind("dragstart",function(){var b=a(this);b.parentsUntil(".node-container").find("*").filter(".node").droppable("disable")}),a("div.node").bind("dragstop",function(){a(d.chartElement).children().remove(),$this.jOrgChart(d)}),a("div.node").bind("drop",function(b,c){var d=a(this).data("tree-node"),e=$this.find("li").filter(function(){return a(this).data("tree-node")===d}),f=e.children("ul"),g=c.draggable.data("tree-node"),h=$this.find("li").filter(function(){return a(this).data("tree-node")===g}),i=h.parent("ul");f.length>0?f.append(h):(e.append("<ul></ul>"),e.children("ul").append(h)),0===i.children().length&&i.remove()}))},a.fn.jOrgChart.defaults={chartElement:"body",depth:-1,chartClass:"jOrgChart",dragAndDrop:!1,isClick:!0};var c=0}(jQuery),define("jorgchart",function(){}),define("views/quiz/ntp/hotel/customer-center-view",["talent","templates/quiz","views/common/plugins/dialog/bsdialog","jquery.ui","jorgchart"],function(a,b,c){var d=a.ItemView.extend({template:b["quiz/ntp/hotel/customer-center"],ui:{container:".org_container"},respType:{SUCCESS:null,ERROR:2},events:function(){var a={};return a["click .node img"]="showInfo",a["click .jOrgChart_titleSpan"]="showInfoPro",a},initialize:function(a){this.options=a.part,this.getCntSessionData=a.getCntSessionData},onShow:function(){var b=this;1==b.model.get("temp").length&&(b.model.get("temp")[0].jOrgChart({chartElement:b.$(".org_container1"),nodeClassName:"node",isClick:!1}),b.$(".org_container>div").css({width:"100%",paddingLeft:"0"})),3==b.model.get("temp").length&&a._.each(b.model.get("temp"),function(a,c){!function(){a.jOrgChart({chartElement:b.$(".org_container"+c),nodeClassName:"node",isClick:!1}),b.$(".org_container>div").css({display:"table-cell"})}()})},showInfoPro:function(a){var b=$(a.currentTarget).parent().find("img");this.showInfo(null,b)},showInfo:function(b,c){var d=this,e=b?a.$(b.target):c,f=e.attr("id"),g=e.parent().find(".jOrgChart_name").text(),h={SectionId:this.getCntSessionData("sectionId"),partType:this.options.partType,name:g+"_0",caseCode:this.options.taskId,operateType:this.options.operateType};a.app.request("ntp:recordInterviewTime",h).done(function(a){if(a.netError)return d.showNetErrorDialog(),!1;var b=JSON.parse(a);if(b.type==d.respType.SUCCESS){var c=b.id;d.trigger("info:show",f,g,c)}})},showNetErrorDialog:function(){if(a.$(".net-error-dialog").length<1){var b=this,d=[{name:"刷新",type:"blue_btn",id:"sure",eventName:"click:sure"},{name:"取消",type:"grey_btn",id:"cancle",eventName:"click:cancle"}],e={title:"错误提示",content:"数据传输错误，请刷新重试或联系客服人员解决。",icon:"sigh",buttons:d,isDrag:!0,moveDown:!0,simpleModal:{modal:!0,minWidth:350},dialogId:"net-error-dialog"},f=new c({config:e});b.listenTo(f,"click:cancle",function(){f.close()}),b.listenTo(f,"click:sure",function(){location.reload()})}}});return d}),define("views/quiz/ntp/hotel/task-info-view",["talent","templates/quiz","views/common/plugins/dialog/bsdialog"],function(a,b,c){var d=a.ItemView.extend({template:b["quiz/ntp/hotel/task-info"],events:function(){var a={};return a["click .task_info_close"]="closeView",a},initialize:function(a){this.options=a.part,this.getCntSessionData=a.getCntSessionData},closeView:function(){this.trigger("taskInfo:close"),this.closeInfo()},onClose:function(){this.closeInfo()
},closeInfo:function(){var b={SectionId:this.getCntSessionData("sectionId"),partType:this.options.partType,name:this.options.name+"_"+this.options.recordId,caseCode:this.options.taskId,operateType:"close"};a.app.request("ntp:recordInterviewTime",b).done(function(a){return a.netError?(self.showNetErrorDialog(),!1):void 0})},showNetErrorDialog:function(){if(a.$(".net-error-dialog").length<1){var b=this,d=[{name:"刷新",type:"blue_btn",id:"sure",eventName:"click:sure"},{name:"取消",type:"grey_btn",id:"cancle",eventName:"click:cancle"}],e={title:"错误提示",content:"数据传输错误，请刷新重试或联系客服人员解决。",icon:"sigh",buttons:d,isDrag:!0,moveDown:!0,simpleModal:{modal:!0,minWidth:350},dialogId:"net-error-dialog"},f=new c({config:e});b.listenTo(f,"click:cancle",function(){f.close()}),b.listenTo(f,"click:sure",function(){location.reload()})}}});return d}),define("views/quiz/ntp/hotel/task-material-view",["talent","templates/quiz","views/quiz/ntp/hotel/customer-center-view","views/quiz/ntp/hotel/task-info-view"],function(a,b,c,d){var e=a.Layout.extend({template:b["quiz/ntp/hotel/task-material"],regions:{content:".customer_center",footer:".footer",hideInfo:".hideInfo"},initialize:function(a){this.options=a.part,this.getCntSessionData=a.getCntSessionData},onShow:function(){this.bulidOrganizationData(),this.customerView=new c({part:this.options,getCntSessionData:this.getCntSessionData}),this.customerView.model=this.model,this.listenTo(this.customerView,"info:show",this.showInfo),this.content.show(this.customerView)},bulidOrganizationData:function(){var a=this,b=this.model.get("organization");this.organInfo=[],a.findOrganizationData(b)},findOrganizationData:function(b){var c=this;a._.each(b,function(a){c.organInfo[a.id]=a.info,a.children.length>0&&c.findOrganizationData(a.children)})},events:function(){var a={};return a["click .task_nav_bar ul li"]="tab_style",a},showInfo:function(b,c,e){var f=a._.extend({},this.options,{name:c,recordId:e});this.taskInfoView=new d({part:f,getCntSessionData:this.getCntSessionData}),this.taskInfoView.model=new a.Model({info:this.organInfo[b]}),this.listenTo(this.taskInfoView,"taskInfo:close",this.infoClose),this.hideInfo.show(this.taskInfoView),a.$(".hideInfo").css("display","block"),a.$(".customer_info").css("display","none")},tab_style:function(b){a.$(b.target).addClass("click_style").siblings().removeClass("click_style");var c=a.$(b.target).index();"block"==a.$(".hideInfo").css("display")&&this.taskInfoView.closeView(),this.trigger("show:orgTree",c)},infoClose:function(){a.$(".hideInfo").css("display","none"),a.$(".customer_info").css("display","block")}});return e}),define("views/quiz/ntp/hotel/task-problems-view",["talent","templates/quiz"],function(a,b){var c=a.ItemView.extend({template:b["quiz/ntp/hotel/task-problems"],ui:{answer:".font_area",num:".font_num",textarea:"textarea"},events:function(){var a={};return a["keyup .font_area"]="answerInfo",a["blur textarea"]="blurTextareaHandler",a["focus textarea"]="focusTextareaHandler",a},initialize:function(){},onShow:function(){var b=this,c=this.model.get("questionList");a._.each(c,function(a,c){var d=$.trim(a.answer).length;b.ui.num[c].innerHTML="当前已输入"+d+"字"})},answerInfo:function(a){var b=$(a.currentTarget),c=b.val().trim().length;b.next().text("当前已输入"+c+"字")},blurTextareaHandler:function(a){var b=$(a.currentTarget),c=$.trim(b.val());!c&&b.hasClass("answer_error")?b.css({borderColor:"#ff0066"}):b.removeClass("answer_error")},focusTextareaHandler:function(a){{var b=$(a.currentTarget);$.trim(b.val())}b.hasClass("answer_error")&&b.css({borderColor:"#5786e4"})},getAnswer:function(){var b=this.ui.answer,c=[];return a._.each(b,function(a){a=$(a);var b={questionId:a.attr("id"),answer:a.val().trim()};c.push(b)}),c}});return c}),define("views/common/plugins/treeframe/tree-framework",["talent","templates/quiz"],function(a,b){return a.ItemView.extend({template:function(){},initialize:function(a){this.frameTemplate=b[a.tempUrl]},buildFrame:function(b){var c=this,d=[];return a._.each(b,function(a){d.push($(c.buildHtml([a])))}),d},buildHtml:function(b){var c=this,d="<ul>";return a._.each(b,function(a){d+=c.buildItemFrame(a),a.children.length>0&&(d+=c.buildHtml(a.children)),d+="</li>"}),d+="</ul>"},buildItemFrame:function(b){return b instanceof a.Model&&(b=b.attributes),this.frameTemplate(b)}})}),define("views/quiz/ntp/hotel/index-page-view",["talent","templates/quiz","timedialog","views/quiz/ntp/hotel/task-introduce-view","views/quiz/ntp/hotel/task-material-view","views/quiz/ntp/hotel/task-problems-view","views/common/plugins/treeframe/tree-framework","views/common/plugins/dialog/bsdialog"],function(a,b,c,d,e,f,g,h){var i=a.Layout.extend({template:b["quiz/ntp/hotel/index-page"],regions:{topContainer:".top_container",centerContainer:".center_container",bottomContainer:".bottom_container"},events:function(){var a={};return a["click .btn_manage span"]="saveAll",a},initialize:function(a){this.taskDetail=a.taskDetail,this.ntpFW=new g({tempUrl:"quiz/ntp/hotel/ntp-framework"}),this.getCntSessionData=this.options.getCntSessionData,this.options.part.autoSubmit>0&&this.autoSaveAnswer()},onShow:function(){this.showTimeDialog(),this.taskIntroduceView=new d({videoUrl:this.taskDetail.videoUrl,getCntSessionData:this.getCntSessionData}),this.topContainer.show(this.taskIntroduceView);var b=new a.Model({temp:this.getData(),organization:this.taskDetail.organization});this.taskMaterialView=new e({part:this.options.part,getCntSessionData:this.getCntSessionData}),this.taskMaterialView.model=b,this.centerContainer.show(this.taskMaterialView),this.listenTo(this.taskMaterialView,"showInfo",this.infoShow),this.listenTo(this.taskMaterialView,"show:orgTree",this.toggleView),this.taskProblemView=new f({model:new a.Model({questionList:this.taskDetail.questionList})}),this.bottomContainer.show(this.taskProblemView)},getData:function(a){var b;return a=void 0==a?0:a,0==a&&(b=[this.taskDetail.organization[0]]),1==a&&(b=[this.taskDetail.organization[1],this.taskDetail.organization[2],this.taskDetail.organization[3]]),2==a&&(b=[this.taskDetail.organization[4]]),this.ntpFW.buildFrame(b)},saveAll:function(a,b,c,d,e){var f=this;if(a){$(a.currentTarget)}var g,i={save:1,submit:2};if(a){var j=$(a.currentTarget);g=j.attr("class").indexOf("save")<0?i.submit:i.save}g=b?b:g;var k=f.taskProblemView.getAnswer();if(e||g==i.save||g==i.submit&&f.couldSubmit(k))f.trigger("saveTask",k,g,c,d,e);else{var l=!0,m={type:"common",title:" ",content:"<div class='tip_dialog'><span></span>您的作答没有全部完成 , 点击确定将完成提交</div>",buttons:[{name:"确定",id:"tip_sure",type:"tip_sure",eventName:"tipSure"},{name:"取消",id:"tip_cancle",type:"tip_cancle",eventName:"tipCancle"}],simpleModal:{modal:!1,minWidth:438},isDrag:!1,moveDown:!1,icon:"common"};f.dialogView&&(l=f.dialogView.isClosed),l&&(f.dialogView=new h({config:m}),f.listenTo(f.dialogView,"tipSure",function(){f.trigger("saveTask",k,g,c,!0),f.dialogView.close(),setTimeout(function(){f.close()},1900)}),f.listenTo(f.dialogView,"tipCancle",function(){f.dialogView.close(),f.tipAnswer()}))}},couldSubmit:function(a){if(a.length<2)return!1;for(var b=0;2>b;b++){var c=a[b];if(0==c.answer.length)return!1}return!0},tipAnswer:function(){var a=this.taskProblemView.getAnswer();_.each(a,function(a){a.answer||$("#"+a.questionId).addClass("answer_error")})},autoSaveAnswer:function(){var a=this,b=a.options.part.autoSubmit;this.autoSaveTime=setTimeout(function(){a.saveAll(null,1,!1,!1),setTimeout(arguments.callee,1e3*b)},1e3*b)},toggleView:function(b){this.taskMaterialView.model.set("temp",this.getData(b)),this.centerContainer.show(this.taskMaterialView),a.$(".task_nav_bar ul li").eq(b).addClass("click_style").siblings().removeClass("click_style")},showTimeDialog:function(){var a=this;a.timeDialog=new c({title:"剩余时间",showPro:!1,countdown:a.taskDetail.requireTimes-a.taskDetail.useTime,totalTime:a.taskDetail.requireTimes,containment:"#bs_layout_container",isbreak:1==a.getCntSessionData("isBreak")?!0:!1,autoSubmit:a.options.part.autoSubmit>0?!0:!1,endTime:0}),a.timeDialog.show(),a.listenTo(a.timeDialog,"timeOver",function(){a.saveAll(null,2,!0,!0,!0)})},onClose:function(){clearTimeout(this.autoSaveTime),this.timeDialog.close(),this.dialogView&&this.dialogView.close()}});return i}),define("views/common/plugins/chart/bschart",["talent","moment"],function(a){var b=a.ItemView.extend({template:a._.template([""].join("")),className:"chart_container",defaults:{totalWidth:"500",totalScore:"5",scores:[{color:"#fea383",score:"3.5",height:"10"},{color:"#bce268",score:"3.8",height:"10"},{color:"#5ba8ee",score:"3.4",height:"10"}]},ui:{},events:function(){var a={};return a},initialize:function(b){this.options=a._.extend({},this.defaults,b)},_organizeDate:function(){a._.each(this.options.scores,function(a){var b=(a.score/this.options.totalScore*this.options.totalWidth).toFixed(0),c=a.height,d='<div style="width:'+b+"px;height:"+c+"px;background-color:"+a.color+';"></div>';this.$el.append(d)}.bind(this))},onRender:function(){},onShow:function(){this._organizeDate()},onClose:function(){}});return b}),define("views/quiz/ntp/talent/job-page-view",["talent","templates/quiz","$.cookie","views/common/plugins/chart/bschart"],function(a,b,c,d){var e=a.ItemView.extend({template:b["quiz/ntp/talent/job-employ-page"],ui:{},events:function(){var a={};return a["click .activity_close"]="closeSoft",a},initialize:function(){},onRender:function(){},onShow:function(){},onClose:function(){}}),f=a.ItemView.extend({template:b["quiz/ntp/talent/job-performance-page"],ui:{},events:function(){var a={};return a["click .activity_close"]="closeSoft",a},initialize:function(){},onRender:function(){},onShow:function(){},onClose:function(){}}),g=a.ItemView.extend({template:b["quiz/ntp/talent/job-example-page"],ui:{},events:function(){var a={};return a["click .activity_close"]="closeSoft",a},initialize:function(){},onRender:function(){},onShow:function(){},onClose:function(){}}),h=a.Layout.extend({template:b["quiz/ntp/talent/job-feedback-page"],regions:{charts1:"table tr:nth-child(2) td:nth-child(2) div",charts2:"table tr:nth-child(3) td:nth-child(2) div",charts3:"table tr:nth-child(4) td:nth-child(2) div",charts4:"table tr:nth-child(5) td:nth-child(2) div",charts5:"table tr:nth-child(6) td:nth-child(2) div",charts6:"table tr:nth-child(7) td:nth-child(2) div",charts7:"table tr:nth-child(8) td:nth-child(2) div"},ui:{charts1:"table tr:nth-child(2) td:nth-child(2) div"},events:function(){var a={};return a["click .activity_close"]="closeSoft",a},initialize:function(){},onRender:function(){},onShow:function(){var a=this;this._showCharts(),$(window).bind("resize",function(){a._showCharts()})},_showCharts:function(){var a=this.ui.charts1.width();this.charts1.show(new d({totalWidth:a,totalScore:"5",scores:[{color:"#fea383",score:"2.5",height:"10"},{color:"#bce268",score:"2.8",height:"10"},{color:"#5ba8ee",score:"3",height:"10"}]})),this.charts2.show(new d({totalWidth:a,totalScore:"5",scores:[{color:"#fea383",score:"2",height:"10"},{color:"#bce268",score:"2.8",height:"10"},{color:"#5ba8ee",score:"1.8",height:"10"}]})),this.charts3.show(new d({totalWidth:a,totalScore:"5",scores:[{color:"#fea383",score:"2",height:"10"},{color:"#bce268",score:"2.8",height:"10"},{color:"#5ba8ee",score:"2.3",height:"10"}]})),this.charts4.show(new d({totalWidth:a,totalScore:"5",scores:[{color:"#fea383",score:"2.2",height:"10"},{color:"#bce268",score:"2.6",height:"10"},{color:"#5ba8ee",score:"1.8",height:"10"}]})),this.charts5.show(new d({totalWidth:a,totalScore:"5",scores:[{color:"#fea383",score:"2.2",height:"10"},{color:"#bce268",score:"2.6",height:"10"},{color:"#5ba8ee",score:"1.8",height:"10"}]})),this.charts6.show(new d({totalWidth:a,totalScore:"5",scores:[{color:"#fea383",score:"2.3",height:"10"},{color:"#bce268",score:"2.6",height:"10"},{color:"#5ba8ee",score:"1.8",height:"10"}]})),this.charts7.show(new d({totalWidth:a,totalScore:"5",scores:[{color:"#fea383",score:"2.6",height:"10"},{color:"#bce268",score:"2.6",height:"10"},{color:"#5ba8ee",score:"2.9",height:"10"}]}))},onClose:function(){$(window).unbind("resize")}}),i=a.Layout.extend({template:b["quiz/ntp/talent/job-page"],regions:{jobInfo:".talent_job_info",feedBack:".talent_360_con"},ui:{tabs:".talent_job_tab span"},events:function(){var a={};return a["click "+this.ui.tabs]="changeTab",a},initialize:function(){this.regionConfig={employ:new e({model:this.model}),performance:new f({model:this.model}),example:new g}},onRender:function(){},onShow:function(){this.jobInfo.show(this.regionConfig.employ),this.feedBack.show(new h)},changeTab:function(a){var b=$(a.currentTarget),c=b.attr("data-flag");this.ui.tabs.removeClass("talent_active"),b.addClass("talent_active"),this.jobInfo.show(this.regionConfig[c])},onClose:function(){}});return i}),define("views/quiz/ntp/talent/question-page-view",["talent","templates/quiz"],function(a,b){var c=a.ItemView.extend({template:b["quiz/ntp/talent/list-item-page"],itemViewContainer:"li",ui:{textarea:"textarea",textNum:".talent_qus_num .talent_qus_txt"},events:function(){var a={};return a["input textarea"]="changeTextNum",a["blur textarea"]="blurTextareaHandler",a["focus textarea"]="focusTextareaHandler",a},initialize:function(){},onRender:function(){},onShow:function(){var a=this;this.ui.textNum.text($.trim(a.model.get("answer")).length)},changeTextNum:function(a){var b=$(a.currentTarget),c=$.trim(b.val()),d=0==c.length?0:c.length;this.ui.textNum.text(d),this.model.set("answer",c),this.trigger("change:answer")},blurTextareaHandler:function(a){var b=$(a.currentTarget),c=$.trim(b.val());!c&&b.hasClass("answer_error")?b.css({borderColor:"#ff0066"}):b.removeClass("answer_error")},focusTextareaHandler:function(a){{var b=$(a.currentTarget);$.trim(b.val())}b.hasClass("answer_error")&&b.css({borderColor:"#5786e4"})},onClose:function(){}}),d=a.CompositeView.extend({template:a._.template(["<ul></ul>"].join("")),itemViewContainer:"ul",itemView:c,ui:{},events:function(){var a={};return a["click .activity_close"]="closeSoft",a},initialize:function(){this.on("itemview:change:answer",this.onChangeAnswer,this)},onRender:function(){},onShow:function(){},onChangeAnswer:function(a){this.trigger("changeAnswer",a.model)},onClose:function(){}});return d}),define("views/quiz/ntp/talent/index-page-view",["talent","templates/quiz","$.cookie","timedialog","views/quiz/ntp/talent/job-page-view","views/quiz/ntp/talent/question-page-view","views/common/plugins/dialog/bsdialog"],function(a,b,c,d,e,f,g){var h=a.Layout.extend({template:b["quiz/ntp/talent/index-page"],className:"npptal_container",regions:{job:".talent_doc_job",quesiton:".talent_ques"},ui:{},events:function(){var a={};return a["click .talent_btns span:nth-child(1)"]="saveAnswer",a["click .talent_btns span:nth-child(2)"]="subAnswer",a},initialize:function(){this.answerCollect=new a.Collection(this.model.get("questionList")),this.getCntSessionData=this.options.getCntSessionData,this.options.part.autoSubmit>0&&this.autoSaveAnswer()},onRender:function(){},onShow:function(){this.showTimeDialog(),this.questionPageView=new f({collection:this.answerCollect}),this.jobPageView=new e({model:new a.Model({time:this.model.get("cfInfos"),feedbackTime:this.model.get("feedbackTime")})}),this.job.show(this.jobPageView),this.quesiton.show(this.questionPageView),this.listenTo(this.questionPageView,"changeAnswer",this.setSaveAnswer.bind(this))},showTimeDialog:function(){var a=this;this.timeDialog=new d({title:"剩余时间",showPro:!1,countdown:this.model.get("requireTimes")-this.model.get("useTime"),totalTime:this.model.get("requireTimes"),containment:"#bs_layout_container",isbreak:1==this.getCntSessionData("isBreak")?!0:!1,autoSubmit:this.options.part.autoSubmit>0?!0:!1,endTime:0}),this.timeDialog.show(),this.listenTo(this.timeDialog,"timeOver",function(){a.timeDialog.close(),a.saveAll(null,2,!0,!0,!0)})},setSaveAnswer:function(b){this.answerCollect=new a.Collection(this.model.get("questionList")),this.answerCollect.set(b)},getQuestion:function(){var b=this.answerCollect.toJSON(),c=[];return a._.each(b,function(a){var b={};b.questionId=a.id,b.answer=a.answer,c.push(b)}),c},saveAnswer:function(a){$(a.currentTarget);this.saveAll(null,1,!0,!1)},subAnswer:function(a){var b=($(a.currentTarget),this),c=this.getQuestion();if(this.couldSubmit(c))b.saveAll(null,2,!0,!0);else{var d=!0,e={type:"common",title:"  ",content:"<div class='tip_dialog'><span></span>您的作答没有全部完成 , 点击确定将完成提交</div>",buttons:[{name:"确定",id:"tip_sure",type:"tip_sure",eventName:"tipSure"},{name:"取消",id:"tip_cancle",type:"tip_cancle",eventName:"tipCancle"}],simpleModal:{modal:!1,minWidth:438},isDrag:!1,moveDown:!1,icon:"common"};b.dialogView&&(d=b.dialogView.isClosed),d&&(b.dialogView=new g({config:e}),b.listenTo(b.dialogView,"tipSure",function(){b.saveAll(null,2,!0,!0),b.dialogView.close(),setTimeout(function(){b.close()},1900)}),b.listenTo(b.dialogView,"tipCancle",function(){b.dialogView.close(),b.tipAnswer()}))}},couldSubmit:function(a){for(var b=0;b<a.length;b++){var c=a[b];if(0==c.answer.length)return!1}return!0},tipAnswer:function(){var a=this.getQuestion();_.each(a,function(a){a.answer||$("#"+a.questionId).addClass("answer_error")})},saveAll:function(a,b,c,d,e){this.trigger("saveTask",this.getQuestion(),b,c,d,e)},autoSaveAnswer:function(){var a=this,b=a.options.part.autoSubmit;this.autoSaveTime=setTimeout(function(){a.saveAll(null,1,!1),setTimeout(arguments.callee,1e3*b)},1e3*b)},onClose:function(){clearTimeout(this.autoSaveTime),this.timeDialog.close(),this.dialogView&&this.dialogView.close()}});return h}),define("views/quiz/ntp/index-page-view",["talent","templates/quiz","views/quiz/ntp/task-catalog-view","views/quiz/ntp/hotel/index-page-view","views/quiz/ntp/talent/index-page-view","timedialog","views/common/plugins/dialog/bsdialog"],function(a,b,c,d,e,f,g){var h=a.Layout.extend({template:b["quiz/ntp/index-page"],events:function(){var a={};return a["click .close_big"]="closeView",a},regions:{content:".ntp_content"},initialize:function(){var b=this;this._getData(function(c){return c.netError?(b.showNetErrorDialog(),!1):(b.NTPdata=JSON.parse(c),b.maintainTime(b.NTPdata.submitMode.autoSubmit),b.triggerMethod("showNtp",b.NTPdata),void(b.options=a._.extend({},b.options,b.NTPdata.submitMode)))});var c=this.getCntSessionData("testee"),d=$.cookie("UserPhotoPath")||JSON.parse(c).avatar;d=d.length>0?d:this.getLocalAvatar(c),c=a._.extend({},JSON.parse(c),{avatar:d}),this.model=new a.Model(c)},_getData:function(b){var c={sectionId:this.getCntSessionData("sectionId"),partType:this.options.partType};a.app.request("ntp:getTaskList",c).done(b),this.taskDetailMap={}},getLocalAvatar:function(b){this.model.set("name",JSON.parse(b).name);var c;return c=a.Context.getStaticUrl(0==JSON.parse(b).sex?"images/autophoto/lady-circle.png":"images/autophoto/boy-circle.png")},onShowNtp:function(){this.taskCataView=new c({taskList:this.NTPdata.taskList}),this.content.show(this.taskCataView),this.listenTo(this.taskCataView,"showTask",this.showTask)},showTask:function(b,c){var d=this;d.taskDetailMap[b]=d.NTPdata.taskDetail,d.taskDetailMap[b]?d.triggerMethod("showTaskPage",b,c):a.app.request("ntp:getTaskDetail",{SectionId:d.getCntSessionData("sectionId"),taskId:b}).done(function(a){if(a.netError)return d.showNetErrorDialog(),!1;var e=JSON.parse(a);d.taskDetailMap[b]=e,d.triggerMethod("showTaskPage",b,c)})},onShowTaskPage:function(b,c){var f=this,g=f.taskDetailMap[b],h=a._.extend({},this.options,{taskId:b});"tiancheng"==c&&(f.beforeAndAfterShowRequest(b,'[{"questionId":"'+b+'_0","answer":""},{"questionId":"'+b+'_1","answer":""}]'),f.hotelPageView=new d({part:h,taskDetail:g,getCntSessionData:f.getCntSessionData}),f.listenTo(f.hotelPageView,"saveTask",function(a,c,d,e,g){f.beforeSaveTask(a,c,d,b,e,g)}),f.contentPageView=f.hotelPageView),"chenfang"==c&&(f.beforeAndAfterShowRequest(b,'[{"questionId":"'+b+'_1","answer":""}]'),f.talentPageView=new e({part:h,model:new a.Model(g),getCntSessionData:f.getCntSessionData}),f.contentPageView=f.talentPageView,f.listenTo(f.talentPageView,"saveTask",function(a,c,d,e,g){f.beforeSaveTask(a,c,d,b,e,g)})),f.content.show(f.contentPageView)},beforeAndAfterShowRequest:function(b,c){a.app.request("ntp:saveAnswer",{sectionId:this.getCntSessionData("sectionId"),submitType:1,partType:this.options.partType,taskId:b,questionList:c,isCutDown:0,isSentEmptyData:1}).done(function(a){return a.netError?(self.showNetErrorDialog(),!1):void 0})},beforeSaveTask:function(a,b,c,d,e,f){1==b&&this.debounceSaveTask(a,b,c,d,e,f),2==b&&this.debounceSubmitTask(a,b,c,d,e,f)},debounceSaveTask:_.debounce(function(a,b,c,d,e,f){this.saveTask(a,b,c,d,e,f)},300),debounceSubmitTask:_.debounce(function(a,b,c,d,e,f){this.saveTask(a,b,c,d,e,f)},1e3),saveTask:function(b,c,d,e,f,g){var h=this;g=1==g?1:0;var i={sectionId:h.getCntSessionData("sectionId"),submitType:c,partType:h.options.partType,taskId:e,questionList:JSON.stringify(b),isCutDown:g,isSentEmptyData:0};a.app.request("ntp:saveAnswer",i).done(function(a){if(a.netError)return h.showNetErrorDialog(),!1;var b=JSON.parse(a);if(null==b.message.type){var e=0;if(0!=d){var f=2==c?"提交":"保存";h.showSendDialog(f),e+=1500}if(g){var i="",j=5e3;2==h.taskCataView.taskList.length&&(i="时间已到，结果已被强制提交到系统，请您继续完成另一内部任务"),1==h.taskCataView.taskList.length&&(i="时间已到，结果已被强制提交到系统"),setTimeout(function(){h.showForceSentDialog(i,j,c)},e),e+=5e3}h.completeTimeouter=setTimeout(function(){h.showCompleteDialog(c)},e)}})},showForceSentDialog:function(a,b,c){var d=this,e={title:" ",content:a,icon:"sigh",buttons:[{name:"确定",type:"blue_btn",id:"text",eventName:"click:sure"}],simpleModal:{modal:!1,minWidth:350}},f=new g({config:e});d.listenTo(f,"click:sure",function(){f.close(),clearTimeout(d.forceTimeouter),clearTimeout(d.completeTimeouter),d.showCompleteDialog(c)}),d.forceTimeouter=setTimeout(function(){f.close()},b)},showCompleteDialog:function(a){var b=this;2==a&&(b.taskCataView.taskList=_.reject(b.taskCataView.taskList,{id:b.content.currentView.options.part.taskId}),b.content.show(b.taskCataView),0==b.taskCataView.taskList&&(this.$(".ntp_content").html('<span class="empty_task"></span>'),setTimeout(function(){var a=[{name:"确定",type:"blue_btn",id:"text",eventName:"click:save"}],c={type:"common",title:" ",content:"您的内部工作平台任务已全部完成，系统发现您又收到了<span style='color:#ff5400'>新邮件</span>，请点击确定回到桌面继续处理",buttons:a,isDrag:!0,moveDown:!1,simpleModal:{modal:!0,maxWidth:438,minWidth:438,opacity:0},icon:"message"},d=new g({config:c});b.listenTo(d,"click:save",function(){clearInterval(b.interval),b.trigger("closeSoftWare","ntp"),d.close()})},100)))},showSendDialog:function(a){var b=this,c=!1;b.sendDialog&&(c=!b.sendDialog.isClosed),b.promptDialog&&b.promptDialog.close(),c||(b.sendDialog=new g({config:{content:a+"成功",icon:"success",isDrag:!0,moveDown:!0,simpleModal:{modal:!1,minWidth:200}}}),setTimeout(function(){b.sendDialog.close(),b.promptDialog&&b.promptDialog.close()},900))},isCompelete:function(b){var c=this,d={sectionId:c.getCntSessionData("sectionId"),partType:c.options.partType};a.app.request("deskVideo:checkPartComplete",d).done(function(a){return a.netError?(c.showNetErrorDialog(),!1):void b(a)})},showTimeDialog:function(a){this.timeDialog=new f({title:"剩余时间",showPro:!1,countdown:a.countdown,totalTime:a.totalTime,containment:"#bs_layout_container",isbreak:1==this.getCntSessionData("isBreak")?!0:!1,autoSubmit:a.autoSubmit,endTime:0}),this.timeDialog.show()},maintainTime:function(a){var b=this;this.interval=setInterval(function(){b.trigger("rememberPartTime")},1e3*a)},closeView:function(){var a=this;this.isCompelete(function(b){if(0==b){var c=[{name:"确定",type:"blue_btn",id:"text",eventName:"click:save"},{name:"取消",type:"grey_btn",id:"canc",eventName:"click:canc"}],f="";f=a.content.currentView instanceof d||a.content.currentView instanceof e?"任务未提交，您确定关闭软件吗？":"任务未处理完，您确定关闭软件吗？";var h={content:f,icon:"task",buttons:c,isDrag:!1,moveDown:!0,simpleModal:{modal:!0,minWidth:350,opacity:0}};a.promptDialog=new g({config:h}),a.listenTo(a.promptDialog,"click:save",function(){clearInterval(this.interval),a.promptDialog.close(),(a.content.currentView instanceof d||a.content.currentView instanceof e)&&(a.content.currentView.saveAll(null,1,!1),a.content.currentView.timeDialog.close()),setTimeout(function(){a.trigger("closeSoftWare","ntp")},100)}),a.listenTo(a.promptDialog,"click:canc",function(){a.promptDialog.close()})}else(a.content.currentView instanceof d||a.content.currentView instanceof e)&&(a.content.currentView.saveAll(null,1,!1),a.content.currentView.timeDialog.close()),clearInterval(this.interval),setTimeout(function(){a.trigger("closeSoftWare","ntp")},100)})},getCntSessionData:function(b){var c=this;try{return a.Context.getTemporaryData(b)}catch(d){if(a.$(".net-error-dialog").length<1){var e=[{name:"确定",type:"blue_btn",id:"sure",eventName:"click:sure"}],f={title:"错误提示",content:"获取数据失败，请重新登陆",icon:"sigh",buttons:e,isDrag:!0,moveDown:!0,simpleModal:{modal:!0,minWidth:350},dialogId:"net-error-dialog"};c.dialog=new g({config:f}),c.listenTo(c.dialog,"click:sure",function(){c.dialog.close(),a.app.execute("history:navigate","#quiz%2Flogin",!1)}),console.error(d.message)}}},showNetErrorDialog:function(){if(a.$(".net-error-dialog").length<1){var b=this,c=[{name:"刷新",type:"blue_btn",id:"sure",eventName:"click:sure"},{name:"取消",type:"grey_btn",id:"cancle",eventName:"click:cancle"}],d={title:"错误提示",content:"数据传输错误，请刷新重试或联系客服人员解决",icon:"sigh",buttons:c,isDrag:!0,moveDown:!0,simpleModal:{modal:!0,minWidth:350},dialogId:"net-error-dialog"},e=new g({config:d});b.listenTo(e,"click:cancle",function(){e.close()}),b.listenTo(e,"click:sure",function(){location.reload()})}}});return h}),!function(a){function b(a){var b=a.length,d=c.type(a);return"function"===d||c.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===d||0===b||"number"==typeof b&&b>0&&b-1 in a}if(!a.jQuery){var c=function(a,b){return new c.fn.init(a,b)};c.isWindow=function(a){return null!=a&&a==a.window},c.type=function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?e[g.call(a)]||"object":typeof a},c.isArray=Array.isArray||function(a){return"array"===c.type(a)},c.isPlainObject=function(a){var b;if(!a||"object"!==c.type(a)||a.nodeType||c.isWindow(a))return!1;try{if(a.constructor&&!f.call(a,"constructor")&&!f.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(d){return!1}for(b in a);return void 0===b||f.call(a,b)},c.each=function(a,c,d){var e,f=0,g=a.length,h=b(a);if(d){if(h)for(;g>f&&(e=c.apply(a[f],d),e!==!1);f++);else for(f in a)if(e=c.apply(a[f],d),e===!1)break}else if(h)for(;g>f&&(e=c.call(a[f],f,a[f]),e!==!1);f++);else for(f in a)if(e=c.call(a[f],f,a[f]),e===!1)break;return a},c.data=function(a,b,e){if(void 0===e){var f=a[c.expando],g=f&&d[f];if(void 0===b)return g;if(g&&b in g)return g[b]}else if(void 0!==b){var f=a[c.expando]||(a[c.expando]=++c.uuid);return d[f]=d[f]||{},d[f][b]=e,e}},c.removeData=function(a,b){var e=a[c.expando],f=e&&d[e];f&&c.each(b,function(a,b){delete f[b]})},c.extend=function(){var a,b,d,e,f,g,h=arguments[0]||{},i=1,j=arguments.length,k=!1;for("boolean"==typeof h&&(k=h,h=arguments[i]||{},i++),"object"!=typeof h&&"function"!==c.type(h)&&(h={}),i===j&&(h=this,i--);j>i;i++)if(null!=(f=arguments[i]))for(e in f)a=h[e],d=f[e],h!==d&&(k&&d&&(c.isPlainObject(d)||(b=c.isArray(d)))?(b?(b=!1,g=a&&c.isArray(a)?a:[]):g=a&&c.isPlainObject(a)?a:{},h[e]=c.extend(k,g,d)):void 0!==d&&(h[e]=d));return h},c.queue=function(a,d,e){function f(a,c){var d=c||[];return null!=a&&(b(Object(a))?!function(a,b){for(var c=+b.length,d=0,e=a.length;c>d;)a[e++]=b[d++];if(c!==c)for(;void 0!==b[d];)a[e++]=b[d++];return a.length=e,a}(d,"string"==typeof a?[a]:a):[].push.call(d,a)),d}if(a){d=(d||"fx")+"queue";var g=c.data(a,d);return e?(!g||c.isArray(e)?g=c.data(a,d,f(e)):g.push(e),g):g||[]}},c.dequeue=function(a,b){c.each(a.nodeType?[a]:a,function(a,d){b=b||"fx";var e=c.queue(d,b),f=e.shift();"inprogress"===f&&(f=e.shift()),f&&("fx"===b&&e.unshift("inprogress"),f.call(d,function(){c.dequeue(d,b)}))})},c.fn=c.prototype={init:function(a){if(a.nodeType)return this[0]=a,this;throw new Error("Not a DOM node.")},offset:function(){var b=this[0].getBoundingClientRect?this[0].getBoundingClientRect():{top:0,left:0};return{top:b.top+(a.pageYOffset||document.scrollTop||0)-(document.clientTop||0),left:b.left+(a.pageXOffset||document.scrollLeft||0)-(document.clientLeft||0)}},position:function(){function a(){for(var a=this.offsetParent||document;a&&"html"===!a.nodeType.toLowerCase&&"static"===a.style.position;)a=a.offsetParent;return a||document}var b=this[0],a=a.apply(b),d=this.offset(),e=/^(?:body|html)$/i.test(a.nodeName)?{top:0,left:0}:c(a).offset();return d.top-=parseFloat(b.style.marginTop)||0,d.left-=parseFloat(b.style.marginLeft)||0,a.style&&(e.top+=parseFloat(a.style.borderTopWidth)||0,e.left+=parseFloat(a.style.borderLeftWidth)||0),{top:d.top-e.top,left:d.left-e.left}}};var d={};c.expando="velocity"+(new Date).getTime(),c.uuid=0;for(var e={},f=e.hasOwnProperty,g=e.toString,h="Boolean Number String Function Array Date RegExp Object Error".split(" "),i=0;i<h.length;i++)e["[object "+h[i]+"]"]=h[i].toLowerCase();c.fn.init.prototype=c.fn,a.Velocity={Utilities:c}}}(window),function(a){"object"==typeof module&&"object"==typeof module.exports?module.exports=a():"function"==typeof define&&define.amd?define("velocity",a):a()}(function(){return function(a,b,c,d){function e(a){for(var b=-1,c=a?a.length:0,d=[];++b<c;){var e=a[b];e&&d.push(e)}return d}function f(a){return p.isWrapped(a)?a=[].slice.call(a):p.isNode(a)&&(a=[a]),a}function g(a){var b=m.data(a,"velocity");return null===b?d:b}function h(a){return function(b){return Math.round(b*a)*(1/a)}}function i(a,c,d,e){function f(a,b){return 1-3*b+3*a}function g(a,b){return 3*b-6*a}function h(a){return 3*a}function i(a,b,c){return((f(b,c)*a+g(b,c))*a+h(b))*a}function j(a,b,c){return 3*f(b,c)*a*a+2*g(b,c)*a+h(b)}function k(b,c){for(var e=0;p>e;++e){var f=j(c,a,d);if(0===f)return c;var g=i(c,a,d)-b;c-=g/f}return c}function l(){for(var b=0;t>b;++b)x[b]=i(b*u,a,d)}function m(b,c,e){var f,g,h=0;do g=c+(e-c)/2,f=i(g,a,d)-b,f>0?e=g:c=g;while(Math.abs(f)>r&&++h<s);return g}function n(b){for(var c=0,e=1,f=t-1;e!=f&&x[e]<=b;++e)c+=u;--e;var g=(b-x[e])/(x[e+1]-x[e]),h=c+g*u,i=j(h,a,d);return i>=q?k(b,h):0==i?h:m(b,c,c+u)}function o(){y=!0,(a!=c||d!=e)&&l()}var p=4,q=.001,r=1e-7,s=10,t=11,u=1/(t-1),v="Float32Array"in b;if(4!==arguments.length)return!1;for(var w=0;4>w;++w)if("number"!=typeof arguments[w]||isNaN(arguments[w])||!isFinite(arguments[w]))return!1;a=Math.min(a,1),d=Math.min(d,1),a=Math.max(a,0),d=Math.max(d,0);var x=v?new Float32Array(t):new Array(t),y=!1,z=function(b){return y||o(),a===c&&d===e?b:0===b?0:1===b?1:i(n(b),c,e)};z.getControlPoints=function(){return[{x:a,y:c},{x:d,y:e}]};var A="generateBezier("+[a,c,d,e]+")";return z.toString=function(){return A},z}function j(a,b){var c=a;return p.isString(a)?t.Easings[a]||(c=!1):c=p.isArray(a)&&1===a.length?h.apply(null,a):p.isArray(a)&&2===a.length?u.apply(null,a.concat([b])):p.isArray(a)&&4===a.length?i.apply(null,a):!1,c===!1&&(c=t.Easings[t.defaults.easing]?t.defaults.easing:s),c}function k(a){if(a){var b=(new Date).getTime(),c=t.State.calls.length;c>1e4&&(t.State.calls=e(t.State.calls));for(var f=0;c>f;f++)if(t.State.calls[f]){var h=t.State.calls[f],i=h[0],j=h[2],n=h[3],o=!!n,q=null;n||(n=t.State.calls[f][3]=b-16);for(var r=Math.min((b-n)/j.duration,1),s=0,u=i.length;u>s;s++){var w=i[s],y=w.element;if(g(y)){var z=!1;if(j.display!==d&&null!==j.display&&"none"!==j.display){if("flex"===j.display){var A=["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex"];m.each(A,function(a,b){v.setPropertyValue(y,"display",b)})}v.setPropertyValue(y,"display",j.display)}j.visibility!==d&&"hidden"!==j.visibility&&v.setPropertyValue(y,"visibility",j.visibility);for(var B in w)if("element"!==B){var C,D=w[B],E=p.isString(D.easing)?t.Easings[D.easing]:D.easing;if(1===r)C=D.endValue;else{var F=D.endValue-D.startValue;if(C=D.startValue+F*E(r,j,F),!o&&C===D.currentValue)continue}if(D.currentValue=C,"tween"===B)q=C;else{if(v.Hooks.registered[B]){var G=v.Hooks.getRoot(B),H=g(y).rootPropertyValueCache[G];
H&&(D.rootPropertyValue=H)}var I=v.setPropertyValue(y,B,D.currentValue+(0===parseFloat(C)?"":D.unitType),D.rootPropertyValue,D.scrollData);v.Hooks.registered[B]&&(g(y).rootPropertyValueCache[G]=v.Normalizations.registered[G]?v.Normalizations.registered[G]("extract",null,I[1]):I[1]),"transform"===I[0]&&(z=!0)}}j.mobileHA&&g(y).transformCache.translate3d===d&&(g(y).transformCache.translate3d="(0px, 0px, 0px)",z=!0),z&&v.flushTransformCache(y)}}j.display!==d&&"none"!==j.display&&(t.State.calls[f][2].display=!1),j.visibility!==d&&"hidden"!==j.visibility&&(t.State.calls[f][2].visibility=!1),j.progress&&j.progress.call(h[1],h[1],r,Math.max(0,n+j.duration-b),n,q),1===r&&l(f)}}t.State.isTicking&&x(k)}function l(a,b){if(!t.State.calls[a])return!1;for(var c=t.State.calls[a][0],e=t.State.calls[a][1],f=t.State.calls[a][2],h=t.State.calls[a][4],i=!1,j=0,k=c.length;k>j;j++){var l=c[j].element;if(b||f.loop||("none"===f.display&&v.setPropertyValue(l,"display",f.display),"hidden"===f.visibility&&v.setPropertyValue(l,"visibility",f.visibility)),f.loop!==!0&&(m.queue(l)[1]===d||!/\.velocityQueueEntryFlag/i.test(m.queue(l)[1]))&&g(l)){g(l).isAnimating=!1,g(l).rootPropertyValueCache={};var n=!1;m.each(v.Lists.transforms3D,function(a,b){var c=/^scale/.test(b)?1:0,e=g(l).transformCache[b];g(l).transformCache[b]!==d&&new RegExp("^\\("+c+"[^.]").test(e)&&(n=!0,delete g(l).transformCache[b])}),f.mobileHA&&(n=!0,delete g(l).transformCache.translate3d),n&&v.flushTransformCache(l),v.Values.removeClass(l,"velocity-animating")}if(!b&&f.complete&&!f.loop&&j===k-1)try{f.complete.call(e,e)}catch(o){setTimeout(function(){throw o},1)}h&&f.loop!==!0&&h(e),g(l)&&f.loop===!0&&!b&&(m.each(g(l).tweensContainer,function(a,b){/^rotate/.test(a)&&360===parseFloat(b.endValue)&&(b.endValue=0,b.startValue=360),/^backgroundPosition/.test(a)&&100===parseFloat(b.endValue)&&"%"===b.unitType&&(b.endValue=0,b.startValue=100)}),t(l,"reverse",{loop:!0,delay:f.delay})),f.queue!==!1&&m.dequeue(l,f.queue)}t.State.calls[a]=!1;for(var p=0,q=t.State.calls.length;q>p;p++)if(t.State.calls[p]!==!1){i=!0;break}i===!1&&(t.State.isTicking=!1,delete t.State.calls,t.State.calls=[])}var m,n=function(){if(c.documentMode)return c.documentMode;for(var a=7;a>4;a--){var b=c.createElement("div");if(b.innerHTML="<!--[if IE "+a+"]><span></span><![endif]-->",b.getElementsByTagName("span").length)return b=null,a}return d}(),o=function(){var a=0;return b.webkitRequestAnimationFrame||b.mozRequestAnimationFrame||function(b){var c,d=(new Date).getTime();return c=Math.max(0,16-(d-a)),a=d+c,setTimeout(function(){b(d+c)},c)}}(),p={isString:function(a){return"string"==typeof a},isArray:Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},isFunction:function(a){return"[object Function]"===Object.prototype.toString.call(a)},isNode:function(a){return a&&a.nodeType},isNodeList:function(a){return"object"==typeof a&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(Object.prototype.toString.call(a))&&a.length!==d&&(0===a.length||"object"==typeof a[0]&&a[0].nodeType>0)},isWrapped:function(a){return a&&(a.jquery||b.Zepto&&b.Zepto.zepto.isZ(a))},isSVG:function(a){return b.SVGElement&&a instanceof b.SVGElement},isEmptyObject:function(a){for(var b in a)return!1;return!0}},q=!1;if(a.fn&&a.fn.jquery?(m=a,q=!0):m=b.Velocity.Utilities,8>=n&&!q)throw new Error("Velocity: IE8 and below require jQuery to be loaded before Velocity.");if(7>=n)return void(jQuery.fn.velocity=jQuery.fn.animate);var r=400,s="swing",t={State:{isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),isAndroid:/Android/i.test(navigator.userAgent),isGingerbread:/Android 2\.3\.[3-7]/i.test(navigator.userAgent),isChrome:b.chrome,isFirefox:/Firefox/i.test(navigator.userAgent),prefixElement:c.createElement("div"),prefixMatches:{},scrollAnchor:null,scrollPropertyLeft:null,scrollPropertyTop:null,isTicking:!1,calls:[]},CSS:{},Utilities:m,Redirects:{},Easings:{},Promise:b.Promise,defaults:{queue:"",duration:r,easing:s,begin:d,complete:d,progress:d,display:d,visibility:d,loop:!1,delay:!1,mobileHA:!0,_cacheValues:!0},init:function(a){m.data(a,"velocity",{isSVG:p.isSVG(a),isAnimating:!1,computedStyle:null,tweensContainer:null,rootPropertyValueCache:{},transformCache:{}})},hook:null,mock:!1,version:{major:1,minor:2,patch:2},debug:!1};b.pageYOffset!==d?(t.State.scrollAnchor=b,t.State.scrollPropertyLeft="pageXOffset",t.State.scrollPropertyTop="pageYOffset"):(t.State.scrollAnchor=c.documentElement||c.body.parentNode||c.body,t.State.scrollPropertyLeft="scrollLeft",t.State.scrollPropertyTop="scrollTop");var u=function(){function a(a){return-a.tension*a.x-a.friction*a.v}function b(b,c,d){var e={x:b.x+d.dx*c,v:b.v+d.dv*c,tension:b.tension,friction:b.friction};return{dx:e.v,dv:a(e)}}function c(c,d){var e={dx:c.v,dv:a(c)},f=b(c,.5*d,e),g=b(c,.5*d,f),h=b(c,d,g),i=1/6*(e.dx+2*(f.dx+g.dx)+h.dx),j=1/6*(e.dv+2*(f.dv+g.dv)+h.dv);return c.x=c.x+i*d,c.v=c.v+j*d,c}return function d(a,b,e){var f,g,h,i={x:-1,v:0,tension:null,friction:null},j=[0],k=0,l=1e-4,m=.016;for(a=parseFloat(a)||500,b=parseFloat(b)||20,e=e||null,i.tension=a,i.friction=b,f=null!==e,f?(k=d(a,b),g=k/e*m):g=m;h=c(h||i,g),j.push(1+h.x),k+=16,Math.abs(h.x)>l&&Math.abs(h.v)>l;);return f?function(a){return j[a*(j.length-1)|0]}:k}}();t.Easings={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2},spring:function(a){return 1-Math.cos(4.5*a*Math.PI)*Math.exp(6*-a)}},m.each([["ease",[.25,.1,.25,1]],["ease-in",[.42,0,1,1]],["ease-out",[0,0,.58,1]],["ease-in-out",[.42,0,.58,1]],["easeInSine",[.47,0,.745,.715]],["easeOutSine",[.39,.575,.565,1]],["easeInOutSine",[.445,.05,.55,.95]],["easeInQuad",[.55,.085,.68,.53]],["easeOutQuad",[.25,.46,.45,.94]],["easeInOutQuad",[.455,.03,.515,.955]],["easeInCubic",[.55,.055,.675,.19]],["easeOutCubic",[.215,.61,.355,1]],["easeInOutCubic",[.645,.045,.355,1]],["easeInQuart",[.895,.03,.685,.22]],["easeOutQuart",[.165,.84,.44,1]],["easeInOutQuart",[.77,0,.175,1]],["easeInQuint",[.755,.05,.855,.06]],["easeOutQuint",[.23,1,.32,1]],["easeInOutQuint",[.86,0,.07,1]],["easeInExpo",[.95,.05,.795,.035]],["easeOutExpo",[.19,1,.22,1]],["easeInOutExpo",[1,0,0,1]],["easeInCirc",[.6,.04,.98,.335]],["easeOutCirc",[.075,.82,.165,1]],["easeInOutCirc",[.785,.135,.15,.86]]],function(a,b){t.Easings[b[0]]=i.apply(null,b[1])});var v=t.CSS={RegEx:{isHex:/^#([A-f\d]{3}){1,2}$/i,valueUnwrap:/^[A-z]+\((.*)\)$/i,wrappedValueAlreadyExtracted:/[0-9.]+ [0-9.]+ [0-9.]+( [0-9.]+)?/,valueSplit:/([A-z]+\(.+\))|(([A-z0-9#-.]+?)(?=\s|$))/gi},Lists:{colors:["fill","stroke","stopColor","color","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","outlineColor"],transformsBase:["translateX","translateY","scale","scaleX","scaleY","skewX","skewY","rotateZ"],transforms3D:["transformPerspective","translateZ","scaleZ","rotateX","rotateY"]},Hooks:{templates:{textShadow:["Color X Y Blur","black 0px 0px 0px"],boxShadow:["Color X Y Blur Spread","black 0px 0px 0px 0px"],clip:["Top Right Bottom Left","0px 0px 0px 0px"],backgroundPosition:["X Y","0% 0%"],transformOrigin:["X Y Z","50% 50% 0px"],perspectiveOrigin:["X Y","50% 50%"]},registered:{},register:function(){for(var a=0;a<v.Lists.colors.length;a++){var b="color"===v.Lists.colors[a]?"0 0 0 1":"255 255 255 1";v.Hooks.templates[v.Lists.colors[a]]=["Red Green Blue Alpha",b]}var c,d,e;if(n)for(c in v.Hooks.templates){d=v.Hooks.templates[c],e=d[0].split(" ");var f=d[1].match(v.RegEx.valueSplit);"Color"===e[0]&&(e.push(e.shift()),f.push(f.shift()),v.Hooks.templates[c]=[e.join(" "),f.join(" ")])}for(c in v.Hooks.templates){d=v.Hooks.templates[c],e=d[0].split(" ");for(var a in e){var g=c+e[a],h=a;v.Hooks.registered[g]=[c,h]}}},getRoot:function(a){var b=v.Hooks.registered[a];return b?b[0]:a},cleanRootPropertyValue:function(a,b){return v.RegEx.valueUnwrap.test(b)&&(b=b.match(v.RegEx.valueUnwrap)[1]),v.Values.isCSSNullValue(b)&&(b=v.Hooks.templates[a][1]),b},extractValue:function(a,b){var c=v.Hooks.registered[a];if(c){var d=c[0],e=c[1];return b=v.Hooks.cleanRootPropertyValue(d,b),b.toString().match(v.RegEx.valueSplit)[e]}return b},injectValue:function(a,b,c){var d=v.Hooks.registered[a];if(d){var e,f,g=d[0],h=d[1];return c=v.Hooks.cleanRootPropertyValue(g,c),e=c.toString().match(v.RegEx.valueSplit),e[h]=b,f=e.join(" ")}return c}},Normalizations:{registered:{clip:function(a,b,c){switch(a){case"name":return"clip";case"extract":var d;return v.RegEx.wrappedValueAlreadyExtracted.test(c)?d=c:(d=c.toString().match(v.RegEx.valueUnwrap),d=d?d[1].replace(/,(\s+)?/g," "):c),d;case"inject":return"rect("+c+")"}},blur:function(a,b,c){switch(a){case"name":return t.State.isFirefox?"filter":"-webkit-filter";case"extract":var d=parseFloat(c);if(!d&&0!==d){var e=c.toString().match(/blur\(([0-9]+[A-z]+)\)/i);d=e?e[1]:0}return d;case"inject":return parseFloat(c)?"blur("+c+")":"none"}},opacity:function(a,b,c){if(8>=n)switch(a){case"name":return"filter";case"extract":var d=c.toString().match(/alpha\(opacity=(.*)\)/i);return c=d?d[1]/100:1;case"inject":return b.style.zoom=1,parseFloat(c)>=1?"":"alpha(opacity="+parseInt(100*parseFloat(c),10)+")"}else switch(a){case"name":return"opacity";case"extract":return c;case"inject":return c}}},register:function(){9>=n||t.State.isGingerbread||(v.Lists.transformsBase=v.Lists.transformsBase.concat(v.Lists.transforms3D));for(var a=0;a<v.Lists.transformsBase.length;a++)!function(){var b=v.Lists.transformsBase[a];v.Normalizations.registered[b]=function(a,c,e){switch(a){case"name":return"transform";case"extract":return g(c)===d||g(c).transformCache[b]===d?/^scale/i.test(b)?1:0:g(c).transformCache[b].replace(/[()]/g,"");case"inject":var f=!1;switch(b.substr(0,b.length-1)){case"translate":f=!/(%|px|em|rem|vw|vh|\d)$/i.test(e);break;case"scal":case"scale":t.State.isAndroid&&g(c).transformCache[b]===d&&1>e&&(e=1),f=!/(\d)$/i.test(e);break;case"skew":f=!/(deg|\d)$/i.test(e);break;case"rotate":f=!/(deg|\d)$/i.test(e)}return f||(g(c).transformCache[b]="("+e+")"),g(c).transformCache[b]}}}();for(var a=0;a<v.Lists.colors.length;a++)!function(){var b=v.Lists.colors[a];v.Normalizations.registered[b]=function(a,c,e){switch(a){case"name":return b;case"extract":var f;if(v.RegEx.wrappedValueAlreadyExtracted.test(e))f=e;else{var g,h={black:"rgb(0, 0, 0)",blue:"rgb(0, 0, 255)",gray:"rgb(128, 128, 128)",green:"rgb(0, 128, 0)",red:"rgb(255, 0, 0)",white:"rgb(255, 255, 255)"};/^[A-z]+$/i.test(e)?g=h[e]!==d?h[e]:h.black:v.RegEx.isHex.test(e)?g="rgb("+v.Values.hexToRgb(e).join(" ")+")":/^rgba?\(/i.test(e)||(g=h.black),f=(g||e).toString().match(v.RegEx.valueUnwrap)[1].replace(/,(\s+)?/g," ")}return 8>=n||3!==f.split(" ").length||(f+=" 1"),f;case"inject":return 8>=n?4===e.split(" ").length&&(e=e.split(/\s+/).slice(0,3).join(" ")):3===e.split(" ").length&&(e+=" 1"),(8>=n?"rgb":"rgba")+"("+e.replace(/\s+/g,",").replace(/\.(\d)+(?=,)/g,"")+")"}}}()}},Names:{camelCase:function(a){return a.replace(/-(\w)/g,function(a,b){return b.toUpperCase()})},SVGAttribute:function(a){var b="width|height|x|y|cx|cy|r|rx|ry|x1|x2|y1|y2";return(n||t.State.isAndroid&&!t.State.isChrome)&&(b+="|transform"),new RegExp("^("+b+")$","i").test(a)},prefixCheck:function(a){if(t.State.prefixMatches[a])return[t.State.prefixMatches[a],!0];for(var b=["","Webkit","Moz","ms","O"],c=0,d=b.length;d>c;c++){var e;if(e=0===c?a:b[c]+a.replace(/^\w/,function(a){return a.toUpperCase()}),p.isString(t.State.prefixElement.style[e]))return t.State.prefixMatches[a]=e,[e,!0]}return[a,!1]}},Values:{hexToRgb:function(a){var b,c=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,d=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;return a=a.replace(c,function(a,b,c,d){return b+b+c+c+d+d}),b=d.exec(a),b?[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16)]:[0,0,0]},isCSSNullValue:function(a){return 0==a||/^(none|auto|transparent|(rgba\(0, ?0, ?0, ?0\)))$/i.test(a)},getUnitType:function(a){return/^(rotate|skew)/i.test(a)?"deg":/(^(scale|scaleX|scaleY|scaleZ|alpha|flexGrow|flexHeight|zIndex|fontWeight)$)|((opacity|red|green|blue|alpha)$)/i.test(a)?"":"px"},getDisplayType:function(a){var b=a&&a.tagName.toString().toLowerCase();return/^(b|big|i|small|tt|abbr|acronym|cite|code|dfn|em|kbd|strong|samp|var|a|bdo|br|img|map|object|q|script|span|sub|sup|button|input|label|select|textarea)$/i.test(b)?"inline":/^(li)$/i.test(b)?"list-item":/^(tr)$/i.test(b)?"table-row":/^(table)$/i.test(b)?"table":/^(tbody)$/i.test(b)?"table-row-group":"block"},addClass:function(a,b){a.classList?a.classList.add(b):a.className+=(a.className.length?" ":"")+b},removeClass:function(a,b){a.classList?a.classList.remove(b):a.className=a.className.toString().replace(new RegExp("(^|\\s)"+b.split(" ").join("|")+"(\\s|$)","gi")," ")}},getPropertyValue:function(a,c,e,f){function h(a,c){function e(){j&&v.setPropertyValue(a,"display","none")}var i=0;if(8>=n)i=m.css(a,c);else{var j=!1;if(/^(width|height)$/.test(c)&&0===v.getPropertyValue(a,"display")&&(j=!0,v.setPropertyValue(a,"display",v.Values.getDisplayType(a))),!f){if("height"===c&&"border-box"!==v.getPropertyValue(a,"boxSizing").toString().toLowerCase()){var k=a.offsetHeight-(parseFloat(v.getPropertyValue(a,"borderTopWidth"))||0)-(parseFloat(v.getPropertyValue(a,"borderBottomWidth"))||0)-(parseFloat(v.getPropertyValue(a,"paddingTop"))||0)-(parseFloat(v.getPropertyValue(a,"paddingBottom"))||0);return e(),k}if("width"===c&&"border-box"!==v.getPropertyValue(a,"boxSizing").toString().toLowerCase()){var l=a.offsetWidth-(parseFloat(v.getPropertyValue(a,"borderLeftWidth"))||0)-(parseFloat(v.getPropertyValue(a,"borderRightWidth"))||0)-(parseFloat(v.getPropertyValue(a,"paddingLeft"))||0)-(parseFloat(v.getPropertyValue(a,"paddingRight"))||0);return e(),l}}var o;o=g(a)===d?b.getComputedStyle(a,null):g(a).computedStyle?g(a).computedStyle:g(a).computedStyle=b.getComputedStyle(a,null),"borderColor"===c&&(c="borderTopColor"),i=9===n&&"filter"===c?o.getPropertyValue(c):o[c],(""===i||null===i)&&(i=a.style[c]),e()}if("auto"===i&&/^(top|right|bottom|left)$/i.test(c)){var p=h(a,"position");("fixed"===p||"absolute"===p&&/top|left/i.test(c))&&(i=m(a).position()[c]+"px")}return i}var i;if(v.Hooks.registered[c]){var j=c,k=v.Hooks.getRoot(j);e===d&&(e=v.getPropertyValue(a,v.Names.prefixCheck(k)[0])),v.Normalizations.registered[k]&&(e=v.Normalizations.registered[k]("extract",a,e)),i=v.Hooks.extractValue(j,e)}else if(v.Normalizations.registered[c]){var l,o;l=v.Normalizations.registered[c]("name",a),"transform"!==l&&(o=h(a,v.Names.prefixCheck(l)[0]),v.Values.isCSSNullValue(o)&&v.Hooks.templates[c]&&(o=v.Hooks.templates[c][1])),i=v.Normalizations.registered[c]("extract",a,o)}if(!/^[\d-]/.test(i))if(g(a)&&g(a).isSVG&&v.Names.SVGAttribute(c))if(/^(height|width)$/i.test(c))try{i=a.getBBox()[c]}catch(p){i=0}else i=a.getAttribute(c);else i=h(a,v.Names.prefixCheck(c)[0]);return v.Values.isCSSNullValue(i)&&(i=0),t.debug>=2&&console.log("Get "+c+": "+i),i},setPropertyValue:function(a,c,d,e,f){var h=c;if("scroll"===c)f.container?f.container["scroll"+f.direction]=d:"Left"===f.direction?b.scrollTo(d,f.alternateValue):b.scrollTo(f.alternateValue,d);else if(v.Normalizations.registered[c]&&"transform"===v.Normalizations.registered[c]("name",a))v.Normalizations.registered[c]("inject",a,d),h="transform",d=g(a).transformCache[c];else{if(v.Hooks.registered[c]){var i=c,j=v.Hooks.getRoot(c);e=e||v.getPropertyValue(a,j),d=v.Hooks.injectValue(i,d,e),c=j}if(v.Normalizations.registered[c]&&(d=v.Normalizations.registered[c]("inject",a,d),c=v.Normalizations.registered[c]("name",a)),h=v.Names.prefixCheck(c)[0],8>=n)try{a.style[h]=d}catch(k){t.debug&&console.log("Browser does not support ["+d+"] for ["+h+"]")}else g(a)&&g(a).isSVG&&v.Names.SVGAttribute(c)?a.setAttribute(c,d):a.style[h]=d;t.debug>=2&&console.log("Set "+c+" ("+h+"): "+d)}return[h,d]},flushTransformCache:function(a){function b(b){return parseFloat(v.getPropertyValue(a,b))}var c="";if((n||t.State.isAndroid&&!t.State.isChrome)&&g(a).isSVG){var d={translate:[b("translateX"),b("translateY")],skewX:[b("skewX")],skewY:[b("skewY")],scale:1!==b("scale")?[b("scale"),b("scale")]:[b("scaleX"),b("scaleY")],rotate:[b("rotateZ"),0,0]};m.each(g(a).transformCache,function(a){/^translate/i.test(a)?a="translate":/^scale/i.test(a)?a="scale":/^rotate/i.test(a)&&(a="rotate"),d[a]&&(c+=a+"("+d[a].join(" ")+") ",delete d[a])})}else{var e,f;m.each(g(a).transformCache,function(b){return e=g(a).transformCache[b],"transformPerspective"===b?(f=e,!0):(9===n&&"rotateZ"===b&&(b="rotate"),void(c+=b+e+" "))}),f&&(c="perspective"+f+" "+c)}v.setPropertyValue(a,"transform",c)}};v.Hooks.register(),v.Normalizations.register(),t.hook=function(a,b,c){var e=d;return a=f(a),m.each(a,function(a,f){if(g(f)===d&&t.init(f),c===d)e===d&&(e=t.CSS.getPropertyValue(f,b));else{var h=t.CSS.setPropertyValue(f,b,c);"transform"===h[0]&&t.CSS.flushTransformCache(f),e=h}}),e};var w=function(){function a(){return h?B.promise||null:i}function e(){function a(){function a(a,b){var c=d,e=d,g=d;return p.isArray(a)?(c=a[0],!p.isArray(a[1])&&/^[\d-]/.test(a[1])||p.isFunction(a[1])||v.RegEx.isHex.test(a[1])?g=a[1]:(p.isString(a[1])&&!v.RegEx.isHex.test(a[1])||p.isArray(a[1]))&&(e=b?a[1]:j(a[1],h.duration),a[2]!==d&&(g=a[2]))):c=a,b||(e=e||h.easing),p.isFunction(c)&&(c=c.call(f,y,x)),p.isFunction(g)&&(g=g.call(f,y,x)),[c||0,e,g]}function l(a,b){var c,d;return d=(b||"0").toString().toLowerCase().replace(/[%A-z]+$/,function(a){return c=a,""}),c||(c=v.Values.getUnitType(a)),[d,c]}function n(){var a={myParent:f.parentNode||c.body,position:v.getPropertyValue(f,"position"),fontSize:v.getPropertyValue(f,"fontSize")},d=a.position===I.lastPosition&&a.myParent===I.lastParent,e=a.fontSize===I.lastFontSize;I.lastParent=a.myParent,I.lastPosition=a.position,I.lastFontSize=a.fontSize;var h=100,i={};if(e&&d)i.emToPx=I.lastEmToPx,i.percentToPxWidth=I.lastPercentToPxWidth,i.percentToPxHeight=I.lastPercentToPxHeight;else{var j=g(f).isSVG?c.createElementNS("http://www.w3.org/2000/svg","rect"):c.createElement("div");t.init(j),a.myParent.appendChild(j),m.each(["overflow","overflowX","overflowY"],function(a,b){t.CSS.setPropertyValue(j,b,"hidden")}),t.CSS.setPropertyValue(j,"position",a.position),t.CSS.setPropertyValue(j,"fontSize",a.fontSize),t.CSS.setPropertyValue(j,"boxSizing","content-box"),m.each(["minWidth","maxWidth","width","minHeight","maxHeight","height"],function(a,b){t.CSS.setPropertyValue(j,b,h+"%")}),t.CSS.setPropertyValue(j,"paddingLeft",h+"em"),i.percentToPxWidth=I.lastPercentToPxWidth=(parseFloat(v.getPropertyValue(j,"width",null,!0))||1)/h,i.percentToPxHeight=I.lastPercentToPxHeight=(parseFloat(v.getPropertyValue(j,"height",null,!0))||1)/h,i.emToPx=I.lastEmToPx=(parseFloat(v.getPropertyValue(j,"paddingLeft"))||1)/h,a.myParent.removeChild(j)}return null===I.remToPx&&(I.remToPx=parseFloat(v.getPropertyValue(c.body,"fontSize"))||16),null===I.vwToPx&&(I.vwToPx=parseFloat(b.innerWidth)/100,I.vhToPx=parseFloat(b.innerHeight)/100),i.remToPx=I.remToPx,i.vwToPx=I.vwToPx,i.vhToPx=I.vhToPx,t.debug>=1&&console.log("Unit ratios: "+JSON.stringify(i),f),i}if(h.begin&&0===y)try{h.begin.call(o,o)}catch(r){setTimeout(function(){throw r},1)}if("scroll"===C){var u,w,z,A=/^x$/i.test(h.axis)?"Left":"Top",D=parseFloat(h.offset)||0;h.container?p.isWrapped(h.container)||p.isNode(h.container)?(h.container=h.container[0]||h.container,u=h.container["scroll"+A],z=u+m(f).position()[A.toLowerCase()]+D):h.container=null:(u=t.State.scrollAnchor[t.State["scrollProperty"+A]],w=t.State.scrollAnchor[t.State["scrollProperty"+("Left"===A?"Top":"Left")]],z=m(f).offset()[A.toLowerCase()]+D),i={scroll:{rootPropertyValue:!1,startValue:u,currentValue:u,endValue:z,unitType:"",easing:h.easing,scrollData:{container:h.container,direction:A,alternateValue:w}},element:f},t.debug&&console.log("tweensContainer (scroll): ",i.scroll,f)}else if("reverse"===C){if(!g(f).tweensContainer)return void m.dequeue(f,h.queue);"none"===g(f).opts.display&&(g(f).opts.display="auto"),"hidden"===g(f).opts.visibility&&(g(f).opts.visibility="visible"),g(f).opts.loop=!1,g(f).opts.begin=null,g(f).opts.complete=null,s.easing||delete h.easing,s.duration||delete h.duration,h=m.extend({},g(f).opts,h);var E=m.extend(!0,{},g(f).tweensContainer);for(var F in E)if("element"!==F){var G=E[F].startValue;E[F].startValue=E[F].currentValue=E[F].endValue,E[F].endValue=G,p.isEmptyObject(s)||(E[F].easing=h.easing),t.debug&&console.log("reverse tweensContainer ("+F+"): "+JSON.stringify(E[F]),f)}i=E}else if("start"===C){var E;g(f).tweensContainer&&g(f).isAnimating===!0&&(E=g(f).tweensContainer),m.each(q,function(b,c){if(RegExp("^"+v.Lists.colors.join("$|^")+"$").test(b)){var e=a(c,!0),f=e[0],g=e[1],h=e[2];if(v.RegEx.isHex.test(f)){for(var i=["Red","Green","Blue"],j=v.Values.hexToRgb(f),k=h?v.Values.hexToRgb(h):d,l=0;l<i.length;l++){var m=[j[l]];g&&m.push(g),k!==d&&m.push(k[l]),q[b+i[l]]=m}delete q[b]}}});for(var H in q){var K=a(q[H]),L=K[0],M=K[1],N=K[2];H=v.Names.camelCase(H);var O=v.Hooks.getRoot(H),P=!1;if(g(f).isSVG||"tween"===O||v.Names.prefixCheck(O)[1]!==!1||v.Normalizations.registered[O]!==d){(h.display!==d&&null!==h.display&&"none"!==h.display||h.visibility!==d&&"hidden"!==h.visibility)&&/opacity|filter/.test(H)&&!N&&0!==L&&(N=0),h._cacheValues&&E&&E[H]?(N===d&&(N=E[H].endValue+E[H].unitType),P=g(f).rootPropertyValueCache[O]):v.Hooks.registered[H]?N===d?(P=v.getPropertyValue(f,O),N=v.getPropertyValue(f,H,P)):P=v.Hooks.templates[O][1]:N===d&&(N=v.getPropertyValue(f,H));var Q,R,S,T=!1;if(Q=l(H,N),N=Q[0],S=Q[1],Q=l(H,L),L=Q[0].replace(/^([+-\/*])=/,function(a,b){return T=b,""}),R=Q[1],N=parseFloat(N)||0,L=parseFloat(L)||0,"%"===R&&(/^(fontSize|lineHeight)$/.test(H)?(L/=100,R="em"):/^scale/.test(H)?(L/=100,R=""):/(Red|Green|Blue)$/i.test(H)&&(L=L/100*255,R="")),/[\/*]/.test(T))R=S;else if(S!==R&&0!==N)if(0===L)R=S;else{e=e||n();var U=/margin|padding|left|right|width|text|word|letter/i.test(H)||/X$/.test(H)||"x"===H?"x":"y";switch(S){case"%":N*="x"===U?e.percentToPxWidth:e.percentToPxHeight;break;case"px":break;default:N*=e[S+"ToPx"]}switch(R){case"%":N*=1/("x"===U?e.percentToPxWidth:e.percentToPxHeight);break;case"px":break;default:N*=1/e[R+"ToPx"]}}switch(T){case"+":L=N+L;break;case"-":L=N-L;break;case"*":L=N*L;break;case"/":L=N/L}i[H]={rootPropertyValue:P,startValue:N,currentValue:N,endValue:L,unitType:R,easing:M},t.debug&&console.log("tweensContainer ("+H+"): "+JSON.stringify(i[H]),f)}else t.debug&&console.log("Skipping ["+O+"] due to a lack of browser support.")}i.element=f}i.element&&(v.Values.addClass(f,"velocity-animating"),J.push(i),""===h.queue&&(g(f).tweensContainer=i,g(f).opts=h),g(f).isAnimating=!0,y===x-1?(t.State.calls.push([J,o,h,null,B.resolver]),t.State.isTicking===!1&&(t.State.isTicking=!0,k())):y++)}var e,f=this,h=m.extend({},t.defaults,s),i={};switch(g(f)===d&&t.init(f),parseFloat(h.delay)&&h.queue!==!1&&m.queue(f,h.queue,function(a){t.velocityQueueEntryFlag=!0,g(f).delayTimer={setTimeout:setTimeout(a,parseFloat(h.delay)),next:a}}),h.duration.toString().toLowerCase()){case"fast":h.duration=200;break;case"normal":h.duration=r;break;case"slow":h.duration=600;break;default:h.duration=parseFloat(h.duration)||1}t.mock!==!1&&(t.mock===!0?h.duration=h.delay=1:(h.duration*=parseFloat(t.mock)||1,h.delay*=parseFloat(t.mock)||1)),h.easing=j(h.easing,h.duration),h.begin&&!p.isFunction(h.begin)&&(h.begin=null),h.progress&&!p.isFunction(h.progress)&&(h.progress=null),h.complete&&!p.isFunction(h.complete)&&(h.complete=null),h.display!==d&&null!==h.display&&(h.display=h.display.toString().toLowerCase(),"auto"===h.display&&(h.display=t.CSS.Values.getDisplayType(f))),h.visibility!==d&&null!==h.visibility&&(h.visibility=h.visibility.toString().toLowerCase()),h.mobileHA=h.mobileHA&&t.State.isMobile&&!t.State.isGingerbread,h.queue===!1?h.delay?setTimeout(a,h.delay):a():m.queue(f,h.queue,function(b,c){return c===!0?(B.promise&&B.resolver(o),!0):(t.velocityQueueEntryFlag=!0,void a(b))}),""!==h.queue&&"fx"!==h.queue||"inprogress"===m.queue(f)[0]||m.dequeue(f)}var h,i,n,o,q,s,u=arguments[0]&&(arguments[0].p||m.isPlainObject(arguments[0].properties)&&!arguments[0].properties.names||p.isString(arguments[0].properties));if(p.isWrapped(this)?(h=!1,n=0,o=this,i=this):(h=!0,n=1,o=u?arguments[0].elements||arguments[0].e:arguments[0]),o=f(o)){u?(q=arguments[0].properties||arguments[0].p,s=arguments[0].options||arguments[0].o):(q=arguments[n],s=arguments[n+1]);var x=o.length,y=0;if(!/^(stop|finish)$/i.test(q)&&!m.isPlainObject(s)){var z=n+1;s={};for(var A=z;A<arguments.length;A++)p.isArray(arguments[A])||!/^(fast|normal|slow)$/i.test(arguments[A])&&!/^\d/.test(arguments[A])?p.isString(arguments[A])||p.isArray(arguments[A])?s.easing=arguments[A]:p.isFunction(arguments[A])&&(s.complete=arguments[A]):s.duration=arguments[A]}var B={promise:null,resolver:null,rejecter:null};h&&t.Promise&&(B.promise=new t.Promise(function(a,b){B.resolver=a,B.rejecter=b}));var C;switch(q){case"scroll":C="scroll";break;case"reverse":C="reverse";break;case"finish":case"stop":m.each(o,function(a,b){g(b)&&g(b).delayTimer&&(clearTimeout(g(b).delayTimer.setTimeout),g(b).delayTimer.next&&g(b).delayTimer.next(),delete g(b).delayTimer)});var D=[];return m.each(t.State.calls,function(a,b){b&&m.each(b[1],function(c,e){var f=s===d?"":s;return f===!0||b[2].queue===f||s===d&&b[2].queue===!1?void m.each(o,function(c,d){d===e&&((s===!0||p.isString(s))&&(m.each(m.queue(d,p.isString(s)?s:""),function(a,b){p.isFunction(b)&&b(null,!0)}),m.queue(d,p.isString(s)?s:"",[])),"stop"===q?(g(d)&&g(d).tweensContainer&&f!==!1&&m.each(g(d).tweensContainer,function(a,b){b.endValue=b.currentValue}),D.push(a)):"finish"===q&&(b[2].duration=1))}):!0})}),"stop"===q&&(m.each(D,function(a,b){l(b,!0)}),B.promise&&B.resolver(o)),a();default:if(!m.isPlainObject(q)||p.isEmptyObject(q)){if(p.isString(q)&&t.Redirects[q]){var E=m.extend({},s),F=E.duration,G=E.delay||0;return E.backwards===!0&&(o=m.extend(!0,[],o).reverse()),m.each(o,function(a,b){parseFloat(E.stagger)?E.delay=G+parseFloat(E.stagger)*a:p.isFunction(E.stagger)&&(E.delay=G+E.stagger.call(b,a,x)),E.drag&&(E.duration=parseFloat(F)||(/^(callout|transition)/.test(q)?1e3:r),E.duration=Math.max(E.duration*(E.backwards?1-a/x:(a+1)/x),.75*E.duration,200)),t.Redirects[q].call(b,b,E||{},a,x,o,B.promise?B:d)}),a()}var H="Velocity: First argument ("+q+") was not a property map, a known action, or a registered redirect. Aborting.";return B.promise?B.rejecter(new Error(H)):console.log(H),a()}C="start"}var I={lastParent:null,lastPosition:null,lastFontSize:null,lastPercentToPxWidth:null,lastPercentToPxHeight:null,lastEmToPx:null,remToPx:null,vwToPx:null,vhToPx:null},J=[];m.each(o,function(a,b){p.isNode(b)&&e.call(b)});var K,E=m.extend({},t.defaults,s);if(E.loop=parseInt(E.loop),K=2*E.loop-1,E.loop)for(var L=0;K>L;L++){var M={delay:E.delay,progress:E.progress};L===K-1&&(M.display=E.display,M.visibility=E.visibility,M.complete=E.complete),w(o,"reverse",M)}return a()}};t=m.extend(w,t),t.animate=w;var x=b.requestAnimationFrame||o;return t.State.isMobile||c.hidden===d||c.addEventListener("visibilitychange",function(){c.hidden?(x=function(a){return setTimeout(function(){a(!0)},16)},k()):x=b.requestAnimationFrame||o}),a.Velocity=t,a!==b&&(a.fn.velocity=w,a.fn.velocity.defaults=t.defaults),m.each(["Down","Up"],function(a,b){t.Redirects["slide"+b]=function(a,c,e,f,g,h){var i=m.extend({},c),j=i.begin,k=i.complete,l={height:"",marginTop:"",marginBottom:"",paddingTop:"",paddingBottom:""},n={};i.display===d&&(i.display="Down"===b?"inline"===t.CSS.Values.getDisplayType(a)?"inline-block":"block":"none"),i.begin=function(){j&&j.call(g,g);for(var c in l){n[c]=a.style[c];var d=t.CSS.getPropertyValue(a,c);l[c]="Down"===b?[d,0]:[0,d]}n.overflow=a.style.overflow,a.style.overflow="hidden"},i.complete=function(){for(var b in n)a.style[b]=n[b];k&&k.call(g,g),h&&h.resolver(g)},t(a,l,i)}}),m.each(["In","Out"],function(a,b){t.Redirects["fade"+b]=function(a,c,e,f,g,h){var i=m.extend({},c),j={opacity:"In"===b?1:0},k=i.complete;i.complete=e!==f-1?i.begin=null:function(){k&&k.call(g,g),h&&h.resolver(g)},i.display===d&&(i.display="In"===b?"auto":"none"),t(this,j,i)}}),t}(window.jQuery||window.Zepto||window,window,document)}),define("views/common/plugins/finish/finish-view",["talent","templates/common","moment","velocity","views/common/plugins/dialog/bsdialog"],function(a,b,c,d,e){return a.Layout.extend({template:b["common/plugins/finish/finish-page"],className:"finish-container",ui:{container:".finish-container",btn:".finish-btn",welcome:"#finish-welcome"},events:function(){var a={};return a["click "+this.ui.btn]="closeView",a},initialize:function(){var b=a.Context.getSessionData("sectionLen"),c=1==b?"退出":"下一部分";this.model.set("btnName",c)},onShow:function(){this.$el.find("audio")[0].play(),this.drawAnimation()},closeView:function(){1==a.Context.getSessionData("sectionLen")?a.app.execute("history:navigate","#quiz/complete?type=complete",!0):(a.app.execute("history:navigate","#quiz/formal",!1),window.onbeforeunload=null,location.reload())},showDialog:function(){var b=this,c=a.Context.getSessionData("sectionLen"),d=1==c?"退出":"下一部分",f={type:"common",title:" ",content:"<div class='tip_dialog finish-dialog'><span></span><p>您的NTP集团工作之旅已经结束，请点击以下按钮退出此部分。祝您工作顺利！</p></div>",buttons:[{name:d,id:"sure",type:"tip_sure",eventName:"click:sure"}],simpleModal:{modal:!0,minWidth:438},isDrag:!1,moveDown:!1,icon:"common"},g=new e({config:f});b.listenTo(g,"click:sure",function(){g.close(),1==a.Context.getSessionData("sectionLen")?a.app.execute("history:navigate","#quiz/complete?type=complete",!1):(a.app.execute("history:navigate","#quiz/formal",!1),window.onbeforeunload=null,location.reload()),document.webkitCancelFullScreen&&document.webkitCancelFullScreen()})},drawAnimation:function(){function a(a,b){return Math.floor(Math.random()*(b-a+1))+a}var b=this,c=/Webkit/i.test(navigator.userAgent),e=(/Chrome/i.test(navigator.userAgent),!!("ontouchstart"in window),/Android/i.test(navigator.userAgent),document.documentMode);d.defaults.easing="easeInOutsine";for(var f,g=175,h="",i=$("#count"),j=b.$el.find(".finish-welcome-text"),k=0;g>k;k++)h+="<div class='dot'></div>";f=$(h),i.html(g);var l=this.ui.container,m=$("#browserWidthNotice"),n=this.ui.welcome,o=window.screen.availWidth,p=window.screen.availHeight,q=p-(document.documentElement.clientHeight||p),r=-725,s=600,t={perspective:[215,50],opacity:[.9,.55]};e||(t.rotateZ=[5,0]),document.documentElement.clientWidth/o<.8&&m.show(),c&&f.css("boxShadow","0px 0px 4px 0px #4bc2f1"),j.velocity("fadeIn",{duration:1500}).velocity("fadeOut",{delay:1e3,duration:1500,complete:function(){j.html("在这段旅途中您有什么感受？")}}).velocity("fadeIn",{duration:1500}).velocity("fadeOut",{delay:2e3,duration:1500,complete:function(){j.parent().css({height:"84px","margin-top":"-42px"}),j.html("核心员工&nbsp;&nbsp;意欲离职<br/>信息不明&nbsp;&nbsp;艰难决策"),l.css("perspective-origin",o/2+"px "+(.5*p-q)+"px").velocity(t,{duration:1300,loop:1,delay:3250}),f.velocity({translateX:[function(){return"+="+a(-o/2.5,o/2.5)},function(){return a(0,o)}],translateY:[function(){return"+="+a(-p/2.75,p/2.75)},function(){return a(0,p)}],translateZ:[function(){return"+="+a(r,s)},function(){return a(r,s)}],opacity:[function(){return Math.random()},function(){return Math.random()+.1}]},{duration:13e3}).velocity("reverse",{easing:"easeInOutBounce"}).velocity({opacity:0},{duration:1500,complete:function(){j.velocity("fadeIn",{delay:700,duration:1500,complete:function(){b.$el.find(".finish-btn").velocity({opacity:1},{delay:3e3,duration:5e3,display:"block"}).find("*").add(n).css("pointer-events","auto")}})}}).appendTo(l)}}).velocity("fadeIn",{duration:1500}).velocity("fadeOut",{delay:7e3,duration:1500,complete:function(){j.html("下属幼嫩&nbsp;&nbsp;嗷嗷待引<br/>协作部门&nbsp;&nbsp;资源拉扯")}}).velocity("fadeIn",{duration:1500}).velocity("fadeOut",{delay:8e3,duration:1500,complete:function(){j.html("团队倦怠&nbsp;&nbsp;人心不齐<br/>……")}}).velocity("fadeIn",{duration:1500}).velocity("fadeOut",{delay:3e3,duration:1500,complete:function(){j.html("做领导者和做你自己是同义词，<br/>就是这么简单，也是这么困难。<p>──沃伦·本尼斯</p>"),j.parent().css({height:"184px","margin-top":"-92px"})
}})},onClose:function(){}})}),define("views/quiz/appraise/index-page-view",["talent","templates/quiz","$.cookie","moment","timedialog","views/quiz/appraise/foot-page-view","views/quiz/appraise/desk-page-view","views/quiz/appraise/dialog-assist/instruction-view","views/quiz/introduce/index-page-view","views/quiz/video/index-page-view","views/quiz/email/index-page-view","views/quiz/ntp/index-page-view","views/common/plugins/dialog/bsdialog","views/common/plugins/wait/time-wait","views/common/plugins/finish/finish-view"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=a.Layout.extend({template:b["quiz/appraise/index-page"],className:"desktop_container",regions:{contents:".desktop_content",footer:".desktop_footer"},ui:{contents:".desktop_content"},events:function(){var a={};return a},initialize:function(){this._getData(),this.jodgeBroswerFresh(),a.Context.setSessionData("firstEmailUseTime",0)},jodgeBroswerFresh:function(){window.onbeforeunload=function(){window.event.returnValue=event.clientX>document.body.clientWidth&&event.clientY<0||event.altKey?"":(event.clientY>document.body.clientHeight||event.altKey,"")}},_getData:function(){var b=this,c={sectionId:b.getCntSessionData("sectionId")};a.app.request("deskVideo:getDesktopPart",c).done(function(c){return c.netError?(b.showNetErrorDialog(),!1):(this.showView(c),this._showView(),a.Context.setSessionData("testee",JSON.stringify(c.testee)),void a.Context.setSessionData("isBreak",c.isBreak))}.bind(this))},showView:function(b){var c=this;this.model=new a.Model(b),this.footPageView=new f({model:this.model}),this.listenTo(this.footPageView,"iconClick",function(){}),this.deskPageView=new g({model:this.model}),this.listenTo(this.deskPageView,"openSoftware",function(a){var b=_.findWhere(this.model.get("list"),{soft:a});switch(a){case"recommand":c.openRecommand(b),c.rememberPartTime(b,"open",c.getCntSessionData("firstEmailUseTime"));break;case"email":c.openEmail(b);break;case"video":c.openVideo(b);break;case"ntp":c.openNtp(b)}c.footPageView.addIcon(a)})},onRender:function(){},onShow:function(){},removeAnimate:function(){this.ui.contents.removeClass("animated fadeIn")},addAnimate:function(){this.ui.contents.addClass("animated fadeIn")},_showView:function(){this.footer.show(this.footPageView),this.contents.show(this.deskPageView),$("body").css({overflow:"hidden"})},openRecommand:function(a){var b=this;this.introducePageView=new i(a),this.addAnimate(),this.contents.show(this.introducePageView),this.listenTo(this.introducePageView,"closeSoftWare",function(){b.rememberPartTime(a,"close",b.getCntSessionData("firstEmailUseTime"),function(){b._getData(),b.removeAnimate()})})},openEmail:function(a){var b=this,c=this.model.get("activeTask"),d=this.model.get("isBreak");if(1==a.isAllowEnter){var e=a.taskCount,f=Math.round(a.requireTimes/60),g=a.partType,h="";"FirstEmail"!=c&&"SecondEmail"!=c||1!=d?"FirstEmail"==g?h+="<div>邮箱中有<span style='color:#ff5400'>"+e+"封</span>未读邮件，您可以按照以往的工作习惯安排处理顺序，但请合理安排时间，确保在<span style='color:#ff5400'>"+f+"分钟</span>内完成，到时系统将强制结束，关闭软件</div>":"SecondEmail"==g&&(h+="<div>您的邮箱中又收到<span style='color:#ff5400'>"+e+"封</span>未读邮件，请利用最后的<span style='color:#ff5400'>"+f+"分钟</span>时间完成处理。请注意合理安排时间，到时系统将强制结束处理，关闭软件</div>"):h+="<div>继续处理之前遗留的邮件，剩余时间为<span style='color:#ff5400'>"+f+"分钟</span></div>",this.showDialog(h,function(){b.rememberPartTime(a,"open",b.getCntSessionData("firstEmailUseTime")),b.emailPageView=new k(a),b.dialogView.close(),b.deskPageView.remove(),b.addAnimate(),b.contents.show(b.emailPageView),b.listenTo(b.emailPageView,"rememberPartTime",function(){b.rememberPartTime(a,"close",0)}),b.listenTo(b.emailPageView,"closeSoftWare",function(c,d){if(b.removeAnimate(),"complete:secondEmail"==d){var e=new o;b.footPageView.close(),b.contents.show(e)}else b.rememberPartTime(a,"close",0,function(){b._getData()})})},function(){b.removeAnimate(),b.dialogView.close(),b.footPageView.removeIcon("email"),b.removeIconActiveStyle()})}else this.showTipDialog(a)},openVideo:function(a){var b=this,c=this.model.get("activeTask"),d=this.model.get("isBreak");if(1==a.isAllowEnter){var e=a.taskCount,f=Math.round(a.requireTimes/60),g="";g+="Video"==c&&1==d?"<div>继续处理之前遗留的视频留言</div>":"<div>您的视频通讯中有<span style='color:#ff5400;'>"+e+"封</span>未读留言，请您合理安排时间，尽量在<span style='color:#ff5400;'>"+f+"分钟</span>内完成处理。请注意，此时间仅为参考时间，到时系统不会强制提交</div>",this.showDialog(g,function(){b.videoPageView=new j(a),b.deskPageView.remove(),b.addAnimate(),b.contents.show(b.videoPageView),b.rememberPartTime(a,"open",b.getCntSessionData("firstEmailUseTime")),b.listenTo(b.videoPageView,"closeSoftWare",function(){b.removeAnimate(),b.rememberPartTime(a,"close",b.getCntSessionData("firstEmailUseTime"),function(){b._getData()})})},function(){b.removeAnimate(),b.footPageView.removeIcon("video"),b.removeIconActiveStyle()})}else this.showTipDialog(a)},openNtp:function(a){var b=this,c=this.model.get("activeTask"),d=this.model.get("isBreak");if(1==a.isAllowEnter){var e=(a.taskCount,Math.round(a.requireTimes/60),"");e+="WorkPlatform"==c&&1==d?"<div>继续处理之前遗留的内部工作平台任务</div>":"<div><p>您的内部工作平台中有<span style='color:#ff5400;'>两项</span>任务等待您解决，请在各自要求的时间内完成处理，注意合理安排时间，到时系统将强制提交结果，关闭任务页面</p></div>",this.showDialog(e,function(){b.ntpPageView=new l(a),b.deskPageView.remove(),b.addAnimate(),b.contents.show(b.ntpPageView),b.rememberPartTime(a,"open",b.getCntSessionData("firstEmailUseTime")),b.listenTo(b.ntpPageView,"closeSoftWare",function(){b.removeAnimate(),b.rememberPartTime(a,"close",b.getCntSessionData("firstEmailUseTime"),function(){b._getData()})}),b.listenTo(b.ntpPageView,"rememberPartTime",function(){b.rememberPartTime(a,"close",0)})},function(){b.removeAnimate(),b.footPageView.removeIcon("ntp"),b.removeIconActiveStyle()})}else this.showTipDialog(a)},showTipDialog:function(a){var b=this,c=this.model.get("activeTask"),d=(a.partType,"");"FirstEmail"==c?d+="<div class='tip_dialog'><span></span>请您先处理邮箱中的邮件，再开始其他任务</div>":"SecondEmail"==c?d+="<div class='tip_dialog'><span></span>请利用最后剩余的时间，把您收到的新一批邮件全部处理完吧</div>":"Video"==c?d+="<div class='tip_dialog'><span></span>请您先处理视频通讯中收到的临时留言，再开始其他任务</div>":"WorkPlatform"==c&&(d+="<div class='tip_dialog'><span></span>您的其他任务已基本处理完毕，请点击内部工作平台，完成计划中的最后任务</div>");var e={type:"common",title:" ",content:d,buttons:[{name:"确定",id:"tip_sure",type:"tip_sure",eventName:"tipSure"}],simpleModal:{modal:!0,minWidth:350,opacity:0},isDrag:!1,moveDown:!1,icon:"common"};this.dialogView=new m({config:e}),this.listenTo(this.dialogView,"tipSure",function(){b.removeAnimate(),b.dialogView.close(),b.footPageView.removeIcon(a.soft.toLowerCase()),b.removeIconActiveStyle()}.bind(this))},showDialog:function(b,c,d){var e=new a.Model({content:b}),f=new h({model:e});configs={content:f,radius:!0,simpleModal:{modal:!0,minWidth:350,maxWidth:350}},this.dialogView=new m({config:configs}),this.listenTo(f,"close-dialog",function(){this.dialogView.close(),d()}),this.listenTo(f,"sure-dialog",function(){this.dialogView.close(),c()})},rememberPartTime:function(b,c,d,e){var f=this,g={SectionId:f.getCntSessionData("sectionId"),partType:b.partType,firstEmailUseTime:d,operateType:"open"==c?b.operateType:"close"};a.app.request("time:recordPartTime",g).done(function(b){return b.netError?(f.showNetErrorDialog(),!1):(a.Context.setSessionData("firstEmailUseTime",b.firstEmailUseTime),e&&e(),1==b.isRest?(f.showRestDialog(b),!1):void 0)})},showRestDialog:function(a){var b=this,c=!0,d=[{name:"确定",type:"blue_btn",id:"rest-dialog",eventName:"click:sure"}],e={title:" ",icon:"sigh",content:"系统发现您已经工作"+Math.round(a.useTime/60)+"分钟了，请稍事休息10分钟，劳逸结合，再开始新工作吧！",buttons:d,isDrag:!0,moveDown:!0,simpleModal:{modal:!0,maxWidth:500}};this.dialogView=new m({config:e}),setTimeout(function(){c&&(b.dialogView.close(),b.showRestAnimate(a),c=!1)},1e4),this.listenTo(this.dialogView,"click:sure",function(){c&&(b.dialogView.close(),b.showRestAnimate(a),c=!1)})},showRestAnimate:function(a){var b=this;this.footPageView.close(),this.deskPageView.close();var c={maxTime:a.maxTime||600,minTime:a.minTime||300};this.timeWaitView=new n(c),this.contents.show(this.timeWaitView),this.listenTo(b.timeWaitView,"autoFinishRest",function(){var a={type:"common",title:" ",content:"<div class='tip_dialog'><span></span>十分钟已过，快点打开内部工作平台完成任务吧！</div>",buttons:[{name:"确定",id:"tip_sure",type:"tip_sure",eventName:"tipSure"}],simpleModal:{modal:!1,minWidth:438},isDrag:!1,moveDown:!1,icon:"common"};b.dialogView=new m({config:a}),b.listenTo(b.dialogView,"tipSure",function(){b.dialogView.close()}),b._getData()}),this.listenTo(b.timeWaitView,"handFinishRest",function(){b._getData()})},removeIconActiveStyle:function(){a.$(".appraise_desk_img li").removeClass("desk_icon_click")},getCntSessionData:function(b){var c=this;try{return a.Context.getTemporaryData(b)}catch(d){var e=[{name:"确定",type:"blue_btn",id:"sure",eventName:"click:sure"}],f={content:"获取数据失败，请重新登陆",icon:"sigh",buttons:e,isDrag:!0,moveDown:!0,simpleModal:{modal:!0,minWidth:350}};c.dialog=new m({config:f}),c.listenTo(c.dialog,"click:sure",function(){c.dialog.close(),a.app.execute("history:navigate","#quiz%2Flogin",!1)}),console.error(d.message)}},onClose:function(){$("body").css({overflow:"auto"}),window.onbeforeunload=null},getCntSessionData:function(b){var c=this;try{return a.Context.getTemporaryData(b)}catch(d){if(a.$(".net-error-dialog").length<1){var e=[{name:"确定",type:"blue_btn",id:"sure",eventName:"click:sure"}],f={title:"错误提示",content:"获取数据失败，请重新登陆",icon:"sigh",buttons:e,isDrag:!0,moveDown:!0,simpleModal:{modal:!0,minWidth:350},dialogId:"net-error-dialog"};c.dialog=new m({config:f}),c.listenTo(c.dialog,"click:sure",function(){c.dialog.close(),a.app.execute("history:navigate","#quiz%2Flogin",!1)}),console.error(d.message)}}},showNetErrorDialog:function(){if(a.$(".net-error-dialog").length<1){var b=this,c=[{name:"刷新",type:"blue_btn",id:"sure",eventName:"click:sure"},{name:"取消",type:"grey_btn",id:"cancle",eventName:"click:cancle"}],d={title:"错误提示",content:"数据传输错误，请刷新重试或联系客服人员解决",icon:"sigh",buttons:c,isDrag:!0,moveDown:!0,simpleModal:{modal:!0,minWidth:350},dialogId:"net-error-dialog"},e=new m({config:d});b.listenTo(e,"click:cancle",function(){e.close()}),b.listenTo(e,"click:sure",function(){location.reload()})}}});return a.BasePageView.extend({mainViewClass:p,pageTitle:"作答页面",layout:"empty-layout"})}),define("views/quiz/index-page-view",["talent","templates/quiz","views/quiz/formal/index-page-view","views/quiz/guidance/index-page-view","views/quiz/login/index-page-view","views/quiz/login-error/index-page-view","views/quiz/no-support/index-page-view","views/quiz/pre-read/index-page-view","views/quiz/promise/index-page-view","views/quiz/route/index-page-view","views/quiz/take-photo/index-page-view","views/quiz/user_mes/index-page-view","views/quiz/complete/index-page-view","views/quiz/search/index-page-view","views/quiz/report/index-page-view","views/quiz/maintain/index-page-view","views/quiz/new-search/index-page-view","views/quiz/score-info/index-page-view","views/quiz/search-one/index-page-view","views/quiz/search-result/index-page-view","views/quiz/search-ticket/index-page-view","views/quiz/search-score/index-page-view","views/quiz/appraise/index-page-view","views/quiz/email/index-page-view","views/quiz/introduce/index-page-view","views/quiz/ntp/index-page-view","views/quiz/video/index-page-view"],function(a,b){var c=a.Layout.extend({template:b["quiz/index-page"],initialize:function(){},regions:{main:".quiz-container"},ui:{},events:function(){var a={};return a},onRender:function(){},onShow:function(){},onClose:function(){}});return a.BasePageView.extend({mainViewClass:c,pageTitle:"quiz",hideSidebar:!0})});