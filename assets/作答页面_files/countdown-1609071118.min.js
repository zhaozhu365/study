define(["talent","moment"],function(Talent,moment){var CountDown=Talent.ItemView.extend({template:Talent._.template("<div></div>"),defaults:{interval:1e3,intervalName:"milliseconds",countdown:0,nodes:"",format:"hh:mm:ss",endTime:0,hideZero:false,maxUnit:"h"},initialize:function(options){var maxReg=/^(?:[^dhms]*)([d|h|m|s])/;this.options=Talent._.extend({},this.defaults,options);this.$el=options.node;var match=this.options.format.match(maxReg);if(match&&match[1]){this.options.maxUnit=match[1]}if(this.options.type=="preload"&&this.options.countdown>300){this.randomAnswerTime=Math.floor(Math.random()*300)}else{this.randomAnswerTime=-1}},get:function(){return this.options.countdown},pause:function(){this._clear()},setTime:function(countdown){this._clear();this.options.countdown=countdown;this.start()},getSeconds:function(){return moment.duration(this.intervalDuration).as("seconds")},start:function(){var self=this;this.intervalDuration=moment.duration(parseInt(this.options.countdown)*1e3,this.options.intervalName);this.changeHtml(this.intervalDuration);this._interval=setInterval(function(){self.intervalDuration=moment.duration(self.intervalDuration).subtract(self.options.interval,self.options.intervalName);self.changeHtml(moment.duration(self.intervalDuration))},this.options.interval)},changeHtml:function(tempDuration){var self=this;var seconds=tempDuration.as("seconds");self.options.countdown=seconds;if(seconds>self.options.endTime){self._setHtml(tempDuration)}else if(seconds<=self.options.endTime&&self.options.endTime>0&&seconds>0){self._setHtml(tempDuration);self.nearEnd(seconds)}else{self._setHtml(tempDuration);self.end()}if(seconds==5){this.$el.trigger("nearFiveSeconds")}if(self.options.acCountDown&&self.options.acCountDown<=15*60&&self.options.showCollectTipFade&&self.options.acCountDown>5){self.$el.trigger("collectShowFade")}if(self.randomAnswerTime&&seconds==self.randomAnswerTime&&self.randomAnswerTime>-1){this.$el.trigger("nearAnswerSeconds")}},end:function(){this._clear();if(this.options.showCollectFade){this.$el.trigger("collectOver")}else{this.$el.trigger("over")}},nearEnd:function(s){this.$el.trigger("nearover",s)},_clear:function(){clearInterval(this._interval)},_setHtml:function(duration){var date={d:duration.days(),h:duration.hours(),m:duration.minutes(),s:duration.seconds()<0?0:duration.seconds()};var html=this.origanizeFormat(date);this.$el.html(html)},origanizeFormat:function(date){var self=this;var format=this.options.format;var reg={d:/(d+)/,h:/(h+)/,m:/(m+)/,s:/(s+)/};var zreoReg={d:/(d+[^h]*)(h+)/,h:/(h+[^m]*)(m+)/,m:/(m+[^s]*)(s+)/,s:/(s+[\s\S]*)/};var max=this.options.maxUnit;switch(max){case"h":date.h=date.d*24+date.h;break;case"m":date.m=(date.d*24+date.h)*60+date.m;break;case"s":date.s=((date.d*24+date.h)*60+date.m)*60+date.s;break}var flag=true;Talent._.each(reg,function(value,key){if(value.test(format)){var str=RegExp.$1;var len=new String(str).length;var shortLen=len-new String(date[key].toString()).length;var s="";if(shortLen==0){s=date[key]}else{for(var i=0;i<shortLen;i++){s+="0"}s+=date[key]}if(!self.options.hideZero){format=format.replace(RegExp.$1,s)}else{if((s=="0"||s=="00")&&flag){if(zreoReg[key].test(format)){format=format.replace(RegExp.$1,"")}}else{flag=false;format=format.replace(RegExp.$1,s)}}}});return format}});return CountDown});
//# sourceMappingURL=http://sourcemap.beisen.co/ux/tools-assessment/hotfix/app/scripts/vendor/legacy/countdown/countdown-1609071118.min.map